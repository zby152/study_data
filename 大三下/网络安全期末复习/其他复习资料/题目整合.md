[toc]



# 第一章 概述

### 1、**硬件软件漏洞**例子

硬件：(芯片漏洞植入为主)

一些网络安全人员给电脑的芯片（CPU）刷入恶意的Firmware固件，使未经许可的攻击者轻易地进入系统，而电脑管理员本身在系统里却无法发觉，用这种攻击方式的人被称为“硬件黑客”。

软件：(xss跨站脚本、注入、跨站指令cookie等)

一、跨站脚本(xss)

(一)问题

xss漏洞是最普遍和最致命的网络应用牧件安全漏洞，当一款应用牧件将用户数据发送到不带认证或者不对内容进行编码的网络浏览器时容易发生。黑客可以利用浏览器中的恶意脚本获得用户的数据，破坏网站，插入有害内容，以及展开钓鱼式攻击和恶意攻击。

(二)真实案例

恶意攻击者去年针对Paypal发起了攻击，他们将Paypal用户重新引导到另一个恶意网站并警告用户，他们的账户已经失窃。用户们被引导到另一个钓鱼式网站上，然后输入自己的Paypal登录信息、社会保险号和信用卡资料。Paypal公司称，它在2006年6月修复了那个流洞。

 二、注入漏洞

(一)问题

当用户提供的数据被作为指令的一部分发送到转换器(将文本指令转换成可执行的机器指令)的时候，黑音会欺骗转换器。攻击者可以利用注入漏洞创建、读取，更新或者删除应用软件上的任意数据。在最坏的情况下，攻击者可以利用这些漏洞完全控制应用软件和底层系统，甚至绕过系统底层的防火墙。

(二)真实案例

俄罗斯黑客在2005年1月份攻破了美国罗得岛政府网站，窃取了大量信用卡资料。黑客们声称SQL注入攻击窃取了5.3万个信用卡账号，而主机服务供应商则声称只窃取了4113个信用卡账号。

 三、恶意文件执行

(一)问题

黑客们可以远程执行代码、远程安装rootkits工具或者完全攻破一个系统。任何一款接受来自用户的文件名或者文件的网络应用软件都是存在漏洞的。漏洞可能是用PHP语言写的，PHP是网络开发过程中应用最普遍的一种脚本语言。

(二)真实案例

一位青少年程序员在2002年发现了Guess.com网站是存在漏洞的，攻击者可以从Guess数据库中窃取20万个客户的资料，包括用户名、信用卡号和有效期等。Guess公司在次年受到联邦贸易委员会调查之后，同意升级其安全系统。



### 2、**TCP/IP协议栈**面临的五大网络安全问题

1） IP欺骗

IP Spoof即IP 电子欺骗，可以理解为一台主机设备冒充另外一台主机的IP地址与其他设备通信。

2） SYN Flooding

​	SYN Flooding 为DoS攻击形式。它利用TCP三次握手协议的缺陷，向目标主机发送大量的伪造源地址的SYN连接请求，消耗目标主机的资源，从而不能够为正常用户提供服务。

3） ACK Flooding

​	ACK Flooding攻击是在TCP连接建立之后，所有的数据传输TCP报文都是带有ACK标志位的，主机在接收到一个带有ACK标志位的数据包的时候，需要检查该数据包所表示的连接四元组是否存在，存在则检查该数据包所表示的状态是否合法，然后再向应用层传递该数据包。如果不合法，例如该数据包所指向的目的端口在本机并未开放，则主机操作系统协议栈会回应RST包告诉对方此端口不存在。

4） UDP flooding

UDP Flooding是日渐猖厥的流量型DoS攻击，利用大量UDP小包冲击DNS服务器，或Radius认证服务器、流媒体视频服务器

5） Connection Flooding

Connection Flooding是利用小流量冲击大带宽网络服务的攻击方式。利用真实的IP地址向服务器发起大量的连接，建立连接之后很长时间不释放，占用服务器的资源，造成服务器上残余连接(WAIT状态)过多，效率降低，甚至资源耗尽，无法响应其他客户所发起的连接。

### 3、**U盘**双击容易中毒原理

就是“autorun.inf文件”。病毒首先把自身复制到u盘,然后创建一个autorun.inf，当你在插入U盘或者双击u盘时，autorun.inf中的设置会运行u盘中的病毒。

### 4、（18-19简答3）简述浏览器能够打开百度的主页而不能打开谷歌的主页可能的原因。

- 防火墙过滤，本机防火墙将源地址为本机ip，目的地址为谷歌ip的数据包设为过滤，导致无法完成http请求；四个可能的过滤（本机向google的服务器请求/google对本机的响应分别被本区域防火墙/google所在区域防火墙给过滤掉，2*2=4）
- DNS欺骗，本机提交给域名服务器的域名解析请求数据包被截获，替换为不可访问的ip
- 某级的DNS Server故障或者被攻击，导致无法解析域名，能访问baidu是因为某个DNS Server或者本地host文件恰好存储这这个域名的页面；
- host文件故障，导致google的ip被设置成奇怪的ip(通俗讲，本地存储的域名ip cache被替换了)
- 攻击者籍由TCP劫持实现中间人攻击，拒绝转发google，但是转发了百度（看上去挺蠢的，而且代价挺高的，但是确实原理可行）

### 5、（21-22论述1）试述**P2DR安全模型**的构成与基本原理。(15分)

P2DR模型包括四个主要部分：Policy（安全策略），Protection（防护）、Detection（检测）和Response（响应）。

（lk补充）

1. 策略：定义系统的监控周期、确立系统恢复机制、制定网络访问控制策略和明确系统的总体安全规划和原则。
2. 防护：通过修复系统漏洞、正确设计开发和安装系统来预防安全事件的发生；通过定期检查来发现可能存在的系统脆弱性；通过教育等手段，使用户和操作员正确使用系统，防止意外威胁；通过访问控制、监视等手段来防止恶意威胁。采用的防护技术通常包括数据加密、身份认证、访问控制、授权和虚拟专用网（VPN）技术、防火墙、安全扫描和数据备份等。
3. 检测：是动态响应和加强防护的依据，通过不断地检测和监控网络系统，来发现新的威胁和弱点，通过循环反馈来及时做出有效的响应。当攻击者穿透防护系统时，检测功能就发挥作用，与防护系统形成互补。
4. 响应：系统一旦检测到入侵，响应系统就开始工作，进行事件处理。响应包括紧急响应和恢复处理，恢复处理又包括系统恢复和信息恢复。

P2DR模型是在整体安全策略的控制和指导下，在综合运用防护工具（如防火墙、操作系统身份认真、加密等）的同时，利用检测工具（如漏洞评估、入侵检测等）了解和评估系统的安全状态，通过适当的反应将系统调整到“最安全”和“风险最低”的状态。防护、检测和响应组成了一个完整的、动态的安全循环，在安全策略的指导下保证信息系统的安全。

该理论最基本的的**原理**就是，认为信息相关的所有活动，不管是攻击行为、防护行为、检测行为和响应行为都要消耗**时间**。因此可以用时间来衡量一个体系的安全性和安全能力。

P2DR模型总结：及时的检测和响应就是安全；及时的检测和恢复就是安全。

P2DR缺点：忽略了内在的变化因素，如人员的流动、人员的素质和策略贯彻的不稳定性。实际上，安全问题牵涉面很广，除了涉及到的防护、检测和响应，系统本身的安全“免疫力”增强、系统和整个网络的优化以及人员这个在系统中最重要角色的素质的提升，都是该安全系统没有考虑到的问题。

---

**（from Monica）**

P2DR（Policy、Protection、Detection、Response）是一种网络安全模型，用于指导企业构建全面的网络安全体系。其构成和基本原理如下：

1. 构成：

- Policy（策略）：包括安全政策、安全标准、安全流程等规范性文件，旨在为企业构建安全的网络基础。
- Protection（保护）：包括访问控制、加密、漏洞管理等预防措施，旨在防止网络攻击和数据泄露。
- Detection（检测）：包括入侵检测、漏洞扫描、日志分析等检测手段，旨在及时发现网络威胁。
- Response（响应）：包括应急响应、恢复计划、漏洞修复等响应措施，旨在快速有效地响应网络安全事件。

2. 基本原理：P2DR模型的基本原理是“预防为主、检测为辅、响应及时”。通过制定安全策略、加强访问控制、及时发现和响应安全事件，实现企业网络安全的全面保护。

---

**（from ChatGPT）**

P2DR安全模型是一种综合性的安全框架，它由四个关键组成部分构成，即策略（Policy）、保护（Protection）、检测（Detection）和响应（Response）。下面我将详细介绍P2DR安全模型的基本原理和各个组成部分的功能：

1. 策略（Policy）：
   策略是P2DR模型的核心，它涉及制定和实施安全策略、规则和控制措施，以确保系统和网络的安全性。策略定义了安全目标、访问控制规则、身份验证和授权要求等。它是整个安全模型的指导原则，用于定义合规性要求和安全运营规则。

2. 保护（Protection）：
   保护是P2DR模型中的一个重要组成部分，它涉及实施各种技术和控制措施来保护系统和网络免受安全威胁。这包括使用防火墙、入侵防御系统（IDS）、入侵防护系统（IPS）、反病毒软件、访问控制机制、加密技术等来减轻风险和保护系统资源的完整性、机密性和可用性。

3. 检测（Detection）：
   检测是P2DR模型中用于识别和监控安全事件和潜在威胁的组成部分。检测技术包括入侵检测系统（IDS）、日志分析、网络流量分析等，用于实时监测系统和网络的活动，发现异常行为和安全事件。通过及时检测，可以快速识别潜在的安全漏洞和入侵行为，从而采取适当的响应措施。

4. 响应（Response）：
   响应是P2DR模型中的最后一个环节，它涉及对检测到的安全事件进行适当的响应和处置。响应措施可能包括阻止恶意流量、隔离受感染的系统、修复漏洞、恢复受影响的服务等。同时，响应还包括对事件进行调查和分析，以确定攻击的来源、影响范围和修复方法，以便改进安全策略和保护措施。

P2DR安全模型的基本原理是通过制定明确的策略来保护系统和网络资源，实施各种保护措施以减轻风险，使用检测技术实时监测安全事件和潜在威胁，最后采取适当的响应措施来应对安全事件。这个模型的优点在于综合性和全面性，它提供了一个框架来管理安全风险并响应安全事件，使组织能够更好地保护其关键资产和敏感信息。

一个典型的P2DR安全模型的应用案例是在企业网络中保护机密客户数据。首先，制定明确的策略，如访问控制策略、加密策略等，以确保只有授权人员能够访问敏感数据。然后，实施各种保护措施，如防火墙、加密通信、访问控制列表等，以保护数据免受未经授权的访问和泄露。接下来，使用入侵检测系统（IDS）和日志分析工具来实时监测网络活动，以发现潜在的安全威胁。最后，对检测到的安全事件采取适当的响应措施，如封锁恶意IP地址、修复系统漏洞、启动紧急备份等，以保护客户数据的完整性和保密性。通过P2DR模型的综合应用，企业能够建立一个全面的安全体系，有效应对各种安全威胁。

### 6、（21-22论述4）试述**跨站脚本攻击**的概念与分类(15分)

跨站脚本攻击（Cross-Site Scripting，XSS）是一种常见的Web安全漏洞，攻击者通过在Web应用程序中注入恶意脚本，从而在用户访问该应用程序时对其进行攻击。攻击者通常会利用XSS攻击窃取用户的敏感信息、劫持用户会话、篡改网页内容等。

根据攻击方式和攻击载体，XSS攻击可以分为以下三种类型：

1. 存储型XSS：攻击者将恶意脚本注入到Web应用程序的数据库中，当用户访问包含注入脚本的页面时，恶意脚本会从服务器上返回并执行，从而对用户进行攻击。

2. 反射型XSS：攻击者将包含恶意脚本的URL发送给用户，当用户点击该URL时，恶意脚本会被注入到响应页面中并执行，从而对用户进行攻击。

3. DOM型XSS：攻击者通过修改页面的DOM结构来注入恶意脚本，当用户访问包含注入脚本的页面时，恶意脚本会在用户的浏览器中执行，从而对用户进行攻击。

# 第二章 网络攻击行径分析

### 1、==（lm课后题1）==利用向目标主机**发送非正常消息**而导致目标主机崩溃的攻击方法有哪些？

> 书P9、P69

- Ping of Death(原理见书P69)
  - 向目标端口发送大量的超大尺寸的ICMP包
- **TearDrop**(原理见书P70)
  - 基于UDP的病态分片数据包的攻击方法
  - 可以理解为通过构造具有**重叠位移**的伪造分片数据包使得计算出包的**长度为负数**，导致在使用 `memcpy` 时分配过大内存(可参见书P71例子)
- 畸形消息攻击
  - 利用操作系统上服务存在的安全隐患，即处理消息之前没有进行适当正确的错误校验，导致收到畸形消息时崩溃
  
  ---
  
  **（from ChatGPT)**

目前存在许多利用向目标主机发送非正常消息导致目标主机崩溃的攻击方法。以下是其中几种常见的攻击方法：

1. 缓冲区溢出攻击（Buffer Overflow Attack）：这是一种利用目标主机上的软件漏洞的攻击方法。攻击者通过向目标主机发送过大或恶意构造的数据，超出了程序所分配的内存缓冲区的容量，导致目标主机发生缓冲区溢出，进而可能引发崩溃或执行恶意代码[1]。
2. 拒绝服务攻击（Denial of Service, DoS）：这种攻击方法旨在通过向目标主机发送大量非正常请求或使其超载，从而使目标主机无法正常处理合法请求。攻击者可以利用这种攻击方法耗尽目标主机的资源（如网络带宽、处理能力等），导致目标主机崩溃或无法对外提供正常的服务[2]。
3. 分布式拒绝服务攻击（Distributed Denial of Service, DDoS）：与拒绝服务攻击类似，DDoS攻击也是通过向目标主机发送大量非正常请求来耗尽其资源。不同之处在于，DDoS攻击利用多个分布在不同地点的"僵尸"计算机（也称为"肉鸡"）协同攻击目标主机，增加了攻击的威力和难以追踪攻击源的难度[3]。
4. SYN洪水攻击（SYN Flood Attack）：这是一种利用TCP协议的漏洞的攻击方法。攻击者向目标主机发送大量伪造的TCP连接请求（SYN包），占用目标主机的资源，导致其无法正常处理合法的连接请求，从而导致崩溃或拒绝服务[4]。

这些攻击方法仅为几种常见的示例，实际上还存在其他形式的攻击方法。网络安全的不断演进使得攻击者和防御者之间的斗争持续进行，因此及时更新和强化安全措施是保护目标主机免受此类攻击的重要措施。

参考文献：

1. Buffer Overflow Attacks. [链接](https://www.owasp.org/index.php/Buffer_overflow_attack)
2. Denial-of-service attack. [链接](https://en.wikipedia.org/wiki/Denial-of-service_attack)
3. Distributed Denial of Service (DDoS) Attacks. [链接](https://www.imperva.com/learn/application-security/ddos-attack/)
4. SYN flood. [链接](

### 2、==（lm课后题2）==**破坏性攻击**的原理及其常用手段

> 书P9

- 破坏性攻击以**破坏对方系统为主要目标**
- 破坏的方式包括
  - 使对方系统拒绝系统服务
  - 删除有用数据库甚至操作系统
  - 破坏硬件系统
- 常用的手段
  - 病毒攻击
  - 拒绝服务攻击

---

**（from ChatGPT)**

破坏型攻击（Destructive Attacks）是指攻击者通过恶意行为直接破坏目标系统或数据的安全性、可用性或完整性的攻击方式。这些攻击旨在造成目标系统的损坏、瘫痪或数据的永久丢失。以下是破坏型攻击的原理及其常用手段的简要描述：

1. 原理： 破坏型攻击的原理是通过有意的行为对目标系统或数据进行恶意破坏。攻击者可能利用漏洞、弱点或恶意软件等手段，以达到破坏目标的目的。这种攻击可能导致数据的删除、篡改、加密、拒绝访问，系统的瘫痪或完全损坏等后果。
2. 常用手段：
   - 恶意软件：攻击者通过植入恶意软件（如病毒、蠕虫、特洛伊木马等）来破坏目标系统或数据的安全。恶意软件可以执行各种破坏行为，如删除文件、篡改数据、瘫痪系统等。
   - 数据篡改：攻击者可能通过篡改目标系统或数据库中的数据来破坏数据的完整性。这种手段可能导致数据的不一致、错误的决策和业务中断等问题。
   - 拒绝服务攻击（DoS）：攻击者利用拒绝服务攻击手段耗尽目标系统的资源，使其无法正常工作或提供服务。这种攻击会导致目标系统无法对外提供正常的服务，造成服务中断或不可用。
   - 数据删除：攻击者可能通过删除目标系统或数据库中的数据来破坏数据的可用性。这种攻击可能导致数据的永久丢失，对业务运作和恢复造成严重影响。
   - 网络破坏：攻击者可能利用网络漏洞或攻击技术对网络基础设施进行破坏，例如瘫痪网络设备、干扰网络通信等。

破坏型攻击对目标系统和数据的破坏性非常高，可能导致严重的后果和损失。因此，保护系统和数据的安全性、完整性和可用性是至关重要的。组织和个人应采取适当的安全措施，如定期备份数据、使用防病毒软件、修补漏洞、实施访问控制等，以减少破坏型攻击的风险[[1](https://www.imperva.com/learn/application-security/destructive-attacks-what-are-they-and-how-to-defend-against-them/)].

### 3、==（lm课后题3）==**扫描**的作用和常见的扫描方法

> 书P12

- 扫描是指
  - **仔细逐个检查远程或本地系统中的各种信息，以为己用**

- 作用是通过收集系统信息来自动检测远程或本地主机的安全性弱点

  > lm PPT p17 通过使用扫描器可以发现远程服务器是否存活、它对外开放的各种TCP端口的分配及提供的服务、它所使用的软件版本(如操作系统或其他应用软件的版本)、所存在可能被利用的系统漏洞

- 常见的扫描方法(书P12)

---

**（from ChatGPT）**

在网络安全领域，扫描是一种常用的安全评估和漏洞发现技术。它用于检测计算机网络、系统或应用程序中的漏洞和弱点，以便及时采取措施来防止潜在的攻击和安全威胁。扫描可以帮助网络管理员或安全专业人员发现系统中的漏洞，并采取相应的补救措施，从而提高网络的安全性。

以下是一些常用的扫描方法：

1. 端口扫描：端口扫描是一种用于确定目标主机开放的网络端口的方法。它通过发送网络请求到目标主机上的不同端口，并根据响应的情况来确定哪些端口是开放的。端口扫描可用于评估主机的安全性，检测潜在的漏洞或未经授权的服务。
2. 漏洞扫描：漏洞扫描是一种自动化的过程，用于识别目标系统中存在的已知安全漏洞。漏洞扫描器会扫描目标系统的软件、配置和补丁情况，并与已知的漏洞数据库进行比对，以确定是否存在潜在的漏洞。漏洞扫描可以帮助组织及时发现和修补漏洞，提高系统的安全性。
3. 网络扫描：网络扫描是对整个网络进行综合扫描和评估的过程。它包括对网络拓扑、主机、设备和服务的扫描，以获取有关网络的详细信息。网络扫描可以帮助发现潜在的安全风险、配置错误、弱点和脆弱性，并为网络管理员提供改进安全措施的建议。
4. 主机扫描：主机扫描是对特定主机进行详细扫描和评估的过程。它包括对主机的操作系统、开放的端口、服务和配置进行扫描，以了解主机的安全状态和潜在的漏洞。主机扫描可帮助发现主机上的安全问题，并采取相应的措施来提高主机的安全性。
5. 地址扫描：地址扫描是用于识别和探测目标网络中的活动主机和设备的过程。它可以通过发送网络请求或探测数据包来确定目标网络中的活动IP地址，并提供关于这些地址对应的主机或设备的信息。地址扫描有助于确定网络范围内的活动设备和主机，以帮助了解网络拓扑和识别潜在的安全隐患。

这些扫描方法通常会结合使用，以提供全面的安全评估和漏洞发现。重要的是在进行扫描之前获得合法授权，并遵守法律和道德规范。

### 4、**网络欺骗**的原理以及常用的欺骗方法

> 书P13

- 网络欺骗是**用来攻击目标配置不正确的消息**
- 常用的方法(详细见书P156)
  - DNS欺骗、电子邮件欺骗、Web欺骗、IP欺骗

### 5、**IP欺骗**的原理与过程

- **原理：**

  利用hosta和hostb基于IP地址建立的信任关系，如果能够冒充hostb的IP，就可以使用rlogin登录到hosta，而不需要任何口令验证。

  > IP 欺骗攻击指攻击行动产生的 IP 数据包为伪造的源 IP 地址，以便冒充其他系统或发件人的身份。这是一种黑客的攻击形式，黑客使用一台计算机上网，而借用另外一台机器的 IP 地址，从而冒充另外一台机器与服务器进行交互。

  **过程：（lm PPT 第七章p23）**

  - 首先使被信任主机的网络暂时瘫痪
  - 连接到目标机的某个端口来猜测ISN基值和增加规律
  - 把源址址伪装成被信任主机，发送带有SYN标志的数据段请求连接
  - 等待目标机发送SYN+ACK包给已经瘫痪的主机
  - 再次伪装成被信任主机向目标机发送的ACK，此时发送的数据段带有预测的目标机的ISN+1 
  - 连接建立，发送命令请求

  (书P172)

### 6、**攻击**的一般目的

> 书P16

### 7、==（lm课后题4）==**攻击**的一般过程和注意事项

> 书P17

- 一般的攻击都分为三个阶段
  - 攻击的准备阶段
    - 确定攻击目的、准备攻击工具、收集目标信息
  - 攻击的实施阶段
    - 隐藏自己的位置、利用收集到的信息获取账号和密码，登陆主机、利用漏洞或者其他方法获得控制权并窃取网络资源和特权
  - **攻击的善后阶段**
    - 善后的重要性(书P20)
    - 善后的方法(书P21)

---

**（from PPT）**

攻击的一般过程：

一般的攻击都分为三个阶段：

- 攻击的准备阶段：确定攻击目的、准备攻击工具、收集目标信息

- 攻击的实施阶段：隐藏自已的位置、利用收集到的信息获取账号和密码，登录主机、利用漏洞或者其它方法获得控制权并窃取网络资源和特权

- 攻击的善后阶段：

  - 日志：Windows ：禁止日志审计，清除事件日志，清除IIS服务日志；Unix：messages、lastlog、loginlog、sulog、utmp、utmpx、wtmp、wtmpx、pacct

  - 为了下次攻击的方便，攻击者都会留下一个后门，充当后门的工具种类非常多，最典型的是木马程序

---

**（from ChatGPT）**

攻击的一般过程可以简要概括为以下三个阶段：攻击的准备阶段、攻击的实施阶段和攻击的善后阶段。

1. 攻击的准备阶段：
   - 目标确定：攻击者确定攻击的目标，可能是个人用户、组织、网络或系统。
   - 收集情报：攻击者收集关于目标的信息，包括网络拓扑、操作系统、应用程序、漏洞等。
   - 工具准备：攻击者获取、配置和准备所需的攻击工具、恶意软件或脚本。
2. 攻击的实施阶段：
   - 入侵和渗透：攻击者使用准备好的工具和技术，利用系统漏洞或弱点入侵目标系统。
   - 权限提升：一旦入侵成功，攻击者尝试提升自己的权限，以执行更广泛的操作并获取敏感信息。
   - 控制和窃取数据：攻击者试图获取对目标系统的控制权，并窃取敏感数据、个人信息或机密资料。
3. 攻击的善后阶段：
   - 擦除痕迹：攻击者试图清除攻击活动的痕迹，以隐藏自己的身份和活动。
   - 后门安装：攻击者可能在目标系统中安装后门，以便将来维持访问权限或进行进一步的攻击。
   - 继续威胁：攻击者可能利用窃取的数据或控制的系统，进行勒索、继续渗透或进行其他非法活动。

注意事项：

- 加强安全防护：定期更新和修补软件、配置防火墙、使用强密码和身份验证措施。
- 提高意识和培训：教育用户和员工有关网络安全和社交工程攻击的风险，以及如何识别和应对威胁。
- 监测和日志记录：设置日志记录和监控系统，以便及时检测异常活动并进行调查。
- 备份和恢复策略：定期备份数据，并确保有可靠的恢复策略，以便在遭受攻击时能够恢复数据和系统。
- 定期安全审计：进行定期的安全审计和漏洞评估，以发现和修复系统中的漏洞和弱点。

### 8、**口令猜测**的方法和步骤

> 书P23

- 获取账号
- 获取密码

### 9、**安全威胁**分类

书P8

---

lm PPT 第一章p23

<img src="https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230611164250228.png" alt="image-20230611164250228" style="zoom:50%;" />

### 10、为什么看上去大公司会出现更多**信息泄露**事件

1. 在正式公司里面，名气越小的被攻击的概率越低
2. 产品和业务量的差距，大公司的产品和业务太多了，自然出现问题的概率更高
3. 时代不同了，现在新的接口都会做管控，小公司小平台比较好调整。但是大公司太大了，pc时代存在的大量没有反爬的接口，许多老接口现在不维护了



### 11、从棱镜门事件，分析一下**美国公共信息安全保障策略**的特色

IATF（Information Assurance Technical Framework） 1.0

三个目标：

- 准备和防范
- 检测和响应
- 建立牢固的根基

十个步骤

- 准备和防范

步骤1：确认关键基础设施资产以及相互依赖性，发现其脆弱性

- 检测与响应

步骤2：检测攻击和非法入侵

步骤3：开发稳健的情报和执法功能，保持法律的一致

步骤4：以实时的方式共享攻击警告和信息

步骤5：建立响应、重建和回复能力

- 建立牢固的根基

步骤6：为支持程序1－5，加强研究和开发

步骤7：培训和雇用足够数量的安全专家

步骤8：进行拓展，使公知晓提高计算机安全的必要性

步骤9：通过立法和拨款，支持程序1－8

步骤10：在计划的每一步骤和部分中，要完全保护公民的自由权、隐私权以及私有数据

IATF（Information Assurance Technical Framework） 3.0

![Untitled](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/Untitled%2013.png)





# 第三章 网络侦查技术

### 1、==（lm课后题1）==什么是**网络扫描**？什么是扫描器？

- 网络扫描：通过网络进行扫描，收集信息
- 扫描器(书P30、lmPPT p17)：扫描器是一种自动检测远程或本地主机安全性弱点的程序。通过使用扫描器可以发现远程服务器是否存活、它对外开放的各种TCP端口的分配及提供的服务、它所使用的软件版本(如操作系统或其他应用软件的版本)、所存在可能被利用的系统漏洞

### 2、**扫描**的类型和功能

省略(书P12)、详细(书P30)

---

**（from ChatGPT）**

在网络安全中，扫描可以分为以下几种类型，包括：

1. 端口扫描：端口扫描是一种用于确定目标主机开放的网络端口的方法。它通过发送网络请求到目标主机上的不同端口，并根据响应的情况来确定哪些端口是开放的。端口扫描可用于评估主机的安全性，检测潜在的漏洞或未经授权的服务。
2. 漏洞扫描：漏洞扫描是一种自动化的过程，用于识别目标系统中存在的已知安全漏洞。漏洞扫描器会扫描目标系统的软件、配置和补丁情况，并与已知的漏洞数据库进行比对，以确定是否存在潜在的漏洞。漏洞扫描可以帮助组织及时发现和修补漏洞，提高系统的安全性。
3. 网络扫描：网络扫描是对整个网络进行综合扫描和评估的过程。它包括对网络拓扑、主机、设备和服务的扫描，以获取有关网络的详细信息。网络扫描可以帮助发现潜在的安全风险、配置错误、弱点和脆弱性，并为网络管理员提供改进安全措施的建议。
4. 主机扫描：主机扫描是对特定主机进行详细扫描和评估的过程。它包括对主机的操作系统、开放的端口、服务和配置进行扫描，以了解主机的安全状态和潜在的漏洞。主机扫描可帮助发现主机上的安全问题，并采取相应的措施来提高主机的安全性。
5. 地址扫描：地址扫描是用于识别和探测目标网络中的活动主机和设备的过程。它可以通过发送网络请求或探测数据包来确定目标网络中的活动IP地址，并提供关于这些地址对应的主机或设备的信息。地址扫描有助于确定网络范围内的活动设备和主机，以帮助了解网络拓扑和识别潜在的安全隐患。

这些扫描类型在网络安全中起着重要作用，帮助组织发现潜在的安全风险、漏洞和配置问题，以便及时采取措施来保护网络和系统的安全性。然而，需要注意的是，在进行扫描活动时应遵守法律、道德和合规要求，获得相关网络拥有者的授权，并确保扫描活动的合法性和安全性。

### 3、（21-22简答4）简述**端口扫描**的概念和原理

端口扫描：端口扫描是一种用于确定目标主机开放的网络端口的方法。它通过发送网络请求到目标主机上的不同端口，并根据响应的情况来确定哪些端口是开放的。端口扫描可用于评估主机的安全性，检测潜在的漏洞或未经授权的服务。

---

**（from Monica）**

端口扫描是一种网络安全技术，用于检测目标主机上开放的网络端口。其原理如下：

在计算机网络中，每个应用程序都需要使用一个端口来进行通信，例如Web服务器通常使用80端口，FTP服务器使用21端口等。端口扫描利用这个原理，通过向目标主机发送各种类型的网络数据包，并根据返回的响应数据来判断目标主机上哪些端口是开放的。

常见的端口扫描方法包括TCP扫描、UDP扫描、SYN扫描等。其中，TCP扫描是最常见的一种端口扫描方法，其原理如下：

1. 发送TCP连接请求：扫描程序向目标主机发送一个TCP连接请求数据包，请求连接目标主机的指定端口。

2. 接收响应：如果目标主机上相应的端口是开放的，它将响应一个TCP SYN/ACK数据包。

3. 发送TCP RST数据包：扫描程序接收到响应后，发送一个TCP RST数据包来关闭连接。

通过不断发送TCP连接请求，并根据响应情况来判断目标主机上哪些端口是开放的，从而确定目标主机的网络服务情况。

---

**（from ChatGPT）**

端口扫描是一种网络安全技术，用于确定目标主机上开放的网络端口和相应的服务。它通过发送特定类型的网络数据包来与目标主机通信，然后分析响应以确定目标主机上哪些端口处于开放状态。以下是端口扫描的概念和原理：

概念：

端口扫描是一种主动的安全评估方法，用于探测目标主机上的开放端口。开放端口表示目标主机上运行着相应的服务或应用程序，攻击者可以利用这些开放端口进行潜在的攻击。通过进行端口扫描，安全人员可以发现可能存在的安全漏洞和风险，以便采取相应的防护措施。

原理：

端口扫描的原理基于网络通信协议（如TCP/IP）中的端口概念。每个服务或应用程序在主机上都与一个特定的端口相关联。端口号范围从0到65535，其中一部分端口号已经预留给特定的协议和服务，例如HTTP（端口80）、HTTPS（端口443）、FTP（端口21）等。

端口扫描的过程通常分为以下几个步骤：

1. 确定目标主机：选择要进行端口扫描的目标主机或主机范围。
2. 确定扫描类型：选择合适的端口扫描技术和扫描类型，如全面扫描、快速扫描、定向扫描等。
3. 发送扫描请求：根据选择的扫描类型，向目标主机发送特定类型的网络数据包，以探测目标主机上的端口状态。
4. 分析响应：分析目标主机对扫描请求的响应。如果目标主机返回确认响应，表示相应的端口处于开放状态，可以进行进一步的分析和评估。如果目标主机返回拒绝响应或未响应，表示相应的端口可能处于关闭状态或被防火墙等安全设备阻止。
5. 结果记录和分析：将扫描结果记录下来，并根据结果进行进一步的分析和评估，以确定存在的安全风险和漏洞。

需要注意的是，端口扫描是一种主动的行为，在进行端口扫描时，应遵守法律和道德准则，并获得合法的授权。



### 4、==（lm课后题2）==什么是**网络监听**

书P39

---

**（from ChatGPT）**

网络监听是指在网络通信中截取、捕获和分析数据流量的过程。通过网络监听，可以监视和记录网络上的数据传输、通信行为和信息交换。

网络监听可以用于多种目的，包括但不限于以下几个方面：

1. 网络监控和故障排除：通过监听网络流量，可以实时监控网络的运行状态和性能。网络管理员可以识别网络瓶颈、错误和异常行为，并及时采取措施解决问题。
2. 安全监测和入侵检测：网络监听可以用于检测潜在的安全威胁和入侵行为。通过分析网络流量，可以发现异常的数据包、不寻常的通信模式或恶意活动，从而提前发现并应对潜在的网络攻击。
3. 数据分析和信息获取：通过监听网络流量，可以获取有关通信方、数据内容和交互行为的信息。这些信息可以用于业务分析、用户行为分析、市场研究等各种目的。

需要注意的是，网络监听涉及到对网络中的数据进行截取和分析，因此需要遵守法律和隐私保护的规定。在进行网络监听时，应确保获得相关用户的授权，遵守隐私保护政策，并遵守适用的法律法规。

### 5、==（lm课后题3）==简述**以太网的网络监听**

- 共享以太网(书P40)
  - 以太网的结构、通信方式、数据传输方式、网卡模式
- 交换式以太网(书P44)
  - 通信方式、监听方法
- 防范方法(书P45)
- 检测方法(书P46)

---

**（from ChatGPT）**

以太网的网络监听是指通过特定的技术手段来截获和分析以太网中的数据流量。以下是两种常见的以太网网络监听方式：

1. 共享以太网监听：
   - Unicast（单播）：指数据包从源地址直接发送到目标地址的方式，只有目标设备可以接收和处理该数据包。其他设备在以太网上不会收到这个数据包。
   - Broadcast（广播）：指数据包从源地址发送到以太网上的所有设备，所有设备都能接收和处理该数据包。广播地址是一个特殊的地址，用于向整个网络发送信息。
   - Multicast（组播）：指数据包从源地址发送到一组特定的设备，这些设备通过加入相同的多播组地址来接收数据包。多播可以实现一对多的通信，节省网络带宽和资源。
   - Promiscuous（混杂）：是指网络适配器（网卡）在混杂模式下工作，可以接收到经过网络中的所有数据包，而不仅仅是针对自己的数据包。这样就可以截取整个网络中的数据流量进行分析。
2. Sniffer（嗅探器）：
   - Sniffer是一种用于网络监听和数据包分析的软件或硬件工具。它可以截获通过以太网传输的数据包，并对其进行解析和分析。
   - Sniffer工具可以提供详细的数据包信息，包括源地址、目标地址、协议类型、数据内容等，帮助网络管理员或安全专家监控网络流量、检测潜在的安全威胁和进行网络故障排查。
   - Sniffer工具通常提供图形化界面和各种过滤和分析功能，方便用户查看和分析数据包，提供实时统计和报告。

需要注意的是，进行以太网的网络监听需要合法授权，并且必须遵守相关的法律和隐私保护规定。在使用网络监听工具时，应该确保符合法律法规，尊重他人的隐私权和数据保护原则。

### 6、（18-19论述2）叙述**交换式以太网中的监听方法**。

书P44     ARP欺骗+sniffer

---

**（from ChatGPT）**

在交换式以太网中，监听方法可以通过结合ARP欺骗和sniffer（嗅探器）来实现。

1. ARP欺骗（ARP Spoofing）：ARP（地址解析协议）是用于将IP地址映射到MAC地址的协议。在ARP欺骗攻击中，攻击者会发送伪造的ARP响应或ARP请求，以欺骗目标设备与攻击者进行通信。通过伪造ARP响应，攻击者可以使目标设备将其所有网络流量发送到攻击者的设备上，而不是正确的目标设备。

2. Sniffer（嗅探器）：嗅探器是一种网络工具，用于捕获和分析通过网络传输的数据包。攻击者可以使用嗅探器来截获通过交换式以太网传输的数据包，包括目标设备发送和接收的所有数据。

攻击者使用以下步骤来实施监听方法：

1. ARP欺骗：攻击者首先发送伪造的ARP响应或ARP请求，告诉目标设备攻击者的MAC地址与目标IP地址的映射关系。这会导致目标设备将其所有网络流量发送到攻击者的设备上，而不是正确的目标设备。

2. 嗅探器设置：攻击者在其设备上设置嗅探器，以捕获通过网络传输的数据包。嗅探器可以设置为仅捕获特定目标设备的数据包，或者捕获网络上的所有数据包。

3. 数据捕获和分析：一旦目标设备的网络流量被重定向到攻击者的设备上，并且嗅探器开始捕获数据包，攻击者就可以分析这些数据包。这可能包括敏感信息，如登录凭据、通信内容等。

需要注意的是，ARP欺骗和使用嗅探器进行监听是一种非法的行为，在大多数国家和地区都被视为网络攻击。这种行为侵犯了用户的隐私和网络安全，可能导致严重的后果。只有在合法授权的情况下，例如网络安全审计或授权渗透测试，才能使用这些技术来进行监听。

### 7、（18-19论述4）叙述如何检测以太网络中进行网络监听的处于**混杂模式**的节点。

（lm PPT p103）

1. <img src="https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230612120956515.png" alt="image-20230612120956515" style="zoom: 80%;" />

### 8、简述**sniffer**的工作原理

书P43

### 9、==（lm课后题4）==如何防范**网络监听**？

书P45

---

**lm PPT p102**

网络监听的防范方法：

1. 确保以太网的整体安全性
2. 采用加密技术

检测网络监听的手段：

1. 反应时间
2. DNS测试
3. 利用ping进行监测
4. 利用ARP数据包进行监测

---

**（from ChatGPT)** **lm PPT的扩充版**

防范网络监听是网络安全的重要措施之一。**以下是一些常用的防范网络监听的方法：**

1. 强化以太网的整体安全性：
   - 使用强密码和定期更改密码来保护网络设备的管理接口，防止未经授权的访问。
   - 更新和及时应用操作系统、网络设备和应用程序的安全补丁，以修复已知的漏洞。
   - 配置合适的网络访问控制列表（ACL）和防火墙规则，限制对网络资源的访问。
   - 使用虚拟专用网络（VPN）等安全隧道技术，对网络通信进行加密和认证。
2. 采用加密技术：
   - 使用加密协议和算法保护敏感数据在网络传输过程中的安全性。例如，使用安全套接层（SSL）/传输层安全（TLS）来加密 Web 浏览器和服务器之间的通信。
   - 对于敏感数据的存储，可以采用加密的文件系统或数据库来确保数据的机密性。
3. 强化物理安全：
   - 控制物理访问权限，确保未经授权的人员无法接触到网络设备和线缆。
   - 对关键设备和线缆进行实时监控，发现任何异常情况并及时采取措施。
4. 使用入侵检测和防御系统（IDS/IPS）：
   - 部署IDS/IPS来监测和阻止潜在的监听和入侵行为。IDS/IPS可以检测异常的网络流量、攻击尝试和异常设备行为，并及时发出警报或采取防御措施。
5. 定期进行安全审计和渗透测试：
   - 对网络进行定期的安全审计和渗透测试，发现潜在的安全弱点和漏洞，并及时采取措施进行修复。
6. 员工教育和培训：
   - 提供网络安全意识培训，教育员工识别和防范网络监听的常见手段和攻击方式，引导员工采取合适的安全措施。

需要综合使用多种防范手段，结合实际情况和需求来选择合适的防护措施，并定期进行安全策略的评估和更新，以提高网络的整体安全性。

**以下是一些常用的检测网络监听的手段：**

1. 反应时间：网络监听可能导致通信延迟增加，因为监听者需要截取和处理网络流量。因此，通过观察网络通信的反应时间变化，可以初步判断是否存在网络监听。如果通信延迟显著增加，可能意味着网络中有监听行为。

2. DNS测试：域名系统（DNS）测试是一种检测网络监听的方法。监听者可能会篡改或劫持DNS查询过程，将用户的域名解析请求重定向到恶意服务器。通过进行DNS测试，例如使用不同的DNS解析工具或检查域名解析结果的一致性，可以发现这种潜在的监听行为。

3. Ping监测：Ping是一种网络工具，用于测试主机之间的可达性和延迟。在网络监听情况下，监听者可能会拦截和修改Ping请求和响应。因此，通过使用Ping工具对目标主机进行测试，并观察Ping延迟和响应时间的异常变化，可以初步判断是否存在网络监听。

4. ARP数据包监测：地址解析协议（ARP）用于将IP地址映射到物理MAC地址。在网络监听中，监听者可能会通过ARP欺骗攻击来截取通信流量。通过监测ARP数据包，特别是检查ARP响应中的MAC地址与正常网络配置是否一致，可以发现潜在的ARP欺骗和监听行为。

需要注意的是，这些方法可以用作初步的网络监听检测手段，但不能保证100%的准确性。为了更全面地检测网络监听，建议使用多种方法和工具进行综合分析，并考虑使用专业的网络安全解决方案和技术。

### 10、什么是**字典文件**？在攻击中的作用？

书P47

### 11、**ping的优缺点**

书P30



### 12、**信息收集**的过程，结合经验和理解

1. 从一些社会信息入手：通过社工的方式，查找到目标的一些信息。可以参考CYPPT，上面有很多信息收集的内容。
2. 找到网络地址范围：比如通过社交软件获得目标所在地，获得大致ip范围。通过扫描技术，地址扫描
3. 找到关键的机器地址：通过扫描技术，地址扫描
4. 找到开放端口和入口点：端口扫描技术（以上都在课本p12）
5. 找到系统的制造商和版本：体系结构探测（课本p13）

### 13、有哪些**社工手段**可以被用来获取对网络攻击有价值的信息

（这里彭佳琳觉得应该再加一个phishing；以及这里的朋友圈我不确定是算作信息手机还是社工攻击，感觉社工更像一个主动的过程，我先把phishing加进去）

（1）**支付宝查询姓名**

最终社工手法我想是极为常见的一种方式，它的先决条件是获取到对方电话，电话号已注册支付宝。方式很简单，只需要选择转账输入大额转账，就会弹出对方姓名，除去姓氏的验证方式，嗯，这时你可以进行简单的猜解，或进行短信伪装调查

（2）**空间朋友圈查询信息**

这个方式通常是使用最多的，也是最简单的，同时也是最难分析的，这一条的前提是由对方QQ或者微信且空间处于开放状态，我们对其进行信息收集时，需注意一下几种关键信息：

一是机车等票类图片信息

二是生日类信息

三是位置类信息

四是游戏分享类信息，可从游戏接近对方

五是爱好类信息，可从兴趣圈接近对方

六是对方常留言好友或情侣

（3）**第三方信息收集**

此类方式可称为金钱万能法，你只需找一名私家侦探划伤两三百即可查找户籍，此法唯一的问题是可能遇到骗子，所以一般情况不建议使用

1. **伪装调查**

这种方式是最为实用的，成功率相对较高的方式，面对我们所需的各类信息，我们时常会缺少关键点，导致无法沿着线索向下继续查询，这时伪装调查往往会成为突破口，这里不介绍具体用什么身份，因为要视情况而定，我这里就讲几点伪装的要点

**一是伪装的要素，第一印象很重要**

面对各式各样的人，你想伪装的角色，一定要让你的目标第一眼就能看出你想要伪装的角色，例如伪装记者，你的胸口需要有一张假的记者证，并有录音笔笔记本正装等记者常见的装备要素

**二是伪装的要素，语句用词把握细节**

对于警惕性较高的人而言，你可能更需要把握细节，特别是你伪装的角色，涉及职业用语比较多的，你就需要对你的角色职业用语及一些关键的流程有所了解，并在最快的情况下完成你的目的，但也不可急于求成，反而容易使对方心生警惕

**三是伪装的细节，目的掩饰**

对于你真正的目的，切不可直接表现，要先使用一些无关紧要的信息作为掩饰，如涉及更加私密的信息，最好的办法是收集与其有关联的信息进行分析或多次接触处调查，降低对方警惕性

**四是伪装角色的选择**

对于伪装什么角色，这个问题很重要，决定了你的成功几率，我们模拟一下以下情景

你最近想去一家牛排店，这个信息被我知道了，这个时候我伪装成牛排店员工，假装有实名抽奖活动，可抽优惠券或免单卡，我们基本可以轻易拿到你的身份信息，电话甚至家庭情况等，我们只要准备那家店的广告单，或是开设一个虚拟的网站

分析上述内容角色的选择，最好是选择目标，有需要的角色或是对方经常接触社会常见的角色，这样才更容易上手。

2. **网络钓鱼（phishing）**

简单定义：网络钓鱼指的是使用精心布置的诱饵(如看起来很像来自一个真实公司或机构的E-mail以及异常相似的域名、网页)，这些诱饵是一些别有用心的人所设置，用于“钓取”用户的财政状况、信用卡详细情况和密码。钓鱼攻击使用的E-mail消息和网站看起来很像是来自一家合法的知名组织，其目的是骗取用户透露其个人、财政或计算机帐户信息。攻击者然后利用这些信息进行犯罪活动，如身分窃取、盗窃或欺诈。

常见手段：通过点击恶意电子邮件中假银行网站链接或是在浏览器的地址栏输错网站的某一个字符，都有可能误入网络骗子们精心设计的钓鱼网站，导致个人资料甚至是财物的丢失。面对层出不穷钓鱼网站，即使是高级的网络防火墙和强大的反病毒软件也无能为力。

攻击者身份伪造：诈骗者通常会将自己伪装成知名银行、在线零售商和信用卡公司等可信的品牌，因此来说，网络钓鱼的受害者往往也都是那些和电子商务有关的服务商和使用者。



### 14、如何搜集整理**攻击相关工具**

1. 网上博客，整理好的攻击方法和攻击工具大全
2. 技术论坛，大佬的讨论和前人的经验指引
3. 自己进行实际操作，通过攻击的需要寻找攻击相关的工具



### 15、网络攻击行为经常会留下哪些**痕迹**

1. 网站自身日志、网站中多出的后门、被修改的磁盘文件、运营商的记录、黑客和同伙交流在社交工具上留下的痕迹
2. 系统日志、防火墙日志、数据库日志等，以及其他类似的日志，也包括网关之类的访问记录；其中对入侵者最危险的记录包含了IP地址等相关信息，所以一名合格的黑客，必须能够伪装自己的IP地址；对于网站来说，检查日志能够及时发现被入侵，所以对于网站安全人员来说要有合适的制度来检查日志；而入侵者为了避免安全人员察觉，必须能够清理可疑的日志。



### 16、网络攻击常用的**反跟踪手段**有哪些

1. 如果知道确切IP地址，只有找相关地区的运营商，就可以确认你报装上网的地址
2. 攻破或欺骗运营商网络，这种方式能最接近完美地隐藏自己，但难度极大
3. 一般的来说，用网络跳板，比如在广州先将网络跳到北京，再跳到天津，再跳到上海，被攻击者记录的IP地址就是最后一跳的上海地址，极大的增加被追踪的可能性
4. 在小咖啡馆等有无线的地方蹭网

### 17、**ARP 欺骗**的原理、破绽特征、防护、检测

ARP 协议（Address Resolution Protocol）是一个工作在数据链路层的协议，用于将 IP 地址转换为 MAC 地址，以实现在局域网内的主机之间通信。ARP 协议通过广播方式发送 ARP 请求包，以获取目标主机的 MAC 地址。

由于 ARP 协议本身也存在安全缺陷，如 ARP 欺骗 (ARP spoofing) 攻击，攻击者通过伪造MAC 地址欺骗网络中的主机，将数据包发送到错误的目标主机，从而达到窃取网络数据的目的。

ARP 欺骗的特征就是不断的发 arp 包，让被攻击主机相信并修改 arp 表。

使用 wireshark 开启混杂模式后，只需抓取 arp 类型的包，看密集程度。一旦出现攻击态势，就可以快速对攻击和被攻击双方进行定位。

防护时：

1 最理想的防制方法是网络内的每台电脑 ARP 一律改用静态的方式，不过大型的网络是不可行，因为需要经常更新每台电脑的 ARP 表。

2 使用例如 DHCP snooping，网络设备可借 DHCP 保留网络上各电脑的 MAC地址，在伪造的 ARP 数据包发出时即可侦测到。

---

1. 建立正确的 ARP 映射关系、检测并过滤伪造的 ARP 报文，保证经过其转发的 ARP报文正确合法；
2. 抑制短时间内大量 ARP报文的冲击。
3. 在无线网络中，防御ARP欺骗的有效方法是网络管理员分别在主机或接入点上和路由器或控制器上对IP和MAC地址进行静态映射绑定。（ARP欺骗是通过重复应答实现的，那么只需要在主机添加一条静态的ARP映射，这样就不需要询问网关MAC地址了；对于网关欺骗还需要在网关中也添加一条到主机的静态ARP映射。）

---

**检测：**

1.主机级被动检测

当系统接收到来自局域网上的ARP请求时，系统检查该请求发送端的IP地址是否与自己的IP地址相同。如果相同，则说明该网络上另有一台机器与自己具有相同的IP地址。

2. 主机级主动检测

主机定期向所在局域网发送查询自己IP地址的ARP请求报文。如果能够收到另一ARP响应报文，则说明该网络上另有一台机器与自己具有相同的IP地址。

3. 服务器级检测

当服务器收到ARP响应时，为了证实它的真实性，根据反向地址解析协议(RARP)就用从响应报文中给出的 地 MAC址再生成一个RARP请求，它询问这样一个问题：“如果你是这个MAC地址的拥有者，请回答你的IP地址”。这样就会查询到这个MAC地址对应的IP地址，比较这两个IP地址，如果不同，则说明对方伪造了ARP响应报文。

4. 网络级检测

配置主机定期向中心管理主机报告其ARP缓存的内容。这样中心管理主机上的程序就会查找出两台主机报告信息的不一致，以及同一台主机前后报告内容的变化。这些情况反映了潜在的安全问题。或者利用网络嗅探工具连续监测网络内主机硬件地址与IP地址对应关系的变化。



### 18、**僵尸主机**多怎么办？

僵尸主机(沦为肉鸡)是指感染僵尸程序病毒，从而被黑客程序控制的计算机设备。其可以随时按照黑客的命令与控制指令展开 DoS 攻击或发送垃圾信息。

一般被侵占的电脑只是僵尸网络里面众多中的一个，会被用来去运行一连串的或远端控制的恶意程序

解决/检测：(特征 发动攻击时突然产生大量网络流量)

![image-20230609155401230](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230609155401230.png)

![image-20230609155407814](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230609155407814.png)

![image-20230609155416706](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230609155416706.png)

# 第四章 拒绝服务攻击

### 1、什么是**拒绝服务攻击**？如何分类？

- 定义(书P56、lm PPT p6)：拒绝服务攻击DoS（Denial of Service）是阻止或拒绝合法使用者存取网络服务器的一种破坏性攻击方式。这种攻击往往是针对TCP／IP协议中的某个弱点，或者系统存在的某些漏洞，对目标系统发起的大规模进攻使服务器充斥大量要求回复的信息，消耗网络带宽或系统资源，导致目标网络或系统不胜负荷以至于瘫痪而无法向合法的用户提供正常的服务
- 分类(书P57、lm PPT p9)
  
  ![image-20230611165032269](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230611165032269.png)

### 2、**DoS攻击的防范方法**

1. 确保服务器的系统文件是最新的版本,并及时更新系统补丁。

   要定期扫描现有的网络主节点,清查可能存在的安全漏洞,对新出现的漏洞及时进行清理。骨干节点的计算机因为具有较高的带宽,是黑客利用的最佳位置,因此对这些主机本身加强主机安全是非常重要的。而且连接到网络主节点的都是服务器级别的计算机,所以定期扫描漏洞就变得更加重要了。

2. 关闭不必要的服务
   过滤不必要的服务和端口.可以使用Inexpress、Express、Forwarding等工具来过滤不必要的服务和端口,即在路由器上过滤假IP。比如Cisco公司的 CEF(Cisco Express Forwarding)可以针对封包Source IP和Routing Table做比较,并加以过滤。只开放服务端口成为目前很多服务器的流行做法,例如WWW服务器那么只开放80而将其他所有端口关闭或在防火墙上做阻止策略。

3. 限制同时打开的SYN半连接数目,缩短SYN半连接的timeout时间,限制SYN/ICMP流量

   用户应在路由器上配置SYN/ICMP的最大流量来限制SYN/ICMP封包所能占有的最高频宽,这样,当出现大量的超过所限定的SYN/ICMP流量时,说明不是正常的网络访问,而是有黑客入侵。早期通过限制SYN/ICMP流量是最好的防范DOS的方法,虽然目前该方法对于Ddos效果不太明显了, 不过仍然能够起到一定的作用。

4. 正确设置防火墙

   禁止对主机的非开放服务的访问；限制特定IP地址的访问，（过滤所有RFC1918 IP地址RFC1918 IP地址是内部网的IP地址,像10.0.0.0、192.168.0.0和172.16.0.0,它们不是某个网段的固定的IP地址,而是Internet内部保留的区域性IP地址,应该把它们过滤掉。此方法并不是过滤内部员工的访问,而是将攻击时伪造的大量虚假内部IP过滤,这样也可以减轻Ddos的攻击。）启用防火墙的防DDoS的属性；严格限制对外开放的服务器的向外访问；运行端口映射程序祸端口扫描程序,要认真检查特权端口和非特权端口。

5.认真检查网络设备和主机/服务器系统的日志。只要日志出现漏洞或是时间变更,那这台机器就可能遭到了攻击。

6. 限制在防火墙外与网络文件共享。这样会给黑客截取系统文件的机会,主机的信息暴露给黑客,无疑是给了对方入侵的机会。
7. 充分利用网络设备保护网络资源
   所谓网络设备是指路由器、防火墙等负载均衡设备,它们可将网络有效地保护起来。当网络被攻击时最先死掉的是路由器,但其他机器没有死。死掉的路由器经重 启后会恢复正常,而且启动起来还很快,没有什么损失。若其他服务器死掉,其中的数据会丢失,而且重启服务器又是一个漫长的过程。特别是一个公司使用了负载 均衡设备,这样当一台路由器被攻击死机时,另一台将马上工作。从而最大程度的削减了Ddos的攻击。
8. 用足够的机器承受黑客攻击
   如果用户拥有足够的容量和足够的资源给黑客攻击,在它不断访问用户、夺取用户资源之时,自己的能量也在逐渐耗失,或许未等用户被攻死,黑客已无力支招儿了。不过此方法需要投入的资金比较多,平时大多数设备处于空闲状态,和目前中小企业网络实际运行情况不相符。
9. 检查访问者的来源
   使用Unicast Reverse Path Forwarding等通过反向路由器查询的方法检查访问者的IP地址是否是真,如果是假的,它将予以屏蔽。许多黑客攻击常采用假IP地址方式迷惑用户, 很难查出它来自何处。因此,利用Unicast Reverse Path Forwarding可减少假IP地址的出现,有助于提高网络安全性。

### 3、==（lm课后题1）==外部用户针对网络连接发动拒绝服务攻击有哪几种**模式**？并举例

- 模式(书P57)
- 举例(书P58-P60)

### 4、**同步包风暴(SYN Flooding)**拒绝服务攻击的原理、特点、如何防止

- 原理(书P63)
- 特点(书P66)
- 如何防止(书P66)

### 5、**ACK Flood攻击**的原理及防护

**原理：**

ACK Flood攻击是在TCP连接建立之后，所有的数据传输TCP报文都是带有ACK标志位的，主机在接收到一个带有ACK标志位的数据包的时候，需要检查该数据包所表示的连接四元组是否存在，如果存在则检查该数据包所表示的状态是否合法，然后再向应用层传递该数据包。如果在检查中发现该数据包不合法，例如该数据包所指向的目的端口在本机并未开放，则主机操作系统协议栈会回应RST包告诉对方此端口不存在。

这里，服务器要做两个动作：查表、回应ACK/RST。这种攻击方式显然没有SYN Flood给服务器带来的冲击大，因此攻击者一定要用大流量ACK小包冲击才会对服务器造成影响。按照我们对TCP协议的理解，随机源IP的ACK小包应该会被Server很快丢弃，因为在服务器的TCP堆栈中没有这些ACK包的状态信息。但是实际上通过测试，发现有一些TCP服务会对ACK Flood比较敏感，比如说JSP Server，在数量并不多的ACK小包的打击下，JSP Server就很难处理正常的连接请求。对于Apache或者IIS来说，10kpps的ACK Flood不构成危胁，但是更高数量的ACK Flood会造成服务器网卡中断频率过高，负载过重而停止响应。可以肯定的是，ACK Flood不但可以危害路由器等网络设备，而且对服务器上的应用有不小的影响。

如果没有开放端口，服务器将直接丢弃，这将会耗费服务器的CPU资源。如果端口开放，服务器回应RST。
**防护**

利用对称性判断来分析出是否有攻击存在。所谓对称型判断，就是收包异常大于发包，因为攻击者通常会采用大量ACK包，并且为了提高攻击速度，一般采用内容基本一致的小包发送。这可以作为判断是否发生ACK Flood的依据，但是目前已知情况来看，很少有单纯使用ACK Flood攻击，都会和其他攻击方法混合使用，因此，很容易产生误判。

一些防火墙应对的方法是：建立一个hash表，用来存放TCP连接“状态”，相对于主机的TCP stack实现来说，状态检查的过程相对简化。例如，不作sequence number的检查，不作包乱序的处理，只是统计一定时间内是否有ACK包在该“连接”(即四元组)上通过，从而“大致”确定该“连接”是否是“活动的”。

（每建立一个监听套接字，就将套接字挂入监听哈希表的某个表项链表中。则在内核收到连接请求的SYN或ACK等包传到TCP层时，要根据请求包的请求连接地址与端口号到哈希表中查找对应的服务器监听套接字是否存在）

### 6、简述**smurf攻击**的原理、特点、怎样防止

- 原理(书P67、lmPPTp21)：发送伪装的ICMP数据包，目的地址设为某个网络的广播地址，源地址设为要攻击的目的主机，使所有收到此ICMP数据包的主机都将对目的主机发出一个回应，使被攻击主机在某一段时间内收到 成千上万的数据包。

- 特点(百度+书P68)

  ![image-20210620163300989](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20210620163300989.png)

- 如何防止(书P68、lmPPTp23)

  - 实际发起攻击的网络：过滤掉源地址为其他网络的数据包

  - 被攻击者利用的中间网络：配置路由器禁止IP广播包

  - 被攻击的目标：与ISP协商，由ISP暂时阻止这些流量


### 7、简述**Ping Of Death**原理、怎样防止

- 原理(书P69)
- 如何防止
  - 向重组过程添加检查，以确保在数据包重组后不会超出最大数据包大小限制
  - 另一个解决方案是创建具有足够空间来处理超出准则最大值的数据包的内存缓冲区

### 8、（18-19简答1）简述**TearDrop**原理、怎样防止

- 原理(书P70)
- 如何防止
  - 网络安全设备将接收到的分片报文先放入缓存中，并根据源IP地址和目的IP地址对报文进行分组，源IP地址和目的IP地址均相同的报文归入同一组，然后对每组IP报文的相关分片信息进行检查，丢弃分片信息存在错误的报文
  - 为了防止缓存溢出，当缓存快要存满时，直接丢弃后续分片报文
- 反攻击方法：添加系统补丁程序，丢弃收到的病态分片数据包并对这种攻击进行审计。

### 9、简述**Winnuke**原理、怎样防止

- 原理(书P71)
- 怎样防止
  - 适当配置防火墙设备或过滤路由器(丢弃发往139端口的数据包)
  - 对这种攻击进行审计（记录事件发生的时间，源主机和目标主机的MAC地址和IP地址MAC）

### 10、简述**Land**原理、怎样防止

- 原理(书P71)
- 怎样防止
  - 配置防火墙，拦截类似的攻击包，以保护系统
  - 更新补丁，修复了漏洞
  - 路由器应同时配置上行与下行筛选器，屏蔽所有源地址与目标地址相同的数据包

### 11、简述**电子邮件轰炸拒绝服务攻击**的原理、造成的危害、如何防止

- 原理(书P72)
- 危害(书P72)
- 应对方法(书P73)



### 12、什么是**DDOS**攻击？特点？为什么危害性更强？

- 定义(书P74)

- 特点(书P74克服传统的缺点+P75现象+危害性更大+曹越第4章PPT34页)

- 为什么危害性更大(书P74克服了传统的缺点)

  > 传统的拒绝服务攻击的缺点：受网络资源的限制；隐蔽性差
  >
  > DDoS克服了这两个致命弱点：突破了传统攻击方式从本地攻击的局限性和不安全性；其隐蔽性和分布性很难被识别和防御



### 13、**DoS与DDoS攻击的原理和区别**

DOS攻击的原理：首先攻击者向被攻击的服务器发送大量的虚假ip请求，被攻击者在收到请求后返回确认信息，等待攻击者进行确认，（此处需要拥有HTTP协议工作方式和tcp三次握手的基本知识）该过程需要TCP的三次握手，由于攻击者发送的请求信息是虚假的，所以服务器接收不到返回的确认信息，在一段时间内服务器会处与等待状态，而分配给这次请求的资源却被有被释放。当被攻击者等待一定的时间后，会因连接超时而断开，这时攻击者在次发送新的虚假信息请求，这样最终服务器资源被耗尽，直到瘫痪。

DDOS的原理，它是在DOS基础上进行的大规模，大 范围的攻击模式，DOS只是单机和单机之间的攻击模式，而DDOS是利用一批受控制的僵尸主 机向一台服务器主机发起的攻击，其攻击的强度和造成的威胁要比DOS严重很多，更具破坏 性。首先DDOS攻击者要寻找僵尸主机，在互联网上寻找一些有后门漏洞的主机，然后入侵系 统安装控制程序，入侵的越多，控制的僵尸主机就越多，攻击源就更多，然后把入侵的主机 分配，一部分充当攻击的主要控制端，一部分充当攻击源，各负其责，在攻击者统一指挥下 对被攻击的服务器发起攻击，由于这个攻击模式是在幕后操作，所以很难被监控系统跟踪， 身份不容易被发现。

传统的拒绝服务攻击的缺点：受网络资源的限制；隐蔽性差

DDoS克服了这两个致命弱点：突破了传统攻击方式从本地攻击的局限性和不安全性；其隐蔽性和分布性很难被识别和防御

### 14、（20-21简答2）分别简述**DOS、DDOS攻击原理**，及对应技术缺陷。

DOS攻击的原理：首先攻击者向被攻击的服务器发送大量的虚假ip请求，被攻击者在收到请求后返回确认信息，等待攻击者进行确认，（此处需要拥有HTTP协议工作方式和tcp三次握手的基本知识）该过程需要TCP的三次握手，由于攻击者发送的请求信息是虚假的，所以服务器接收不到返回的确认信息，在一段时间内服务器会处与等待状态，而分配给这次请求的资源却被有被释放。当被攻击者等待一定的时间后，会因连接超时而断开，这时攻击者在次发送新的虚假信息请求，这样最终服务器资源被耗尽，直到瘫痪。

DDOS的原理，它是在DOS基础上进行的大规模，大 范围的攻击模式，DOS只是单机和单机之间的攻击模式，而DDOS是利用一批受控制的僵尸主 机向一台服务器主机发起的攻击，其攻击的强度和造成的威胁要比DOS严重很多，更具破坏 性。首先DDOS攻击者要寻找僵尸主机，在互联网上寻找一些有后门漏洞的主机，然后入侵系 统安装控制程序，入侵的越多，控制的僵尸主机就越多，攻击源就更多，然后把入侵的主机 分配，一部分充当攻击的主要控制端，一部分充当攻击源，各负其责，在攻击者统一指挥下 对被攻击的服务器发起攻击，由于这个攻击模式是在幕后操作，所以很难被监控系统跟踪， 身份不容易被发现。

传统的拒绝服务攻击的缺点：受网络资源的限制；隐蔽性差

DDoS克服了这两个致命弱点：突破了传统攻击方式从本地攻击的局限性和不安全性；其隐蔽性和分布性很难被识别和防御

---

**（from ChatGPT）**

DOS（拒绝服务攻击）和DDoS（分布式拒绝服务攻击）是两种常见的网络攻击方式，它们的原理和技术缺陷可以简要描述如下：

1. DOS攻击原理：
   DOS攻击旨在通过向目标系统发送大量的请求或占用其资源，使其无法正常工作或无法为合法用户提供服务。攻击者通常会利用目标系统的漏洞或弱点，发送大量请求、恶意数据包或者占用大量系统资源，导致目标系统无法响应合法用户的请求。

技术缺陷：

- 可伪造源IP地址：攻击者可以伪造源IP地址，使得目标系统难以追踪攻击来源。
- 单点攻击：DOS攻击通常是由单个主机或网络发起的，因此目标系统只需对抗单一攻击源。
- 依赖带宽：DOS攻击通常利用带宽消耗或资源耗尽来拒绝服务，因此如果目标系统具有足够的带宽或资源，攻击可能会被缓解。

2. DDoS攻击原理：
   DDoS攻击是DOS攻击的进一步演变，它利用多个分布在不同地理位置的恶意主机（僵尸网络或机器人网络）同时发起攻击，从而增加攻击的规模和复杂度。这些恶意主机通过控制节点（C&C服务器）进行协调，同时向目标系统发送大量请求，使其超负荷运行并无法为合法用户提供服务。

技术缺陷：

- 可伪造源IP地址：与DOS攻击类似，DDoS攻击也可以使用伪造的源IP地址，使得攻击难以被追溯。
- 分布式攻击：DDoS攻击利用分布在全球范围内的多个恶意主机发起攻击，使得目标系统面临多个攻击源，难以单独防御。
- 反射放大攻击：DDoS攻击中常使用反射放大技术，攻击者发送请求到具有放大效应的服务器，然后将放大的响应发送到目标系统，从而放大攻击流量，增加攻击威力。

需要注意的是，DOS和DDoS攻击都是违法行为，严重影响网络的正常运行和服务的可用性。网络管理员和安全团队应该采取相应的防御措施，包括使用防火墙、入侵检测系统（IDS/IPS）、流量过滤和分析工具等来减轻攻击的影响。



### 15、==（lm课后题2）==如何应对**DDOS攻击**，并举例

书P76

---

lm PPT p37

1. 在数据流中搜寻特征字符串
2. 利用攻击数据包的某些特征
3. 监视本地主机端口的使用
4. 对通信数据量进行统计

### 16、**反弹技术DRDoS(**曹越PPT 48)

反弹技术就是利用反弹服务器实现攻击的技术。所谓反弹服务器（Reflector）是指当收到一个请求数据报后就会产生一个回应数据报的主机。例如，所有的Web服务器、DNS服务器和路由服务器都是反弹服务器。攻击者可以利用这些回应的数据报对目标机器发动DDoS攻击。

反弹技术与传统DDoS区别：

1. 多了第四层——被锁定的反弹服务器层
2. 反弹服务器的数量可以远比驻有守护进程的代理服务器多
3. 使攻击时的洪水流量变弱，最终才在目标机汇合为大量的洪水
4. 目标机更难追查到攻击来源。目标机接收到的攻击数据报的源IP是真实的，反弹服务器追查到的数据报源IP是假的。

---

　DRDoS分布反射式拒绝服务攻击这是DDoS攻击的变形,它与DDoS的不同之处就是DrDoS不需要在攻击之前占领大量的“肉鸡”。它的攻击原理和Smurf攻击原理相近,不过DRDoS是可以在广域网上进行的,而Smurf攻击是在局域网进行的。它的作用原理是基于广播地址与回应请求的。一台计算机向另一台计算机发送一些特殊的数据包如ping请求时,会接到它的回应;如果向本网络的广播地址发送请求包,实际上会到达网络上所有的计算机,这时就会得到所有计算机的回应。这些回应是需要被接收的计算机处理的,每处理一个就要占用一份系统资源,如果同时接到网络上所有计算机的回应,接收方的系统是有可能吃不消的,就象遭到了DDoS攻击一样。不过是没有人笨到自己攻击自己,不过这种方法被黑客加以改进就具有很大的威力了。黑客向广播地址发送请求包,所有的计算机得到请求后,却不会把回应发到黑客那里,而是发到被攻击主机。这是因为黑客冒充了被攻击主机。黑客发送请求包所用的软件是可以伪造源地址的,接到伪造数据包的主机会根据源地址把回应发出去,这当然就是被攻击主机的地址。黑客同时还会把发送请求包的时间间隔减小,这样在短时间能发出大量的请求包,使被攻击主机接到从被欺骗计算机那里传来的洪水般的回应,就像遭到了DDoS攻击导致系统崩溃。骇客借助了网络中所有计算机来攻击受害者,而不需要事先去占领这些被欺骗的主机,这就是Smurf攻击。而DRDoS攻击正是这个原理,黑客同样利用特殊的发包工具,首先把伪造了源地址的SYN连接请求包发送到那些被欺骗的计算机上,根据TCP三次握手的规则,这些计算机会向源IP发出SYN+ACK或RST包来响应这个请求。同Smurf攻击一样,黑客所发送的请求包的源IP地址是被攻击主机的地址,这样受欺骗的主机就都会把回应发到被攻击主机处,造成被攻击主机忙于处理这些回应而瘫痪。

### 17、如何发现自己正在受到**消耗网络资源的dos攻击**

**（lm PPT p34）**

- 被攻击主机上有大量等待的TCP连接
- 端口随意
- 大量源地址为假的无用的数据包
- 高流量的无用数据造成网络拥塞
- 利用缺陷，反复发出服务请求，使受害主机无法及时处理正常请求
- 严重时会造成死机

---

**（课本p75）**
1、服务器主机上有大量等待的TCP连接；
2、检查网站后台服务器发现大量无用的数据包；
3、一段时期中IP请求异常且源地址虚假；
4、网络流量出现异常变化突然暴涨；
5、当发现Ping超时或丢包严重时，注意连接错误。假如遇到无法访问网站这种情况，并看到类似于“无法访问站点”之类的错误，且无法访问其他Internet服务，则可能是DoS攻击带来的影响。
6、查看自己的邮箱里是否突然收到大量的垃圾邮件。

---

- 网站离线，或请求响应很慢
- 打开网站带宽统计信息。如果发现带宽激增或者出现流量拥堵
- 源站 Web 服务器日志中有奇怪的请求，与正常的访问者行为不符



### 18、哪里可以方便查询DNS，whois之类的信息

DNS：使用nslookup工具，lm ppt第11和13页讲的挺细。

whois：本身whois工具（Linux集成）就可以在线查询whois信息；一定要找一些代理跳板性质或者离线查询的工具，就有很多集成好的网站（https://www.whois.net/）和工具（Sam Spade，对于windows的操作系统，要执行whois命令需要的一个第三方的工具）



### 19、同样的域名，为什么我ping的ip地址和别人不同

原因在于域名服务器实现了网络负载均衡机制。进一步说，这里常见的原因是DNS负载均衡的实现。DNS负载均衡技术是最早提出的用来解决负载平衡的技术，它的实现方式是通过DNS 服务中的名称随机的来解析，进而实现负载平衡。即同一个名字可以用于多个不相同的地址，当用户查询这个名字时，随机得到其中的一个地址。因此，不同的用户在查阅这个名字时将得到不同的地址，进一步访问不同地址的服务器，来达到负载均衡的目的。



### 20、连接**80端口**成功，一定是web服务器吗？连不通，一定没有web服务器吗？

前者：不一定，部分木马使用端（木马的client端）开启80端口，作为反弹连接的命令传输端口，绕过一些防火墙规则。

后者：首先，运行在443端口的https也算web服务提供以及8080端口是用于www代理服务的，也可以进一步连接www服务器提供web服务；其次，web服务可以开启在任意端口上，只是浏览器访问时需要连接形式为：域名：端口。



### 21、同一台机器可以允许两**个抓包软件**吗？

可以同时运行多个抓包软件；

- 抓包软件原理为设置网卡模式为混杂模式，接收全部的数据包并传送给上层调用进程。
- 虽然LibCap和Wincap的驱动设计不尽相同，但是均允许多个进程设置网卡混杂模式并以计数器形式的底层实现保证混杂模式的设置互不干扰；最终实现多个抓包软件的运行。



### 22、**跳板机**对口令文件破解太慢，怎么办

1、在本地进行口令文件破解

2、使用多台跳板机进行协同口令破解

3、根据社会工程学方法，缩小口令字典



**（ChatGPT)**

如果跳板机对口令文件破解速度过慢，可以考虑以下几个方法来提高破解效率：

1. 使用更强大的硬件：升级跳板机的硬件配置，例如增加CPU核心数、内存容量和硬盘速度等，以提高计算和破解的速度。
2. 并行化处理：使用多线程或分布式计算的方式，同时在多个计算节点上运行破解程序，将破解任务划分为多个子任务并并行处理，以加快破解速度。
3. 使用更强大的破解工具：考虑使用更高效的口令破解工具或算法，例如使用GPU加速的破解工具或使用更优化的字典攻击策略等。
4. 优化口令字典：对口令字典进行优化，去除冗余或无效的口令，增加常见口令和弱口令的覆盖率，以提高破解的成功率。
5. 利用预测和分析：通过分析目标系统用户的习惯和喜好，使用一些密码学的方法和算法来预测可能的口令，以提高破解的效率。
6. 增加破解资源：通过增加更多的计算资源，例如使用更多的计算机、云计算等方式，提供更多的计算能力来加速口令破解。

需要注意的是，口令破解涉及到对他人系统的未授权访问和潜在的违法行为。在进行任何口令破解活动之前，请确保你有合法授权和合规性，并遵守适用法律和道德准则。



### 23、哪里可以获得**常用口令文件**（同上）

用户的名字、生日、电话号码、身份证号码、所居住街道的名字等

# 第五章 缓冲区溢出攻击

### 1、什么是**缓冲区**

书P78

---

**（from lm PPT p7)**

连续的一段存储空间

### 2、描述一个具体程序的执行过程了解**栈帧的结构**

书P79例子

---

**lm PPT p26**

<img src="https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230611091336704.png" alt="image-20230611091336704" style="zoom: 50%;" />

<img src="https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230611091233792.png" alt="image-20230611091233792" style="zoom: 50%;" />

<img src="https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230611091245916.png" alt="image-20230611091245916" style="zoom:50%;" />

<img src="https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230611091302112.png" alt="image-20230611091302112" style="zoom:50%;" />

<img src="https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230611091318623.png" alt="image-20230611091318623" style="zoom:50%;" />

### 3、缓冲区溢出的**基本原理**

书P79

---

**(from lm PPT p12)**

- 代码在操作缓冲区时，没有有效地对缓冲区边界进行检查，使得写入缓冲区的数据量超过缓冲区能够容纳的范围，从而导致溢出的数据改写了与该缓冲区相邻存储单元的内容。

- C and C++ are the most common languages to create buffer overflows.

  C语言中许多字符串处理函数如：Strcpy、Strcat、Gets、Sprintf等都没有对数组越界加以检测和限制。

### 4、缓冲区溢出攻击的**一般目标**

书P82+单纯的缓冲区溢出并不能达到攻击的目的(曹越PPT第9页)

缓冲区溢出可以成为攻击者实现攻击目标的手段，但是单纯地溢出缓冲区并不能达到攻击的目的。在绝大多数情况下，一旦程序中发生缓冲区溢出，系统会立即中止程序并报告“fault segment”。例如缓冲区溢出，将使返回地址改写为一个非法的、不存在的地址，从而出现core dump错误，不能达到攻击目的。只有对缓冲区溢出“适当地”加以利用，攻击者才能通过其实现攻击目标。超出缓冲空间，覆盖正常程序或数据，使计算机转向预测程序。

---

**(from lm PPT p9 缓冲区溢出的危害)**

- 利用缓冲区溢出实现在本地或者远程系统上实现任意执行代码的目的，从而进一步达到对被攻击系统的完全掌控；
- 利用缓冲区溢出进行DoS(Denial of Service)攻击；
- 利用缓冲区溢出破坏关键数据，使系统的稳定性和有效性受到不同程度的影响；
- 实现蠕虫程序

### 5、（20-21简答3）简述**缓冲区溢出攻击的目标及步骤**。

**（from ChatGPT）**

缓冲区溢出攻击是一种常见的安全漏洞利用技术，其目标是通过向目标系统的缓冲区中输入超过其预期容量的数据来改变程序的正常行为。下面是缓冲区溢出攻击的一般步骤：

1. 目标确定：攻击者首先选择目标系统，通常是具有漏洞的软件程序或操作系统。

2. 漏洞分析：攻击者分析目标系统中存在的缓冲区漏洞，这些漏洞通常由于缺乏边界检查或长度验证而导致。

3. 构造恶意数据：攻击者根据漏洞的特点和目标系统的架构，构造特定的恶意数据，其中包括超出缓冲区容量的输入。

4. 注入恶意数据：攻击者将构造的恶意数据注入到目标系统的缓冲区中，通常通过输入字段或网络数据包的方式进行注入。

5. 覆盖目标数据：恶意数据的注入可能导致目标系统的缓冲区溢出，超出的数据可能会覆盖控制流指针、函数返回地址或其他重要的数据结构。

6. 控制流劫持：由于目标系统的缓冲区被溢出，攻击者可以通过精心构造的数据，改变程序的执行流程，例如跳转到攻击者注入的恶意代码。

7. 执行恶意代码：一旦攻击者成功劫持了程序的控制流，恶意代码将被执行，攻击者可以利用该代码执行各种恶意操作，如获取敏感数据、远程控制系统等。

需要注意的是，缓冲区溢出攻击是一种高级的攻击技术，需要攻击者对目标系统的漏洞有深入的了解。为了防止缓冲区溢出攻击，软件开发人员应该实施良好的编程实践，如输入验证、边界检查和安全编码等，以减少缓冲区漏洞的发生。同时，及时应用安全补丁和更新也是重要的防御措施。

---

**lm PPT p17 缓冲区溢出攻击模式**

<img src="https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230612125806458.png" alt="image-20230612125806458" style="zoom:67%;" />

### 6、要让程序**跳转到安排好的地址空间执行**，有哪些方法

书P83。函数指针、激活记录、长跳转缓冲区、植入码和流程控制

### 7、**为什么缓冲区溢出会成为操作系统、数据库等应用最普遍的漏洞之一**

书P84。这种攻击能够成功主要成功主要是利用了程序中边界条件、函数指针等设计不当的漏洞，即利用了C程序本身的不安全性。而大多数UNIX，Linux，Windows系统的开发都依赖于C语言，所以缓冲区溢出攻击成为操作系统、数据库等应用程序最普遍的漏洞之一。

### 8、**什么程序会发生缓冲区溢出**

> 根据缓冲区溢出的原因来回答

- 根本原因：程序未检测缓冲区的边界，使得数据写入大小超出缓冲区大小以致溢出；
- 使用c/c++等的非类型安全编程语言编写的程序，导致对内存的直接操作；
- 基于虚拟技术解释器模式（如JVM）类型安全编程语言的解释器本身存在的缓冲区漏洞；
- 使用了各类不安全的函数库编写的程序；

### 9、**UNIX**系统下，怎样使黑客即使成功溢出也不能获得root权限？

1. 使得溢出后shellcode不可执行，数据段或堆栈不可执行；
2. 使用编译保护技术，如Canary，保证程序发生溢出可以被检测到；
3. 这里如果把Grsecurity这种高安全性的Unix衍生系统算进来，还可以结合访问控制模型，因为Grsecurity实现了一定程度上的MAC（强制访问控制）



### 10、在**WINDOWS**下的缓冲区溢出方法与UNIX下有什么不同？

Windows系统和UNIX系统在内存空间分配上有很大不同,在溢出方法上也有很大区别。Windows系统的用户进程空间是0~2G,操作系统所占的空间为2 ~4G，事实上用户进程的加载位置为:0x00400000。这个进程的所有指令地址、数据地址和堆栈指针都会含有0,那么我们的返回地址就必然含有0。

考虑到栈的生长方向为由低地址到高地址，同时一般使用小端序设备；windows下缓冲区溢出时需要将溢出的address部分需要放在payload的最后位置（NNNNSSSSAAAA），以保证payload字符串不会由于/x00被截断溢出。



### 11、想一想**printf（）系列函数**中有哪些可以利用来进行缓冲区溢出攻击的漏洞？

格式化字符串漏洞

如果输入的字符串格式由用户定制，攻击者就可以伪造任意格式串，利用*printf ()系列函数的特性就可以窥探堆栈空间的内容，超常输入可以引发传统的缓冲区溢出，或是用“%n”覆盖指针、返回地址等。



### 12、**交换机缓冲区溢出攻击与监听**

交换机大多使用存贮转发技术，工作时维护着一张MAC地址与端口的映射表，这个表中记录着交换机每个端口绑定的MAC地址。他的工作原理是对某一段数据包进行分析判别寻址， 并进行转发，在发出前均存贮在交换机的缓冲区内。但是，交换机缓冲区是有限的。如用大 量无效IP包，包含错误MAC地址的数据帧对交换机进行攻击。该交换机将接收到大量的不符 合分装原则的包，造成交换机处理器工作繁忙，从而导致数据包来不及转发，进而导致缓 冲区溢出产生丢包现象。这时交换机就会退回到HUB的广播方式，向所有的端口发送数据包 。这样，**监听**就变得非常容易了。



# 第六章 程序攻击

### 1、==(lm课后题1）==试说明**逻辑炸弹**与病毒有哪些相同点与不同点？

**（书P109）**

不同于病毒的是，逻辑炸弹没有“传染性”，一般不像病毒那样可自动复制、传染。

---

**（from ChatGPT)**

逻辑炸弹和病毒在某些方面有相似之处，但在其他方面存在明显的不同。下面是它们的相同点和不同点的一些示例：

相同点：

1. 隐蔽性：逻辑炸弹和病毒都具有隐蔽性。它们都被设计成在系统内部运行或传播，而不被用户或防御机制察觉。
2. 恶意目的：逻辑炸弹和病毒都被设计用来造成破坏或不利影响。它们可以破坏计算机系统、窃取信息或干扰正常的系统操作。
3. 自我复制：某些类型的病毒和逻辑炸弹都能够自我复制，从一个系统传播到另一个系统，以便扩大其影响范围。
4. 需要宿主：逻辑炸弹和病毒都需要宿主环境来运行。逻辑炸弹通常依赖于特定的事件或条件来触发，而病毒需要感染特定类型的文件、程序或操作系统。

不同点：

1. 目标对象：逻辑炸弹主要针对特定的计算机系统、程序或文件。它们被设计成在满足特定条件时触发，从而造成破坏。而病毒可以针对各种系统和文件类型进行感染，包括计算机、移动设备、文档等。
2. 传播方式：逻辑炸弹通常是通过社会工程学手段或特定的触发条件传播，例如通过电子邮件附件、激活特定功能等方式。病毒则依赖于感染文件、程序或操作系统，通过它们的传输或执行来传播。
3. 操作方式：逻辑炸弹通常是一段恶意代码，当特定条件满足时，它会触发预定的行为，例如删除文件、破坏数据等。病毒则会嵌入到宿主文件或程序中，当它们被执行时，病毒会在后台运行并进行恶意操作。
4. 防御和清除：逻辑炸弹和病毒在防御和清除方面可能需要不同的方法。逻辑炸弹通常需要发现和解除其触发条件，或者使用特定的防病毒工具来检测和清除。病毒的防御通常涉及使用防病毒软件来检测和删除感染的文件、程序或操作系统。

需要注意的是，逻辑炸弹和病毒是计算机安全领域的术语，用于描述恶意软件的不同类型。在合法和道德的使用中，它们并不应该被创建或使用。

### 2、==(lm课后题2==、18-19论述1）为什么后来的木马制造者制造出**反弹式木马**，反弹式木马的工作原理是什么？画出反弹式木马的工作流程图

**为什么：书p134**

随着防火墙技术的发展，基于IP包过滤规则可以很有效地防止从外部来的连接，因此黑客在无法连接装有木马服务程序的计算机的情况下，就无法实施攻击。

于是木马设计者发明了一种反向连接技术，即所谓的反弹式木马。

**原理：**书p134

它利用防火墙对内部发起的连接请求无条件信任的特点，假冒是系统的合法网络请求与木马的客户端建立连接，从而达到对被攻击计算机控制的目的。其原理如图6-6所示：

<img src="https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230611115129960.png" alt="image-20230611115129960" style="zoom:67%;" />

### 3、==(lm课后题3）==**嵌入式木马**不同于主动型木马和反弹式木马的主要特点是什么？为什么这种木马更厉害，更不易被清除？

**特点:书p135-137**

嵌入式木马隐藏与一些已有的常用的网络程序中，并利用这些常用的网络程序转发木马命令。

**为什么不易清除：**

从其嵌入网络程序异常性小，实现原本应有功能，dll嵌入式和网页嵌入式的特点三个角度回答。

1. 嵌入网络程序异常性小：嵌入式木马将恶意代码嵌入合法的网络程序中，使其外观与正常程序几乎相同，没有明显的异常行为。这种隐蔽性使得嵌入式木马难以被系统或防病毒软件察觉。
2. 实现原本应有功能：嵌入式木马保持被感染程序的原本功能，同时执行恶意操作。用户在使用受感染程序时通常不会怀疑或发现其存在，从而使清除工作更加困难。
3. DLL嵌入式和网页嵌入式的特点：嵌入式木马常利用DLL和网页的特性进行嵌入。DLL嵌入式木马通过篡改合法的DLL文件，将恶意代码注入其中；网页嵌入式木马则通过在恶意网页中嵌入恶意代码。这些嵌入方式充分利用了系统组件和网络的特点，使得木马难以被察觉和清除。

### 4、**木马技术**包括哪些，这些技术有什么特点？

自启动技术,隐藏技术,远程监控技术(书p140-p150,基本就是每一章节第一段话)。

- 自动启动技术，木马程序第一次运行需要用户来执行，以后会启动系统时候自动装在服务端程序。

- 隐藏技术，木马程序不同于普通程序的最大特定就是想尽一切办法隐藏自己。
- 远程监控技术，木马的最主要功能，也是木马的最终目的。

---

- 自动启动技术：使木马在系统启动时自动运行，增加了持久性和隐蔽性。
- 隐藏技术：通过伪装、加密或混淆等手段使木马难以被发现和清除。
- 远程监控技术：允许攻击者远程控制被感染系统，并监视和操纵其行为。

特点总结：木马技术具有持久性（自动启动技术）、隐蔽性（隐藏技术）和远程控制能力（远程监控技术）。这些特点使得木马在攻击过程中更加难以察觉和清除，为攻击者提供了长期操控目标系统的能力。

---

木马技术包括自动启动技术、隐藏技术和远程监控技术，它们各自具有以下特点：

1. 自动启动技术：木马利用自动启动技术，使得它能够在系统启动时自动运行，无需用户手动执行。这种技术使木马能够在系统重启后仍然存在并继续执行恶意活动，增加了持久性和隐蔽性。

2. 隐藏技术：木马利用隐藏技术来避免被发现和清除。它可能隐藏在系统文件、进程或其他合法的应用程序中，使其在系统监控或防病毒扫描时难以被察觉。通过伪装、加密或混淆等手段，木马可以模糊其存在，以逃避安全防护措施的检测。

3. 远程监控技术：远程监控技术允许攻击者远程控制被感染系统，并监视和操纵受害者的行为。通过远程控制木马，攻击者可以执行各种恶意操作，如窃取敏感信息、操纵系统功能、远程执行命令等。这种技术使攻击者能够在远程位置对目标系统进行持续监控和操纵，而不需要直接接触被感染的计算机。

总之，自动启动技术使木马具备持久性，隐藏技术增加了木马的隐蔽性和逃避检测能力，而远程监控技术使攻击者能够远程控制和监控被感染系统。这些特点使木马成为一种危险的安全威胁，对个人和组织的机密信息和系统安全构成严重威胁。为了防范木马攻击，用户和组织应采取综合的安全措施，包括使用安全软件、定期更新系统和应用程序补丁、加强用户教育和培训等。



### 5、如何存放/投放**逻辑炸弹**以及逻辑炸弹的防御

逻辑炸弹可以以软件和硬件形态存在，如操作系统、应用软件、主板、CPU、FPGA等。

**投放逻辑炸弹的方法：**

1. 通过电子邮件发送恶意附件：攻击者可以通过电子邮件向受害者发送包含逻辑炸弹的恶意附件，一旦受害者打开附件，逻辑炸弹就会被激活。

2. 在网站上放置恶意代码：攻击者可以在一个看似正常的网站上放置恶意代码，当用户访问该网站时，逻辑炸弹就会被激活。

3. 通过远程访问工具投放逻辑炸弹：攻击者可以使用远程访问工具，如RAT（远程管理工具）或Backdoor等，在受害者计算机上投放逻辑炸弹。

**防御方法：**

1. 安装更新的防病毒软件：安装最新版本的防病毒软件可以帮助您检测和删除逻辑炸弹。

2. 不要打开来自未知来源的电子邮件附件：不要打开来自未知来源的电子邮件附件，尤其是那些看起来不寻常或不可信的附件。

3. 定期更新操作系统和应用程序：定期更新操作系统和应用程序可以帮助您修补已知的漏洞，从而减少逻辑炸弹攻击的风险。

4. 使用网络安全设备：使用网络安全设备，如防火墙、入侵检测系统和入侵防御系统等，可以帮助您检测和阻止逻辑炸弹攻击。



### 6、**后门和木马**的区别、联系

**在PPT“蠕虫和特洛伊木马”最后**

- 所谓“后门”，就是程序开发人员为了改进自己设计的程序而打开的专用接口（通道），方便自己修改程序，一般具有最高权限，特征在于隐蔽性，**没有欺骗性**。木马是指利用后门或漏洞被发现非法入侵用户电脑，从事侵害用户利益的活动，不一定具有最高权限。
- 联系在于：都是隐藏在用户系统中向外发送信息,而且本身具有一定权限,以便远程机器对本机的控制。
- 区别在于：木马是一个完整的软件,而后门则体积较小且功能都很单一。

---

**（lm PPT p21）后门 VS 特洛伊木马**

- 如果一个程序仅仅提供远程访问，那么它只是一个后门。
- 如果攻击者将这些后门伪装成某些其他良性程序，那么那就变成真正的特洛伊木马。
- 木马是披着羊皮的狼！！它对用户个人隐私造成极大威胁。



### 7、**后门的隐藏方式**

**应用级隐藏**

1. 后门程序和进程隐藏 选择一个隐秘的目录存放后门程序文件
2. 后门程序设置隐藏标记。
3. 定制程序名、修改图标。将自己的服务 端程序图标改成 HTML, TXT, ZIP 等各种文件的图
4. 附着、捆绑或替换合法文件。
5. 修改或替换管理命令。如替换“ ls”“find”“du”可以实现文件和目录隐藏; 替换 “ ps”“top”“ pidof”可以实现进程隐藏; 替换 Netstat, Ifconfig 可 实现网络的连接状态隐藏; 替换 Kill, Killall 可防止删除攻击者 的进程, 替换 Crontab 能隐 藏攻击者的定 时启动信息, 替 换 Tcpd, Syslogd 隐藏攻击者的连接信息等。
6. 进程动态注入。将后门程序可执行代码注入正在运 行的进程中, 可以极大地提高后门的生存能力。此项技术可以 很好地隐藏后门程序, 并且植入后门代理程序后

**通信状态隐藏**

1. 通信端口隐藏
2. 将后门隐藏在合法端口,
3. 通信连接隐藏
    检测方式：通信端口检查、通信特征匹配、植入痕迹查找和完整性检查

**内核级隐藏**

LKM( Loadable Kernel Modules) 内核加载模块隐藏

检测方式：内核级后门是在内核级隐藏目录、文件、进程和通信连接等, 它不修改程序二进制文件, 因此 MD5 校验无法检测。内核级隐藏的一种方法是通过修改系统调用表来实现系统调用重定向从而隐藏文件、进程和通信连接, 所以通过检查系统调用的内存地址就可能发现是否被植入了后门

常用查杀工具：rkhunter，chkrookit

### 8、**病毒 蠕虫 木马的区别**

首先病毒，木马，蠕虫统称为电脑病毒。病毒（包含蠕虫）的共同特征是自我复制、传播、破坏电脑文件，对电脑造成数据上不可逆转的损坏。而木马独有特征是伪装成正常应用骗取用户信任而入侵，潜伏在电脑中盗取用户资料与信息。

病毒：编制者在计算机程序中插入的破坏计算机功能或者数据的代码，能影响计算机使用，能自我复制的一组计算机指令或者程序代码。
1. 它必须能自行执行。它通常将自己的代码置于另一个程序的执行路径中。
2. 它必须能自我复制。例如，它可能用受病毒感染的文件副本替换其他可执行文件。病毒既可以感染桌面计算机也可以感染网络服务器。

木马：木马也称木马病毒，是指通过特定的程序来控制另一台计算机。与一般的病毒不同，它不会自我繁殖，也专并不“刻意”地去感染其他文件，它通过将自身伪装吸引用户下载执行，向施种木马者提供打开被种主机的门户，使施属种者可以任意毁坏、窃取被种者的文件，甚至远程操控被种主机。

蠕虫病毒：蠕虫病毒一种能够利用系统漏洞通过网络进行自我传播的恶意程序。它不需要附着在其他程序上，而是独立存在的。当形成规模、传播速度过快时会极大地消耗网络资源导致大面积网络拥塞甚至瘫痪。通过网络传播的恶性病毒，它具有病毒的一些共性，如传播性、隐蔽性、破坏性等等，同时具有自己的一些特征，如不利用文件寄生(有的只存在于内存中)， 对网络造成拒绝服务，以及和黑客技术相结合。普通病毒需要传播受感染的驻留文件来进行复制，而蠕虫不使用驻留文件即可在系统之间进行自我复制，普通病毒的传染能力主要是针对计算机内的文件系统而言，而蠕虫病毒的传染目标是互联网内的所有计算机。

按照传输方式分类 P130

# 第七章 欺骗攻击

### 1、**常见的欺骗攻击方式、共同特点、其他欺骗攻击**

- 欺骗攻击方式：DNS欺骗攻击、Email欺骗攻击、Web欺骗攻击、IP欺骗攻击
- 共同特点
  - 欺骗实质上就是一种冒充身份**通过认证骗取信任**的攻击方式。
  - 攻击者针对认证机制的缺陷，将自己伪装成可信任方，从而与受害者进行交流，最终窃取信息或是展开进一步攻击
- 其他欺骗攻击
  - ARP欺骗
    - ARP欺骗攻击就是利用ARP协议本身的缺陷进行的一种非法攻击，目的是为了在全交换环境下实现数据监听。**当主机收到一个ARP应答包后，它并不会去验证自己是否发送过这个ARP请求，而是直接将应答包里的MAC地址与IP对应的关系替换掉原有的ARP缓存表里的相应信息**。ARP欺骗正是利用了这一点
  - 短信欺骗
    - 短信欺骗是指诈骗者伪装成他人的电话号码发送短信，诈骗者用字母数字的发送者ID掩盖自己的身份，通常会包括恶意软件下载或钓鱼网站的链接
  - GPS欺骗
    - 当GPS接收器通过广播类似于真实信号的虚假信号来欺骗GPS接收机时，就会发生GPS欺骗攻击。换句话说，诈骗者假装在一个地方，实际上却在另一个地方。诈骗者可以用它来侵入汽车的GPS系统，把你发送到错误的地址，甚至干扰船舶、建筑物或飞机的GPS信号

### 2、==(lm课后题1==、20-21简答1）**DNS**的工作原理、DNS解析的过程中可能被欺骗的地方

**DNS（Domain Name System）的工作原理如下：**

（DNS（Domain Name System）是互联网中用于将域名转换为IP地址的系统。它通过一系列的查询和响应步骤来实现域名解析。当用户输入一个域名，计算机会发送查询请求给本地DNS解析器。本地DNS解析器会依次向根DNS服务器、顶级域名服务器和权威域名服务器发送查询请求，直到获取到域名对应的IP地址。最后，本地DNS解析器将IP地址返回给用户的计算机，使其能够建立与目标服务器的连接。这样，用户就能通过域名访问相应的网站或服务。）

1. 域名解析请求：当用户在浏览器中输入一个域名（例如example.com），计算机会将该域名发送给本地DNS解析器（也称为DNS客户端）。

2. 本地DNS解析器：本地DNS解析器是计算机或网络设备上的一个程序，它负责处理域名解析请求。它首先检查自己的缓存中是否有该域名的IP地址。如果有，则直接返回IP地址给浏览器；如果没有，则需要进行进一步的解析过程。

3. DNS递归查询：如果本地DNS解析器没有缓存该域名的IP地址，它会向根DNS服务器发送一个递归查询请求。根DNS服务器是DNS层次结构的最高级别，它不存储具体的域名记录，而是知道哪些顶级域名服务器可以提供所需的信息。

4. 顶级域名服务器：根DNS服务器会返回本地DNS解析器一个指向正确顶级域名服务器的响应。顶级域名服务器负责管理特定顶级域（例如.com、.net、.org等）下的域名解析。

5. 权威域名服务器：本地DNS解析器向顶级域名服务器发送一个查询请求，顶级域名服务器会返回一个指向正确的权威域名服务器的响应。权威域名服务器是负责管理特定域名下的IP地址和其他相关记录的服务器。

6. 解析结果返回：本地DNS解析器向权威域名服务器发送查询请求，并获得该域名对应的IP地址。本地DNS解析器将IP地址保存在缓存中，并将结果返回给浏览器。

**DNS解析过程中可能被欺骗的地方包括：**

1. DNS劫持：攻击者篡改了本地DNS解析器的响应，将用户的域名解析请求重定向到恶意的IP地址。这样，用户在访问一个合法网站时，可能会被重定向到一个恶意的网站。

2. DNS缓存投毒：攻击者通过发送恶意的响应给本地DNS解析器，使其缓存错误的DNS记录。这样，其他用户在使用相同的DNS解析器时，将会受到缓存中错误记录的影响。

3. DNS欺骗：攻击者伪造了DNS响应，向本地DNS解析器发送虚假的域名解析结果。这可能导致用户被重定向到恶意网站或受到其他形式的攻击。

### 3、（18-19简答2）**DNS欺骗攻击**的原理和过程

- 原理(书P158、lm PPT p6)

  假设当提交给某个域名服务器的域名解析请求的数据包被截获，然后按截获者的意图将一个虚假的IP地址作为应答信息返回给请求者，这时，原始请求者就会把这个虚假的IP地址作为它所要请求的域名而进行连接，显然它被欺骗到了别处而根本连接不上自己想要连接的那个域名。
  对那个客户想要连接的域名而言，它就算是被黑掉了，因为客户由于无法得到它的正确的IP地址而无法连接上它。

- 过程(书P159)
  - 嗅探DNS查询ID
  - 干扰DNS服务器
  - 发送欺骗包

---

**（from ChatGPT)**

DNS欺骗的过程一般包括以下步骤：

1. 监听DNS查询ID：攻击者在网络中监视DNS查询，并获取目标主机发送的DNS查询请求的ID。
2. 干扰DNS服务器：攻击者发送欺骗性的DNS响应，其中包含与目标主机查询相匹配的ID和虚假的IP地址或域名解析结果。
3. 发送欺骗包：攻击者将伪造的DNS响应发送给目标主机。这可以通过向目标主机发送伪造的DNS响应报文或在网络上广播伪造的DNS响应报文来实现。

当目标主机收到欺骗性的DNS响应后，它会将虚假的解析结果存储在本地DNS缓存中。下次用户尝试访问相同的域名时，目标主机将使用缓存中的虚假解析结果，导致用户被重定向到攻击者指定的恶意网站或服务器。

### 4、（18-19简答2）**DNS欺骗检测和防范思路**

**检测：**

发生DNS欺骗时，Client最少会接收到两个以上的应答数据报文，报文中都含有相同的ID序列号，一个是合法的，另一个是伪装的。据此特点，有以下两种检测办法：
      (1)被动监听检测。即监听、检测所有DNS的请求和应答报文。通常DNS Server对一个请求查询仅仅发送一个应答数据报文(即使一个域名和多个IP有映射关系，此时多个关系在一个报文中回答)。因此在限定的时间段内一个请求如果会收到两个或以上的响应数据报文，则被怀疑遭受了DNS欺骗。
      (2)主动试探检测。即主动发送验证包去检查是否有DNS欺骗存在。通常发送验证数据包接收不到应答，然而黑客为了在合法应答包抵达客户机之前就将欺骗信息发送给客户，所以不会对DNS Server的IP合法性校验，继续实施欺骗。若收到应答包，则说明受到了欺骗攻击。

**防范思路**
      在侦测到网络中可能有DNS欺骗攻击后，防范措施有：①在客户端直接使用IP Address访问重要的站点，从而避免DNS欺骗; ②对DNS Server和Client的数据流进行加密，Server端可以使用SSH加密协议，Client端使用PGP软件实施数据加密。
      对于常见的ID序列号欺骗攻击，采用专业软件在网络中进行监听检查，在较短时间内，客户端如果接收到两个以上的应答数据包，则说明可能存在DNS欺骗攻击，将后到的合法包发送到DNS Server并对DNS数据进行修改，这样下次查询申请时就会得到正确结果。

**防护方法：**
1 进行IP地址和MAC地址的绑定
 (1)预防ARP欺骗攻击。
 (2)DNS信息绑定。
2 使用Digital Password进行辨别
3.优化DNS SERVER的相关项目设置
4.直接使用IP地址访问
5.对DNS数据包进行监测

---

**防护方法的详细版本：**

   **4.1 进行IP地址和MAC地址的绑定**

   (1)预防ARP欺骗攻击。因为DNS攻击的欺骗行为要以ARP欺骗作为开端，所以如果能有效防范或避免ARP欺骗，也就使得DNS ID欺骗攻击无从下手。例如可以通过将Gateway Router 的Ip Address和MAC Address静态绑定在一起，就可以防范ARP攻击欺骗。

   (2)DNS信息绑定。DNS欺骗攻击是利用变更或者伪装成DNS Server的IP Address，因此也可以使用MAC Address和IP Address静态绑定来防御DNS欺骗的发生。由于每个Network Card的MAC Address具有唯一性质，所以可以把DNS Server的MAC Address与其IP Address绑定，然后此绑定信息存储在客户机网卡的Eprom中。当客户机每次向DNS Server发出查询申请后，就会检测DNS Server响应的应答数据包中的MAC Address是否与Eprom存储器中的MAC Address相同，要是不同，则很有可能该网络中的DNS Server受到DNS欺骗攻击。这种方法有一定的不足，因为如果局域网内部的客户主机也保存了DNS Server的MAC Address，仍然可以利用MAC Address进行伪装欺骗攻击。

   **4.2 使用Digital Password进行辨别**

   在不同子网的文件数据传输中，为预防窃取或篡改信息事件的发生，可以使用任务数字签名(TSIG)技术即在主从Domain Name Server中使用相同的Password和数学模型算法，在数据通信过程中进行辨别和确认。因为有Password进行校验的机制，从而使主从Server的身份地位极难伪装，加强了Domain Name信息传递的安全性。

   安全性和可靠性更好的Domain Name Service是使用域名系统的安全协议(Domain Name System Security, DNSSEC))，用Digital Signature的方式对搜索中的信息源进行分辨，对DATA的完整性实施校验，DNSSEC的规范可参考RFC2605。因为在设立Domain时就会产生Password，同时要求上层的Domain Name也必须进行相关的Domain Password Signature，显然这种方法很复杂，所以InterNIC域名管理截至目前尚未使用。然而就技术层次上讲，DNSSEC应该是现今最完善的Domain Name设立和解析的办法，对防范Domain Name欺骗攻击等安全事件是非常有效的。

   **4.3 优化DNS SERVER的相关项目设置**

   对于DNS Server的优化可以使得DNS的安全性达到较高的标准，常见的工作有以下几种：①对不同的子网使用物理上分开的Domain Name Server,从而获得DNS功能的冗余;②将外部和内部Domain Name Server从物理上分离开并使用Forwarders转发器。外部Domain Name Server可以进行任何客户机的申请查询，但Forwarders则不能，Forwarders被设置成只能接待内部客户机的申请查询;③采用技术措施限制DNS动态更新;④将区域传送(zone transfer)限制在授权设备上;⑤利用事务签名对区域传送和区域更新进行数字签名;⑥隐藏服务器上的Bind版本;⑦删除运行在DNS服务器上的不必要服务，如FTP、telnet和Http;⑧在网络外围和DNS服务器上使用防火墙,将访问限制在那些DNS功能需要的端口上。

   **4.4 直接使用IP地址访问**

   对个别信息安全等级要求十分严格的WEB站点尽量不要使用DNS进行解析。由于DNS欺骗攻击中不少是针对窃取客户的私密数据而来的，而多数用户访问的站点并不涉及这些隐私信息，因此当访问具有严格保密信息的站点时，可以直接使用IP地址而无需通过DNS解析，这样所有的DNS欺骗攻击可能造成的危害就可以避免了。除此，应该做好DNS Server的安全配置项目和升级DNS软件，合理限定DNS Server进行响应的IP地址区间，关闭DNS Server的递归查询项目等。

   **4.5 对DNS数据包进行监测**

   在DNS欺骗攻击中，Client会接收到至少两个DNS的数据响应包，一个是真实的数据包，另一个是攻击数据包。欺骗攻击数据包为了抢在真实应答包之前回复给Client，它的信息数据结构与真实的数据包相比十分简单，只有应答域，而不包括授权域和附加域。因此，可以通过监测DNS响应包，遵循相应的原则和模型算法对这两种响应包进行分辨，从而避免虚假数据包的攻击。

### 5、==（lm课后题2）==假如你的主机在面临**DNS欺骗攻击**，应该采取什么样的**策略和解决方案**

①直接用IP访问重要的服务，从而避开DNS欺骗攻击。

②使用自定义的DNS服务器并刷新DNS解析缓存

注意MAC地址和IP地址是否遭到了替换和修改。如果确认MAC地址为真，可打开路由器，通过相互对应的MAC查找IP地址，或将MAC地址添加到路由器的安全地址过滤功能当中进行处理并启用，这样有问题的电脑会自动断线。若安装了ARP防火墙，一般情况下能够防御大部分攻击，但如果在拥有防火墙的情况下遭到攻击，首先要做的是查出攻击来源，然后将主机系统重新设置并重启。

---

**(from ChatGPT)**

如果您的主机面临DNS欺骗攻击，您可以采取以下策略和解决方案来应对和解决问题：

1. 清除DNS缓存：首先，清除您主机上的DNS缓存，以删除可能被篡改的虚假解析结果。具体的方法可能因操作系统而异，您可以通过执行适当的命令或重启网络连接来清除DNS缓存。

2. 使用可信赖的DNS解析器：确保您的主机使用可信赖的DNS解析器，如您的互联网服务提供商（ISP）的DNS服务器或其他受信任的DNS服务器。避免使用未经验证的公共DNS服务器，因为它们可能容易受到DNS欺骗攻击。

3. 配置防火墙规则：在您的主机或网络中配置防火墙规则，以限制对DNS服务器的访问。只允许来自可信赖的IP地址或特定的DNS服务器的查询和响应流量。

4. 使用DNSSEC：如果可能的话，启用DNSSEC（Domain Name System Security Extensions）。DNSSEC可以提供数字签名机制，用于验证DNS响应的真实性和完整性，有效防止DNS欺骗攻击。

5. 定期更新和监控：定期更新您的主机和网络设备上的软件和配置，以修补已知的安全漏洞，并监控网络流量以检测异常的DNS响应或活动。

6. 加密通信：尽可能使用加密的通信协议，如HTTPS，以保护DNS查询和响应的机密性，并减少中间人攻击的风险。

7. 加强安全意识培训：提高用户和网络管理员的安全意识，教育他们如何辨别钓鱼网站和恶意链接，并采取适当的防范措施。

重要的是要综合使用这些策略和解决方案来增强您主机的安全性，并与网络管理员、安全专家或互联网服务提供商合作，共同应对和解决DNS欺骗攻击问题。

### 6、**E-mail欺骗攻击**的原理和过程

- 原理(书P161)：攻击者佯称自己为系统管理员（邮件地址和系统管理员完全相同），给用户发送邮件要求用户修改口令（口令可能为指定字符串）或在貌似正常的附件中加载病毒或其他木马程序。
- 过程(书P162-P163、lm PPT p9)：
  - SMTP服务器（允许匿名登录）
  - 填写假的名称和发信人地址
  - 使用web形式骗取密码，或者使用附件植入木马

### 7、假如你是一名网络管理员，对于**邮件欺骗攻击**你的忠告

即如何应对邮件欺骗攻击

lm PPT p10

- 查看邮件原文，检查真正的发件服务器地址
- 通过邮件链接网页的时候，注意真正的网站地址
- 在不同的应用中，尽可能使用不相同的、无关的密码

### 8、针对**Email**应用，除了Email欺骗，还有哪种攻击方式？

Email电子邮件轰炸攻击，见书P161 P72 

存储资源消耗Dos攻击

---

除了常见的电子邮件欺骗攻击，还有其他一些针对电子邮件应用的攻击方式，包括以下几种：

1. 垃圾邮件（Spam）：攻击者通过发送大量的垃圾邮件，试图诱骗或欺骗用户。这些垃圾邮件可能包含广告、欺诈信息、恶意链接或附件。

2. 钓鱼邮件（Phishing）：攻击者伪装成可信任的实体（如银行、在线服务提供商或知名企业），通过发送伪造的电子邮件来欺骗用户。这些电子邮件通常包含欺骗性链接，目的是诱使用户提供敏感信息，如用户名、密码、信用卡号等。

3. 勒索软件（Ransomware）：攻击者通过携带恶意附件或链接的电子邮件，在用户打开附件或点击链接后，感染用户的计算机或网络。勒索软件将用户的数据加密，并勒索赎金以恢复数据。

4. 电子邮件劫持（Email Hijacking）：攻击者通过获取用户的电子邮件凭据，非法访问其电子邮件账户，并进行未经授权的操作，如发送垃圾邮件、篡改邮件内容或访问敏感信息。

5. 雷克索攻击（Wrecking Attacks）：攻击者通过发送大量的无效电子邮件或恶意附件，占用目标系统的存储空间和带宽，以阻塞或拖垮电子邮件服务器。

6. 社交工程：攻击者通过与目标用户进行交流，利用人类的社交弱点来获取敏感信息或进行其他恶意活动。这可能包括通过电子邮件与用户建立信任关系，以获取他们的敏感信息。

### 9、==（lm课后题3）==**Web欺骗攻击**有哪些具体形式？请简述其原理

- 具体形式(书P165-P167+lmPPT第13页)
  - 使用相似的域名、改写URL、劫持Web会话
- 原理(见lmPPT第12页+书P163)：攻击者通过伪造某个WWW站点的影像拷贝，使该Web的入口进入到攻击者的Web影像服务器，并经过攻击者机器的过滤作用，从而达到攻击者监控受攻击者的任何活动以获取有用信息的目的。



---

**（from ChatGPT)**

Web欺骗攻击可以采用以下具体形式：

1. 使用相似的域名：攻击者创建与合法网站相似的域名，例如使用类似的拼写、替换字符或添加额外字符。当用户访问这个伪造的域名时，他们可能会误认为它是合法的网站，并在其中输入敏感信息。

2. 改写URL：攻击者可以通过各种手段篡改URL，使用户访问的网址看起来与实际目标不符。这可能包括在URL中插入特殊字符、重定向用户到伪造的网页或隐藏真实URL。

3. 劫持Web会话：攻击者可以通过窃取用户的会话信息或欺骗用户登录伪造的网站来劫持Web会话。一旦攻击者控制了用户的会话，他们可以冒充用户，执行未经授权的操作，访问用户的敏感信息，或者以用户的身份进行其他恶意活动。

这些攻击形式的原理在于利用用户对合法网站的信任和对URL的误解。攻击者通过伪造或篡改与合法网站相关的元素，欺骗用户将信任和敏感信息提供给攻击者。为了防范这些攻击，用户应该保持警惕，注意验证网站的域名和URL的完整性，避免在不明确或可疑的网站上输入敏感信息。网站管理员可以采取安全措施，如使用SSL加密、实施身份验证和访问控制，以确保用户与合法网站的通信安全可靠。

### 10、==（lm课后题4）==如果你是开发者，采用何种手段避免你的网站受到潜在的**Web欺骗攻击**

（lm PPT p17）

<img src="https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230611120101667.png" alt="image-20230611120101667" style="zoom:50%;" />

---

**课本P168**

---

**（from ChatGPT)**

作为开发者，以下是一些手段可以帮助你避免网站受到潜在的Web欺骗攻击：

1. 输入验证和过滤：对于用户输入的数据，进行适当的验证和过滤，防止恶意代码的注入。使用白名单或正则表达式来验证输入，确保只接受预期的数据格式。

2. 防止跨站脚本攻击（XSS）：对于从用户接收的输入和输出，使用适当的编码和转义技术，以防止恶意脚本的执行。对用户输入的数据进行适当的处理，例如转义特殊字符和标签。

3. 使用安全的会话管理：确保在用户会话中使用安全的会话管理机制，包括生成随机且不可预测的会话标识符、设置适当的会话过期时间，并在敏感操作后及时注销会话。

4. 强化访问控制：实施适当的访问控制机制，包括身份验证、授权和权限验证，确保用户只能访问其授权的资源。

5. 加强安全日志和监测：记录网站的访问日志和事件，监测异常活动和恶意行为。及时检测和响应潜在的攻击，以便采取适当的措施。

6. 安全补丁和更新：定期更新和修补Web应用程序的漏洞和安全问题。保持与最新的安全更新和补丁，以减少攻击面。

7. 教育和培训：提高开发人员和管理员的安全意识，使他们了解常见的Web攻击类型、最佳实践和安全开发方法。持续进行安全培训，并定期审查和更新安全策略。

8. 安全测试和审计：进行安全测试，包括漏洞扫描、渗透测试和代码审计，以发现和修复潜在的安全漏洞。

综合采取这些措施可以帮助你保护你的网站免受潜在的Web欺骗攻击。此外，与专业的安全团队合作，参考安全标准和最佳实践，以确保你的网站具备较高的安全性。

### 11、**IP欺骗**的原理和过程(同第二章第5点

**原理：**

利用hosta和hostb基于IP地址建立的信任关系，如果能够冒充hostb的IP，就可以使用rlogin登录到hosta，而不需要任何口令验证。

> IP 欺骗攻击指攻击行动产生的 IP 数据包为伪造的源 IP 地址，以便冒充其他系统或发件人的身份。这是一种黑客的攻击形式，黑客使用一台计算机上网，而借用另外一台机器的 IP 地址，从而冒充另外一台机器与服务器进行交互。

**过程：（lm PPT p23）**

- 首先使被信任主机的网络暂时瘫痪
- 连接到目标机的某个端口来猜测ISN基值和增加规律
- 把源址址伪装成被信任主机，发送带有SYN标志的数据段请求连接
- 等待目标机发送SYN+ACK包给已经瘫痪的主机
- 再次伪装成被信任主机向目标机发送的ACK，此时发送的数据段带有预测的目标机的ISN+1 
- 连接建立，发送命令请求

### 12、简述**tcp建立连接**的过程

- 书P170

  <img src="https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/8583053-c1a4f51413d2b1e1..jpg" alt="img" style="zoom:67%;" />

由于TCP是面向连接的协议，所以在双方正式传输数据之前，需要用“三次握手”来建立一个值得信赖的连接：

1. 客户端发送一个带有SYN标志的连接请求包给服务器。
2. 服务器收到请求后，会回复一个带有SYN和ACK标志的确认包给客户端。
3. 客户端收到服务器的确认包后，再次向服务器发送一个带有ACK标志的确认包。
4. 服务器收到客户端的确认包后，双方建立起TCP连接，可以开始进行数据传输。

通过三次握手，客户端和服务器之间建立了一个可靠的连接，确保双方可以进行数据的可靠传输和通信。

### 13、**TCP、Ipv4协议**在安全性欠缺考虑的地方，如何改进

- TCP安全性

  - ISN号不是随机的，有规律可循
  - 可能存在TCP ACK风暴
  - 存在SYN Flooding攻击

- TCP改进

  - 增加ISN的随机性，使攻击者难以找到规律

  - 使用SYN cookie

    SYN Cookie是对TCP服务器端的三次握手协议作一些修改，专门用来防范SYN Flood攻击的一种手段。它的原理是，在TCP服务器收到TCP SYN包并返回TCP SYN+ACK包时，不分配一个专门的数据区，而是根据这个SYN包计算出一个cookie值。在收到TCP ACK包时，TCP服务器再根据那个cookie值检查这个TCP ACK包的合法性。如果合法，再分配专门的数据区进行处理未来的TCP连接。

  - 使用tls加密tcp流量

    安全传输层协议(TLS)用于在两个通信应用程序之间提供保密性和数据完整性。该协议由两层组成：TLS记录协议(TLSRecord)和TLS握手协议(TLS Handshake)。较低的层为TLS记录协议，位于某个可靠的传输协议(例如TCP)上面。

- IP安全性

  - 在路由时对IP源地址不做任何检查，存在IP欺骗攻击
    - 例如smurf攻击利用了路由器不检查源地址不属于该网段
  - 某些网络应用基于IP地址建立信任关系，容易被攻击者利用IP源地址欺骗造成威胁
  - 攻击者可以填入伪造的IP隐藏自己真实的IP地址

- IP改进

  - 抛弃基于IP地址的信任策略
  - 进行包过滤，丢弃源地址不是本网段的数据包
  - 采用ipsec(书P315)等安全协议，对IP数据包进行高强度的数据处理

---

TCP/IP的安全性隐患？改进措施？
1、链路层上的攻击

在TCP/IP网络中，链路层这一层次的复杂程度是最高的。其中最常见的攻击方式通常是网络嗅探组成的TCP/IP协议的以太网。

以太网卡有两种主要的工作方式，一种是一般工作方式，另一种是较特殊的混杂方式。这一情况下，很可能由于被攻击的原因而造成信息丢失情况，且攻击者可以通过数据分析来获取账户、密码等多方面的关键数据信息。 
2、网络层上的攻击

如果ARP识别链接错误，这样的话ARP直接应用可疑信息，那么可疑信息就会很容易进入目标主机当中。ARP协议没有状态，不管有没有收到请求，主机会将任何受到的ARP相应自动缓存。

如果信息中带有病毒，采用ARP欺骗就会导致网络信息安全泄露。因此，在ARP识别环节，应加大保护，建立更多的识别关卡，不能只简单通过IP名进行识别，还需充分参考IP相关性质等。
3、传输层上的攻击

在传输层还存在网络安全问题。如在网络安全领域中，IP欺骗就是隐藏自己的有效手段，主要是通过将自身IP地址进行伪造，并向目标主机发送恶意的请求，攻击主机，而主机却因为IP地址被隐藏而无法准确确认攻击源。或者通过获取目标主机信任而趁机窃取相关的机密信息。
4、应用层上的攻击

对于因特网而言，IP地址与域名均是一一对应的，这两者之间的转换工作，被称为域名解析。而DNS就是域名解析的服务器。DNS欺骗指的是攻击方冒充域名服务器的行为，使用DNS欺骗能将错误DNS信息提供给目标主机。所以说，通过DNS欺骗可误导用户进入非法服务器，让用户相信诈骗IP。

### 14、**不在一个子网中的tcp劫持**(欺骗手法)

（lm PPT p38）

有时候也称作“Blind spoofing”

攻击者发送一个SYN包然后猜测服务器的ISN。只要能够猜得到，就可以建立连接。但是攻击者收不到服务器给客户的包（使用源路由技术？）。

条件：真正的客户不能发送RST包；攻击者能够猜测服务器每个包的大小



- 猜测服务器ISN和每个包的大小

- 采用源路由欺骗

  - 解释一

    IP源路由欺骗，如果发送方进行了源路由欺骗，比如说，C进行源路由欺骗，伪装成B的ip地址，给服务器A发送了一个包。此时A收到包后发现要返回信息，正常的话因为发送栏地址是B,应该返回给B但是由于源路由信息记录了来时的路线，反推回去就把应该给B的信息给了C,而A没有意识到问题，B对此一无所知，C拿到了B才能拿到的信息。

  - 解释二

    某些路由器在处理带路由记录选项的IP报文时，不再按照目的地址查询路由表匹配的方式处理，而是根据路由记录直接反向推送数据包，这样导致了源路由IP欺骗的可能性。用户可以伪装信任IP发送数据报文，并开启源路由记录功能，路由器根据源路由回送数据包，从而使攻击者可以解决IP欺骗报文回包接收问题。从而以信任IP站的身份和权限访问相关的受保护的资源数据，甚至进行破坏活动，进一步入侵。
  



### 15、如何识别**服务器应答包与虚假包**

识别服务器应答包和虚假包是网络安全中的重要任务，下面是一些常见的方法和技术，可用于帮助你进行这种识别：

1. 包分析：使用网络抓包工具，如Wireshark，对服务器应答包进行详细分析。观察包的头部信息、源和目标IP地址、协议类型等，以确定其是否合法和与预期的通信相符。

2. 验证身份验证和数字签名：虚假包通常不会具备有效的身份验证或数字签名。确保服务器应答包使用正确的数字证书和签名，可以验证其真实性。

3. 检查数据完整性：使用校验和、散列算法或消息认证码（MAC）等技术来验证服务器应答包的数据完整性。如果数据完整性验证失败，可能表示该包被篡改或伪造。

4. 比较与正常流量的差异：了解正常的服务器应答包的特征和模式，可以帮助你识别虚假包。通过比较当前的应答包与已知的正常流量，查找任何异常之处，如数据包大小、延迟、流量模式等。

5. 使用入侵检测系统（IDS）：IDS系统能够监测和识别网络上的异常活动和攻击。配置IDS以监视服务器的流量，并使用已知的攻击签名或行为规则来检测虚假包。

6. 异常检测：使用机器学习或统计分析等技术，构建模型来检测异常的服务器应答包。这些模型可以通过学习正常的网络流量模式，识别与正常行为不符的异常包。

7. 网络流量监控：使用网络流量监控工具，如网络入侵防御系统（NIDS）或网络流量分析工具，实时监控服务器的流量。这样可以及时发现任何异常的应答包或不寻常的流量模式。

需要注意的是，识别服务器应答包和虚假包是一个复杂而持续的过程。网络安全领域的技术和方法不断发展和演进，因此持续学习和保持对最新威胁的了解非常重要。同时，与安全专家和团队合作，共享信息和经验，可以帮助提高对虚假包的识别能力。



### 16、TCP会话劫持 ，监听者如何**猜测序列号**。补充：防御措施

​	书P170

---

在TCP会话劫持中，监听者（攻击者）可以尝试猜测TCP序列号来实现劫持。下面是一些可能用于猜测序列号的技术和方法：

1. 初始序列号猜测：TCP通信开始时，每个连接都会使用一个初始序列号（ISN）来标识通信的起点。监听者可以尝试猜测这个初始序列号，以便在之后的通信中进行劫持。攻击者可能使用一些已知的算法或技术来推测ISN，如时序分析、统计分析或探测系统特征等。
2. 基于已有连接的序列号预测：如果监听者已经在同一网络中拦截了之前的TCP连接，他们可以通过观察和分析该连接的序列号模式来预测后续连接的序列号。攻击者可以利用TCP序列号的增量规律或特定的模式来进行推测。
3. 重放攻击和序列号推测：监听者可以使用重放攻击来获取一方的序列号。通过观察被攻击者的响应，攻击者可以尝试推测出用于通信的序列号。

需要指出的是，猜测TCP序列号是一种有风险且不可靠的攻击方法。TCP协议的设计意图是保证序列号的随机性和预测的困难性，以提高安全性。然而，在某些情况下，攻击者可能仍然能够成功地猜测序列号并进行会话劫持。

**为了减少TCP会话劫持的风险，可以采取以下措施：**

1. 实施加密：通过使用TLS/SSL等加密协议来保护TCP连接，可以防止监听者在传输过程中窃取序列号或劫持会话。
2. 建立安全隧道：通过使用VPN或SSH等安全隧道，将TCP连接封装在加密的通道中，确保数据的机密性和完整性。
3. 实施网络防火墙和入侵检测系统：配置防火墙和入侵检测系统，以监视和检测潜在的会话劫持攻击，并采取相应的防御措施。
4. 定期更新和维护系统：保持操作系统、网络设备和应用程序的更新和修补程序，以修复已知的漏洞和安全问题，减少攻击者利用的机会。

综上所述，保护TCP会话免受劫持的关键是使用加密和安全通信协议，以及实施综合的网络安全措施，以降低攻击者猜测序列号的成功率。

# 第八章 利用处理程序错误攻击

### 补充：ASP

ASP是"Active Server Pages"的缩写，它是一种由微软开发的服务器端脚本技术。ASP允许开发人员使用嵌入在HTML页面中的脚本代码来生成动态的网页内容。

ASP使用VBScript或JScript等脚本语言编写，并通过服务器上的ASP引擎解释和执行这些脚本。当用户请求一个包含ASP脚本的网页时，服务器会解析脚本，执行它们并生成相应的HTML内容，然后将HTML内容发送给用户的浏览器进行显示。

ASP具有以下特点：

1. 动态内容生成：通过在ASP脚本中编写逻辑和算法，可以根据用户请求、数据库查询结果和其他外部数据生成动态的网页内容。

2. 与数据库的交互：ASP可以与各种数据库进行交互，执行查询、插入、更新和删除等操作，并将数据库中的数据动态显示在网页上。

3. 服务器端处理：ASP脚本在服务器上执行，而不是在用户的浏览器上执行。这样可以保护脚本代码和敏感信息，同时减轻了客户端的计算负担。

4. 可扩展性：ASP可以与其他技术和组件结合使用，如ASP.NET、COM组件和第三方库，以实现更复杂的功能和扩展性。

ASP在过去是一种非常流行的服务器端脚本技术，被广泛用于开发动态网站和Web应用程序。然而，随着时间的推移，ASP逐渐被更现代和功能更强大的技术如ASP.NET、PHP、Python等所取代。

### 1、==（lm课后题1）==简述用**ASP**编写的网站的常见攻击方式有哪些？

**书p200-p206 8.2.3的各个章节标题**

1. 泄漏ASP源代码
2. FileSystemObject组件篡改下载FAT分区上的任何文件的漏洞
3. 输入标准的HTML语句或者JavaScript语句会改变输出结果
4. Access MDB数据库有可能被下载的漏洞
5. asp程序密码验证漏洞
6. IIS4或者IIS5中安装有Index Server服务器漏洞ASP源程序
7. NT Index Server存在返回上级目录的漏洞

---

**（from ChatGPT)**

使用ASP编写的网站可能面临多种攻击方式。以下是一些常见的ASP网站攻击方式：

1. SQL注入攻击：攻击者通过在输入字段中注入恶意的SQL代码来篡改或绕过数据库查询。这可能导致数据泄露、数据库被删除或篡改、未经授权的访问等问题。

2. XSS攻击（跨站脚本攻击）：攻击者在网页中插入恶意的脚本代码，当其他用户访问受影响的页面时，这些脚本会在他们的浏览器中执行。这可能导致用户会话劫持、窃取敏感信息或进行其他恶意操作。

3. CSRF攻击（跨站请求伪造攻击）：攻击者利用用户已经通过认证的会话，发送伪造的请求给目标网站。当受害者访问包含恶意请求的页面时，他们的操作会触发这些请求，导致未经授权的操作或数据泄露。

4. 文件包含攻击：攻击者利用网站中的漏洞，通过包含恶意文件或外部资源来执行恶意代码。这可能导致服务器受到控制、执行任意代码或访问敏感文件。

5. 会话劫持：攻击者窃取合法用户的会话凭证，然后使用这些凭证冒充用户，获取其权限并进行未经授权的操作。

6. 敏感数据泄露：由于错误的配置或漏洞，网站可能意外泄露用户的敏感信息，如用户名、密码、信用卡号等。

这些攻击方式都可以对使用ASP编写的网站造成严重的安全威胁。为了防范这些攻击，开发人员应采取安全编码实践，如输入验证和过滤、参数化查询、安全的会话管理、访问控制和安全配置。定期更新和修补网站以修复已知的漏洞也是重要的安全措施。



### 2、==（lm课后题2）==假如你现在要攻陷一个**Windows server + IIS + ASP**的网站，请描述一下你的初步想法、攻击步骤和策略

**书p180攻击实例的general的表述，具体没设计**

**tips**：**!!!注意!!! 个人感觉二三只要提到使用代理跳板做扫描+端口扫描+操作系统版本扫描+操作系统漏洞POC验证+应用程序(IIS/CGI)漏洞POC测试+脚本注入漏洞测试(我记得ASP和PERL都有类似漏洞)**

---

**（from ChatGPT)** 感觉没答到点上

**攻击者的初步想法：**

攻击者可能试图通过利用Windows Server、IIS和ASP的潜在漏洞或弱点，获取对网站的非授权访问权限，并执行恶意操作，如篡改网页内容、窃取敏感信息等。

**攻击步骤：**

1. 信息收集：攻击者可能会收集目标网站的关键信息，如IP地址、域名、服务器架构、操作系统和应用程序版本等。

2. 漏洞探测：攻击者可能会使用自动化工具或手动方法对目标网站进行漏洞扫描，以发现潜在的弱点和漏洞，如未修补的安全漏洞、配置错误等。

3. 渗透测试：在发现漏洞后，攻击者可能会尝试利用已知的攻击技术，如SQL注入、跨站脚本（XSS）、文件上传漏洞等，以获取对服务器和网站的控制权限。

4. 提权和横向移动：一旦攻击者成功获取对服务器的访问权限，他们可能会寻找其他系统或资源，尝试提升权限并横向移动，以获取更高级别的访问权限。

5. 后门和持久性：攻击者可能会在服务器上部署后门程序或恶意脚本，以确保他们可以在以后访问系统，即使某些漏洞被修补或访问权限发生变化。

**攻击策略：**

1. 利用已知漏洞：攻击者可能会专注于已公开披露的漏洞，并尝试利用这些漏洞来入侵目标系统。因此，防御者应及时应用安全补丁和更新，以修补已知漏洞。

2. 社交工程：攻击者可能使用欺骗和社交工程技术，试图通过诱骗用户或系统管理员来获取敏感信息或特权访问。

3. 弱密码攻击：攻击者可能会使用弱密码破解工具或字典攻击来尝试猜解用户密码，因此防御者应强化密码策略，并推行多因素身份验证。

4. 防火墙和入侵检测系统（IDS）绕过：攻击者可能会试图通过利用协议漏洞或绕过网络防御系统来规避安全措施。因此，防御者应配置和监视防火墙和IDS，确保其有效运行。

5. 安全审计和日志监控：防御者应该实施日志记录和监控措施，以便及时检测异常活动和入侵尝试。

请注意，这些是攻击者可能采取的一般策略和步骤，并且攻击方法不断演变和改进。对于防御者来说，持续更新和加强安全措施、保持警惕，并遵循最佳实践是至关重要的。



**为了防御这些攻击，网站管理员可以采取以下措施：**

- 及时更新系统和软件补丁，以修复已知漏洞。
- 使用强密码，并定期更改密码。
- 限制管理员账户的权限，并对敏感操作进行审计。
- 员工培训，提高员工对社会工程学攻击和钓鱼攻击的警惕性。
- 安装反病毒软件和防火墙等安全软件，以检测和阻止恶意软件的传播。



### 3、==（lm课后题3）==假如你现在要攻陷一个**UNIX + CGI + Perl**的网站，请描述一下你的初步想法、攻击步骤和策略

**书p186攻击实例(不过没啥参考价值)，具体没设计**

**tips**：**!!!注意!!! 个人感觉二三只要提到使用代理跳板做扫描+端口扫描+操作系统版本扫描+操作系统漏洞POC验证+应用程序(IIS/CGI)漏洞POC测试+脚本注入漏洞测试(我记得ASP和PERL都有类似漏洞)**

---

**（from ChatGPT)** 感觉没答到点上

攻击者的**初步想法**： 攻击者可能试图通过利用UNIX操作系统、CGI和Perl等组件的潜在漏洞或弱点，获取对目标网站的非授权访问权限，并执行恶意操作，如篡改网页内容、窃取敏感信息等。

**攻击步骤：**

1. 信息收集：攻击者可能会收集目标网站的关键信息，如IP地址、域名、服务器架构、操作系统和应用程序版本等。
2. 漏洞探测：攻击者可能会使用自动化工具或手动方法对目标网站进行漏洞扫描，以发现潜在的弱点和漏洞，如未修补的安全漏洞、配置错误等。
3. 渗透测试：在发现漏洞后，攻击者可能会尝试利用已知的攻击技术，如代码注入、路径遍历、命令注入等，以获取对服务器和网站的控制权限。
4. 提权和横向移动：一旦攻击者成功获取对服务器的访问权限，他们可能会寻找其他系统或资源，尝试提升权限并横向移动，以获取更高级别的访问权限。
5. 后门和持久性：攻击者可能会在服务器上部署后门程序或恶意脚本，以确保他们可以在以后访问系统，即使某些漏洞被修补或访问权限发生变化。

**攻击策略**： 攻击者的具体策略将根据目标网站的特点和攻击者的技能水平而定。一些可能的攻击策略包括：

1. 利用已知漏洞：攻击者可能利用已公开披露的漏洞来针对UNIX操作系统、CGI和Perl等组件，以获取对系统的访问权限。
2. 脚本注入和代码执行：攻击者可能会试图通过在CGI脚本中注入恶意代码或执行恶意Perl脚本来绕过安全控制和执行不受信任的操作。
3. 社交工程：攻击者可能利用欺骗、诱导等手段，通过发送钓鱼邮件、伪装成可信来源等方式，诱使受害者提供敏感信息，如用户名、密码等。
4. 恶意脚本注入：攻击者可能尝试向目标网站的输入字段或参数中注入恶意脚本，以执行恶意操作，如篡改网页内容、窃取用户信息等。
5. 访问控制攻击：攻击者可能尝试绕过或破解目标网站的访问控制机制，如弱密码猜测、暴力破解等方式，获取管理员或特权用户的访问权限。
6. 缓冲区溢出攻击：攻击者可能利用缓冲区溢出漏洞，向目标系统输入超出预期长度的数据，覆盖关键内存区域，以执行恶意代码或控制系统行为。
7. 会话劫持：攻击者可能通过窃取或伪造会话标识符，获取合法用户的身份并冒充其身份，以获取对目标系统的控制权限。

**防御者的防御策略：**

1. 安全补丁和更新：防御者应及时应用UNIX操作系统、CGI和Perl等相关软件的安全补丁和更新，以修补已知的漏洞和弱点。
2. 安全配置和授权：确保服务器和应用程序的安全配置，限制访问权限，并为每个用户分配最小权限原则，以减少攻击者的潜在影响。
3. 输入验证和过滤：实施严格的输入验证和过滤机制，确保用户输入的数据不包含恶意代码，以防止代码注入和其他攻击。
4. 安全审计和日志监控：建立全面的安全审计机制，监控系统日志和网络流量，及时检测异常活动和入侵行为。
5. 应用层防火墙和入侵检测系统：部署应用层防火墙和入侵检测系统，对入站和出站的网络流量进行监控和筛选，阻止恶意活动和攻击尝试。
6. 安全意识培训：提高组织内部人员对UNIX、CGI和Perl等技术的安全意识，教育他们如何遵循最佳实践和安全原则，以减少潜在的安全漏洞。



### 4、**跳板**的作用是什么

跳板的作用是进行攻击源的隐藏。为了更好地隐蔽自己，一些网络攻击者通常并不直接从自己的系统向目标发动攻击，而是先攻破若干中间系统,让它们成为“跳板”，再通过这些“跳板系统”完成攻击行动。



### 5、如何避免**多个服务系统之间的连带关系**？

**（from ChatGPT）**

避免多个服务系统之间的连带关系是一项重要的系统设计和架构任务。下面是一些方法和技巧，可帮助减少服务系统之间的连带关系：

1. 松耦合（Loose Coupling）：确保系统中的服务组件之间松散耦合，即减少它们之间的依赖性。使用适当的接口和协议来定义服务之间的通信，并避免直接依赖于具体的实现细节。

2. 服务抽象化（Service Abstraction）：在设计服务系统时，通过使用抽象层和接口来隐藏底层服务的具体实现细节。这样可以减少服务之间的直接依赖，并使系统更具灵活性和可替换性。

3. 服务发现与注册（Service Discovery and Registration）：使用服务发现和注册机制，例如使用服务注册表、服务目录或中心化的服务发现工具，以便服务能够自动发现和识别其他服务的位置和功能。

4. 异步通信（Asynchronous Communication）：使用异步消息传递或事件驱动架构，以减少对其他服务的同步调用和直接依赖。通过异步通信，可以在系统中解耦服务之间的时间和空间依赖关系。

5. 服务网关（Service Gateway）：引入服务网关作为服务系统的入口，它可以负责路由和转发请求到不同的服务。服务网关可以隐藏底层服务的细节，并提供一致的接口给外部系统，从而减少系统之间的直接联系。

6. 事件驱动架构（Event-Driven Architecture）：采用事件驱动架构，将系统的不同组件之间的通信和交互建立在事件的基础上。通过发布-订阅模式，组件之间的关系变得更加松散，并可以减少直接的耦合。

7. 微服务架构（Microservices Architecture）：采用微服务架构将系统拆分为多个独立的、自治的服务。每个微服务负责特定的业务功能，并通过API进行通信。这样可以将系统的复杂性分解为较小的、可管理的部分，并减少不同服务之间的直接连带关系。

需要注意的是，减少服务系统之间的连带关系是一个复杂的设计任务，需要综合考虑系统的需求、可扩展性和可维护性。在设计和实施系统时，需要权衡各种因素，并选择合适的架构和技术来实现所需的解耦和自治性。

# 第九章 访问控制技术

### 1、（21-22论述2）简述**访问控制技术**的含义、目的、要素与分类。

**（from Monica）**

访问控制技术是一种计算机安全技术，用于控制系统中用户或进程对资源的访问。其目的是确保只有授权用户或进程能够访问资源，从而保护系统的机密性、完整性和可用性。

访问控制技术的要素包括：

- 身份验证（用户身份的识别和认证）：验证用户或进程的身份，以确定其是否有权访问资源。
- 授权（访问的控制）：确定用户或进程能够访问的资源和操作。
- 审计：记录用户或进程对资源的访问和操作，以便后续审计和调查。

访问控制技术可以根据实现方式和授权方式进行分类。按照实现方式可分为基于角色的访问控制、基于属性的访问控制、基于策略的访问控制等；按照授权方式可分为强制访问控制、自主访问控制。

---

**详细版：**

- 基于角色的访问控制（Role-Based Access Control，RBAC）：将用户分配到不同的角色，每个角色有不同的权限，用户的访问权限由其所属的角色决定。RBAC 可以简化权限管理，提高系统安全性和可管理性。
- 基于属性的访问控制（Attribute-Based Access Control，ABAC）：根据用户或资源的属性来控制访问权限。例如，可以根据用户的职位、地理位置、时间等属性来控制其对资源的访问权限。ABAC 可以实现更细粒度的访问控制。
- 基于策略的访问控制（Policy-Based Access Control，PBAC）：将访问控制策略定义为策略语言，根据策略来控制访问权限。PBAC 可以灵活地定义和管理访问控制策略。

- 强制访问控制（Mandatory Access Control，MAC）：基于系统管理员定义的安全策略，对用户和资源进行标记和分类，根据标记和分类来控制访问权限。MAC 可以实现更高级别的安全保护，但需要管理员对系统进行更严格的配置和管理。
- 自主访问控制（Discretionary Access Control，DAC）：由资源的所有者或管理员决定谁能够访问资源。DAC 可以实现更灵活的访问控制，但也容易出现安全漏洞。

### 2、**访问控制**包含哪些内容？举例

**书P207**

* 用户身份的识别和认证
* 对访问的控制
* 审计跟踪

---

**（lm PPT p13）**

1. 用户身份的识别和认证

   > 举例：用户登录电子邮件账户时，输入正确的用户名和密码进行身份验证，以验证用户身份的合法性。

2. 对访问的控制

   - 授权 、确定访问权限 、实施访问权限
   - 附加控制：除了对直接的访问进行控制外，还应对信息的流动和推理攻击施加控制

   > 举例：在一个文件共享系统中，管理员可以设置对某个文件夹的读取权限，仅允许特定用户组的成员进行访问，其他人则被禁止访问。

3. 审计跟踪：对用户使用何种系统资源、使用的时间、执行的操作等问题进行完整的记录，以备非法事件发生后能进行有效的追查

   > 举例：在一个电子商务网站中，通过审计日志可以记录用户的登录时间、浏览历史和交易记录，以便进行安全分析和追踪异常行为。

### 3、**身份认证**包含哪些信息？这些认证信息主要用于什么方面？

> 书P208、lm PPT p67

* 用户所知道的：密码
* 用户所拥有的：智能卡
* 用户本身的特征：生物学上的属性
* 特定地点或时间
* 通过信任的第三方：kerberos，IKE



### 4、==（lm课后题1）==简述**口令认证技术**的认证方法。用哪些方法可以提高口令认证技术的安全性？

> 书P209-212

- 认证方法：通行字、通行短语、询问法

  > lm PPT p74 口令认证的一般过程
  >
  > 1. 用户名的识别与验证：确定是否存在该用户的信息
  >
  > 2. 用户口令的识别与验证：确定用户输入的口令是否正确
  > 3. 用户帐号的缺省限制检查：确定该用户帐号是否可用，以及能够进行哪些操作、访问哪些资源等用户的权限

- 提高安全性方法(书P210)
  - 采用随时间变化的通行字
  - 将通行字划分成两部分，每部分仅包含半个通行字，分两次发给用户，减少暴露危险
  - 附上业务流水号和时间戳防止重放攻击
  - 加密存放通行字
  - 以可以拼读的字节为基础构造通行字
  - 采用通行短语
  - 在通行字后填充随机数
  - 采用询问法

---

**（from ChatGPT）**

为提高口令认证技术的安全性，可以采用以下方法：

1. 强密码策略：要求用户创建复杂、长而随机的口令，包括大小写字母、数字和特殊字符的组合。这样的口令更难猜测和破解。
2. 口令加盐和散列算法：使用随机的盐值结合强大的散列算法，如SHA-256或更高强度的散列函数。这样可以增加破解口令的难度。
3. 多因素认证：结合口令认证与其他因素，如硬件令牌、指纹或面部识别等。多因素认证提供额外的安全层，使攻击者更难以冒充用户身份。
4. 帐号锁定和登录限制：实施帐号锁定机制，在一定的尝试次数失败后锁定用户帐号，以防止暴力破解。此外，限制登录尝试的次数和频率也可以提高安全性。
5. 定期更换口令：要求用户定期更换口令，避免长期使用同一口令，减少口令泄露的风险。
6. 口令加固和教育：提供用户培训，教育用户使用强密码、不在多个系统中重复使用口令，并警示用户不要将口令共享或泄露给他人。

### 5、==（lm课后题2）==**网络的物理隔离技术**包含哪几方面？他们各自采用了什么技术？

> 书P212-214

* 客户端的物理隔离：网络安全隔离卡
* 集线器级的物理隔离：物理隔离网闸
* 服务器端的物理隔离

---

**（from ChatGPT）** 

在网络中，客户端的物理隔离、集线器级的物理隔离和服务器端的物理隔离可以采用不同的技术来实现。以下是一些常见的技术：

1. 客户端的物理隔离：
   - 网络安全隔离卡：隔离客户端计算机与外部网络的物理连接
   - 网络隔离墙：通过设置物理墙壁或屏蔽隔离材料来分隔不同的客户端设备，确保彼此之间的物理隔离。
   - 独立网络接口：为每个客户端设备提供独立的物理网络接口，使用专用线缆将其连接到网络设备，确保物理隔离。
   
2. 集线器级的物理隔离：
   - 物理隔离网闸：防止未经授权的访问和网络攻击跨越不同区域。
   
3. 服务器端的物理隔离：
   - 服务器机架：使用独立的服务器机架将服务器隔离开来，防止物理接触和干扰。
   - 虚拟化技术：使用虚拟化平台将物理服务器划分为多个虚拟机，每个虚拟机具有独立的运行环境，实现服务器间的物理隔离。
   - 独立网络接口和物理隔离：为每个服务器提供独立的网络接口，并使用物理隔离技术（如VLAN、防火墙等）将服务器隔离开来，确保彼此之间的物理隔离。

需要根据具体的网络架构和安全需求来选择适当的物理隔离技术，并结合网络设备、隔离墙、虚拟化平台和网络接口等技术来实现物理隔离。

### 6、什么叫**自主访问控制**？方法有哪些？有哪几种类型？

- 定义(书P218)：由客体自主地来确定各个主体对它的直接访问权限（又称访问模式）
- 方法(书P219)：
- 基于行的DAC ：权力表（Capabilities List）、前缀表（Profiles）、口令（Password）

  基于列的DAC ：保护位（Protection Bits）、访问控制表（Access Control List，ACL）
- 类型(书P220、lmPPT p38)：层次型的、属主型的、自由型

### 7、为什么**自主访问控制**无法抵御**特洛伊木马攻击**？请举例说明？

> 书P221

### 8、什么是**强制访问控制方式**？如何防止特洛伊木马的非法访问？

- 定义(书P221、lm PPT p42)：用户与文件都有一个固定的安全属性，系统利用安全属性来决定一个用户是否可以访问某个文件.
- 如何防止
  - 木马攻击条件(书P222)
  - 如何防止(书P222)

### 9、简述**BLP模型**的安全策略，并举例说明

> 书P222、lm PPT p52

- 规则(书P224)
  - 简单安全规则：仅当主体的敏感级不低于客体敏感级且主体的类别集合包含客体时，才允许该主体读该客体。即主体只能读密级等于或低于它的客体，也就是说主体只能从**下读**，而不能从上读
  - 星规则：仅当主体的敏感级不高于客体敏感级且客体的类别集合包含主体的类别集合时，才允许该主体写该客体。即主体只能写密级等于或高于它的客体，也就是说主体只能向**上写**，而不能向下写

  例子：

  假设有三个主体：Alice、Bob和Charlie，以及三个对象：文件A、文件B和文件C。它们都有相应的安全级别：Alice和Bob的安全级别为"机密"，Charlie的安全级别为"秘密"。文件A的安全级别为"机密"，文件B的安全级别为"秘密"，文件C的安全级别为"公开"。

  根据BLP模型的规则，Alice和Bob可以读取文件A、B、C，可以写入A；Charlie可以读取文件B、C，可以写入文件A、B。

### 10、**BLP模型的不足**

书P224

---

**（from ChatGPT）**

Bell-LaPadula（BLP）模型是一种经典的安全模型，但它也存在一些不足之处，包括以下几点：

1. 离散性限制：BLP模型是基于离散的安全级别和访问控制规则进行设计的，它仅考虑了信息的保密性而忽略了其他安全属性，如完整性和可用性。这使得BLP模型在处理现实世界中的复杂安全需求时存在局限性。

2. 灵活性不足：BLP模型的访问控制规则是基于固定的安全级别和访问权限的，缺乏灵活性和可调节性。它无法适应动态变化的安全需求和灵活的授权管理。

3. 静态访问控制：BLP模型基于主体和对象的静态安全级别进行访问控制决策，无法考虑到主体和对象的上下文信息以及动态的访问控制条件。这限制了BLP模型在处理动态环境和复杂访问控制场景时的适用性。

4. 信息泄漏隐患：尽管BLP模型可以防止信息的非授权泄漏，但它无法提供对故意信息泄漏的保护。由于BLP模型主要关注保密性，而不是防止主体故意泄露敏感信息，因此在面对内部威胁和恶意行为时可能存在一定的风险。

5. 多级安全需求难以满足：BLP模型主要适用于单一安全级别的系统，难以应对多级安全需求，如需要在一个系统中同时处理多个安全级别或多个安全策略的情况。

尽管BLP模型存在这些不足，但它仍然被广泛应用于许多传统的安全领域，并为系统提供了一定的安全保护。在实际应用中，需要综合考虑BLP模型的优点和不足，结合其他安全模型和技术，以满足更复杂的安全需求。

### 11、简述**Biba模型**的安全策略，并举例说明

> 书P224、lm PPT p53

- 规则(书P224)
  -  简单完整规则：仅当主体的完整级大于等于客体的完整级且主体的类别集合包含客体的类别集时，才允许该主体写该客体。即主体只能向**下写**，而不能向上写，也就是说主体只能写（修改）完整性级别等于或低于它的客体
  - 完整性制约规则（星规则）：仅当主体的完整级不高于客体完整级且客体的类别集合包含主体的类别集合时，才允许该主体读读客体。即主体只能从**上读**，而不能从下读
  
  例子：
  
  假设有三个主体：Alice、Bob和Charlie，以及三个对象：文件A、文件B和文件C。它们都有相应的完整性级别：Alice和Bob的完整性级别为"高"，Charlie的完整性级别为"中"。文件A的完整性级别为"高"，文件B的完整性级别为"中"，文件C的完整性级别为"低"。
  
  根据BLP模型的规则，Alice和Bob可以写入文件A、B、C，可以读取A；Charlie可以写入文件B、C，可以读取文件A、B



### 12、DAC与MAC的区别以及如何**结合MAC和DAC**？

> 书P222

**区别：**

1. DAC（Discretionary Access Control，自主访问控制）
   ① DAC是传统的Linux的访问控制方式，DAC可以对文件、文件夹、共享资源等进行访问控制。
   ② 在DAC这种模型中，文件客体的所有者（或者管理员）负责管理访问控制。
   ③ DAC使用了ACL（Access Control List，访问控制列表）来给非管理者用户提供不同的权限，而root用户对文件系统有完全自由的控制权。
2. MAC（Mandatory Access Control，强制访问控制）
   ① SELinux在内核中使用MAC检查操作是否允许。
   ② 在MAC这种模型中，系统管理员管理负责访问控制，用户不能直接改变强制访问控制属性。
   ③ MAC可以定义所有的进程（称为主体）对系统的其他部分（文件、设备、socket、端口和其它进程等，称为客体）进行操作的权限或许可。
3. DAC和MAC的其它区别
   ① DAC的主体是真实有效的用户和组ID，MAC的主体是安全上下文，两者的UID是各自独立的。
   ② DAC的访问控制模式是rwxrwxrwx，MAC的访问控制模式是user:role:type。

---

DAC：由客体自主地来确定各个主体对它的直接访问权限（又称访问模式）。在自主访问控制下，用户可以按自己的意愿对系统的参数做适当的修改，以决定哪个用户可以访问他们的文件。

MAC：用户与文件都有一个固定的安全属性，系统利用安全属性来决定一个用户是否可以访问某个文件。安全属性是强制性的，它是由安全管理员或操作系统根据限定的规则分配的，用户或用户的程序不能修改安全属性。

---

**结合：**

DAC与MAC的结合是在DAC机制的基础上增加更强的访问控制以达到强制访问控制的目的。

主体必须首先通过DAC和MAC的控制检查后，得到允许后方能访问某个客体。客体受到了双重保护，DAC可以防范未经允许的用户对客体的攻击，而MAC不允许随意修改主体、客体的安全属性，提供了一个不可逾越的保护层，因而又可以防范任意用户随意滥用DAC机制转授访问权。

**`另一种回答：`**通常MAC与DAC结合使用，并实施一些附加的、更强的访问限制。一个主体只有通过自主与强制性访问限制检查后，才能访问其客体。用户可利用DAC来防范其他用户对自己客体的攻击，由于用户不能直接改变强制访问控制属性，所以强制访问控制提供了一个不可逾越的、更强的安全保护层，以防范偶然或故意地滥用DAC。

---

**（from ChatGPT）**

结合MAC（强制访问控制）和DAC（自主访问控制）可以形成一种综合的访问控制策略，以在系统中实现更全面的安全性。以下是一些结合MAC和DAC的常见方法和策略：

1. 多层次访问控制：使用MAC来实施系统的基本访问控制策略，强制限制对资源的访问。同时，使用DAC允许用户对自己所拥有的资源行使更大的自主权，例如在资源级别上授予其他用户访问权限。

2. 访问控制列表（ACL）：在资源级别使用DAC的访问控制列表来定义和管理个体用户对资源的访问权限。同时，使用MAC来确保访问控制列表本身受到保护，只有授权的用户可以修改和管理它们。

3. 角色基础的访问控制：结合MAC和DAC的一种方法是使用角色作为访问控制的中介。使用MAC来定义角色和角色之间的访问权限，并使用DAC允许管理员将用户分配给特定角色以获取相应的权限。这种方式可以提供更灵活和可扩展的访问控制策略。

4. 标签或分类：MAC通常使用标签或分类来标识和控制资源的访问。结合DAC时，可以使用用户定义的标签或分类来授予用户对特定资源的访问权限。这样，用户可以根据自己的需求对资源进行分类和标记，并使用DAC来管理对这些资源的访问控制。

5. 强化访问控制：结合MAC和DAC还可以通过强化访问控制策略来提高系统的安全性。例如，使用MAC来限制对敏感数据或关键资源的访问，并使用DAC要求用户进行授权或审批，以获取对这些资源的访问权限。

综合使用MAC和DAC可以根据具体的安全需求和系统要求提供更全面和灵活的访问控制机制。这种结合可以有效地平衡强制控制和用户自主权之间的关系，提高系统的安全性和可管理性。

### 13（20-21简答4）、简述**自主访问控制与强制访问控制的技术优缺点**，并举例两种技术的融合应用案例。

**lm PPT p42：**

- <img src="https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230612130256139.png" alt="image-20230612130256139" style="zoom:67%;" />

---

**（from ChatGPT）**

自主访问控制和强制访问控制是两种不同的访问控制机制，它们各自具有不同的技术优点和缺点。下面是对它们的简述以及两种技术融合应用案例的示例：

自主访问控制：
自主访问控制（DAC）是一种基于主体拥有者的权限授予和访问决策机制。在DAC中，主体（如用户）具有对资源的控制权，可以自由授予或撤销对资源的访问权限。

技术优点：

1. 灵活性：DAC允许主体自由授予和管理资源的访问权限，可以根据实际需求进行个性化的控制和调整。

2. 用户自主性：DAC赋予用户对资源的管理权，使其可以根据自身需求灵活地决定对资源的访问权限，提高用户的满意度和自主性。

技术缺点：

1. 安全性挑战：由于权限控制权在主体手中，DAC面临着安全性挑战。如果主体授予不当的权限或者主体本身受到威胁，可能导致未经授权的访问或信息泄露。

2. 管理复杂性：由于控制权分散在多个主体之间，DAC可能导致权限管理的复杂性增加，特别是在大规模和复杂的环境中。

强制访问控制：
强制访问控制（MAC）是一种基于预定义策略和规则的访问控制机制，由系统管理员在系统级别进行管理和控制。

技术优点：

1. 安全性：MAC提供了严格的安全模型，可以确保只有经过授权的实体才能访问受限资源，不受用户主观判断的影响。

2. 一致性：MAC保证了对资源的一致性访问控制，无论用户的行为如何，系统都会根据预定义的策略进行访问控制。

3. 隔离性：MAC可以实现资源之间的隔离，确保不同级别的资源只能被相应级别的实体所访问。这对于需要保护敏感信息或多层次安全的环境非常有用。

技术缺点：

1. 灵活性受限：MAC在灵活性方面受到限制，对于某些特定的场景和需求，可能需要频繁更改和调整访问控制策略，但这在MAC中可能较为复杂和困难。

2. 维护困难：MAC需要在整个系统中管理和维护安全策略，对系统管理员的要求较高。

3. 灵敏度问题：MAC的安全模型通常基于标签或类别，而不是个别用户的身份。这可能导致某些情况下的访问控制粒度较粗，无法细化到个别用户的需求。

4. 配置复杂性：MAC的实施和配置可能相对复杂，特别是在需要考虑多个因素和标签的复杂环境中。这可能需要对系统进行详细的分析和规划，以确保正确配置和有效运行。

融合应用案例：

一个融合自主访问控制和强制访问控制的案例是`多级安全系统`。多级安全系统通常包括多个安全级别，每个级别具有不同的安全策略和访问要求。在该系统中，强制访问控制（MAC）用于控制不同级别之间的资源访问，并确保资源的一致性访问控制。同时，自主访问控制（DAC）用于允许特定级别的主体自由管理其拥有的资源，并根据需要灵活调整权限。

另一个案例是`云计算环境中的资源管理`。在云环境中，强制访问控制可以应用于云平台的整体安全策略和资源隔离，确保不同用户之间的资源隔离和安全性。而自主访问控制可以用于允许用户在云平台上自主管理其拥有的资源，例如设置访问权限、共享资源等。

这些案例中的融合应用将自主访问控制和强制访问控制结合起来，既提供了严格的安全控制，又赋予用户一定的自主性和灵活性。这样可以在满足安全要求的同时，满足不同用户和环境的个性化需求。

### 14、==（lm课后题3）==什么是**基于角色的访问控制技术**？它与传统的访问控制技术有什么不同？

> 书P226顶部、lm PPT p59

* 是一种策略无关的访问控制技术

* 具有自管理能力

* 使安全管理更贴近应用领域的机构或组织情况


> 和DAC、MAC相比，优点在于：它是一种策略无关的访问控制技术，具有自管理的能力，使得安全管理更贴近应用领域的机构或组织的实际情况。缺点在于：技术不够成熟、较复杂、RBAC的策略无关性需要用户自己定义适合本领域的安全策略。（P228）

---

**（from ChatGPT)**

基于角色的访问控制（Role-Based Access Control，RBAC）是一种访问控制技术，它基于用户角色来管理对资源的访问权限。在RBAC中，用户被分配到不同的角色，而每个角色都具有一组预定义的权限。这样，用户的权限是由其所属的角色决定的，而不是直接与用户关联。

与传统的访问控制技术相比，RBAC具有以下不同之处：

1. 简化权限管理：RBAC通过将权限分配给角色，而不是直接分配给每个用户，简化了权限管理。管理员只需关注角色的权限，而无需为每个用户单独设置权限。

2. 灵活性和可扩展性：RBAC提供了灵活性和可扩展性，因为角色可以根据组织的需求进行创建和修改。当有新的用户加入系统或需要调整权限时，只需调整用户与角色之间的关联，而无需更改每个用户的权限设置。

3. 分离权限分配和用户管理：传统的访问控制技术往往将权限分配和用户管理紧密耦合在一起，导致权限管理变得复杂。而RBAC将用户管理和角色权限分配分离开来，使权限管理更为灵活和可控。

4. 提高安全性：由于权限是根据角色进行授权的，RBAC能够减少权限过度授予或错误授权的风险。只有具有相应角色的用户才能获得相关权限，从而降低了潜在的安全漏洞。

总体而言，RBAC提供了一种更为灵活、简化和可控的访问控制机制，使权限管理更加高效，并增强了系统的安全性。

### 15、==（lm课后题4）==简述**4种RBAC模型技术**。他们各自有什么特点？

> 书P226-P228

1. 基本模型RBAC0：RBAC0由四个基本要素构成，即用户、角色、会话、授权
2. 角色的层次结构RBAC1：RBAC1的特征是为RBAC0上引入了角色层次的概念
3. 约束模型RBAC2 ：RBAC2除了继承RBAC0的原有特征外，还引入了约 束（Constraints）的概念
4. 混合模型RBAC3 ：RBAC3是RBAC1和RBAC2两者的结合

---

**（from ChatGPT）**

1. RBAC0（基本模型）：
   - 特点：RBAC0是最基本的RBAC模型，包含用户、角色、会话和授权四个基本要素。用户通过被分配到不同的角色，而角色与权限相关联。用户通过角色间接获得相应的权限。RBAC0模型没有引入角色层次结构和约束。

2. RBAC1（角色的层次结构）：
   - 特点：RBAC1在RBAC0的基础上引入了角色的层次结构概念。角色层次结构允许角色之间建立父子关系，使得角色可以继承其父角色的权限。这种模型使得权限管理更加灵活，可以通过分配适当的角色来简化权限的分配和管理。

3. RBAC2（约束模型）：
   - 特点：RBAC2扩展了RBAC0模型，引入了约束的概念。约束指定了角色、用户或会话在特定条件下访问资源的限制。约束可以是静态的（如时间限制）或动态的（如访问频率限制），可以根据具体的安全策略进行定义和配置。这种模型提供了更细粒度的访问控制和额外的安全控制。

4. RBAC3（混合模型）：
   - 特点：RBAC3是RBAC1和RBAC2两者的结合，综合了角色的层次结构和约束模型的特点。它允许角色之间建立层次关系，并且引入了约束的概念来控制访问权限。这种模型提供了更灵活和精细的访问控制策略，同时简化了权限管理和授权过程。

这四种RBAC模型技术在角色与权限的组织方式、权限的继承关系以及对访问的限制条件方面有所不同。根据具体的需求和系统的安全要求，选择适合的RBAC模型可以提供更好的访问控制和权限管理机制。

### 16、如何**确保身份认证数据的真实性**？

身份认证过程指的是当用户试图访问资源的时候，系统确定用户的身份是否真实的过程。

身份认证的依据

1. 用户所知道的：密码
2. 用户所拥有的：智能卡
3. 用户的特征：生物学上的属性
4. 根据特定地点（或特定时间）
5. 通过信任的第三方：Kerberos , IKE

---

- 如何理解真实性

  > **消息来自于发送方，且中途没有被篡改**(例如本来A支付B 10元钱中途被C改成A支付B 100元破坏了真实性)

- 方式

  - 消息认证码

    ![image-20210620231335326](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20210620231335326.png)

  - 数字签名

    ![image-20210620231351472](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20210620231351472.png)



### 17、**网络安全隔离卡如何交换数据**？

> 书P215。为了保证安全，两个分区不能...从而保证安全区的数据安全。

### 18、**网卡、网络隔离卡的区别**

> 书P215。

网卡 链路层 类似一个系统 通过不同的网卡 连接不同网段 上内外网

隔离卡 物理层 每次换内外网 需要重启系统 类似双系统

---

网路隔离卡见课本

网卡是工作在链路层的网络组件，是局域网中连接计算机和传输介质的接口，不仅能实现与局域网传输介质之间的物理连接和电信号匹配，还涉及帧的发送与接收、帧的封装与拆封、介质访问控制、数据的编码与解码以及数据缓存的功能等。

专网专用，连系统也必须各是各的，内网是内网系统、外网是外网系统，不能一个系统可以同时连接两个网络（双网卡既是一个系统可以同时连接两个网络）.

---

**（from ChatGPT）**

区别如下：

1. 功能：网卡是用于实现计算机与网络之间的数据通信，负责发送和接收数据。而隔离卡则专注于网络的物理隔离和安全防护，通过隔离网络连接来保护计算机免受潜在的网络威胁。
2. 安全性：网卡在功能上并没有直接的安全性保护，它主要负责数据的传输。而隔离卡则具备特定的安全防护功能，可以提供物理隔离、访问控制、流量监测等安全措施，以保护计算机免受恶意攻击和数据泄露等威胁。
3. 部署方式：网卡通常是计算机系统的一部分，与其他硬件设备（如处理器、内存等）集成在同一主板上。而隔离卡则是一个独立的硬件设备，需要插入到计算机主板上的插槽中进行部署。

### 19、**物理隔离网闸与防火墙的区别**

书p216

网闸与防火墙的区别是：1、防火墙首先保证网络连通性，然后考虑安全问题，网闸在保证安全的基础上进行数据交换；2、防火墙是单主机架构，网闸是双主机架构；3、网闸相对于防火墙同步类功能安全性更高。

1、应用场景区别

防火墙：防火墙首先要保证网络的连通性，其次才是安全问题；

网闸：网闸是保证安全的基础上进行数据交换。网闸是两个网络已经存在，现在两个网络不得不互联，互联就要保证安全，网闸是现在唯一最安全的网络边界安全隔离的产品，只有网闸这种产品才能解决这个问题，所以必须用网闸。

2、硬件区别

防火墙是单主机架构，早期使用包过滤的技术，网闸是双主机2+1架构，通过私有的协议摆渡的方式进行数据交换，基于会话的检测机制，由于网闸是双主机结构，即使外网端被攻破，由于内部使用私有协议互通，没办法攻击到内网，防火墙是单主机结构，如果被攻击了，就会导致内网完全暴露给别人。

3、功能区别

网闸主要包含两大类功能，访问类功能和同步类功能，访问类功能类似于防火墙，网闸相对于防火墙安全性更高的是同步类功能。

![img](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/wps1.png)

### 20、**设置客户端物理隔离过渡区**

双硬盘：一个对应一个网络

单硬盘：单个硬盘上磁道的读写控制技术，在一个硬盘上分隔出两个工作区间 网络安全隔离卡(物理方式PC物理层) 在任何时候，数据只能通往一个分区。

数据交换/过渡区：在两个分区以外，在硬盘上另外设置一个功能区，用于不同的状态转换，表现为硬盘的D盘，各个分区可以通过功能区作为一个过渡区来交换数据。

### 21、（18-19论述3）请给出利用物理隔离网卡和隔离集线器组建双网和三网物理隔离系统的四种方案（请画图解答）。

![image-20230612120638319](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230612120638319.png)



# 第十章 防火墙技术

### 课后习题

### 1、（21-22简答2）简述**防火墙**的基本概念和特点。

**（lm PPT p17、18）**

在网络中防火墙主要用于逻辑隔离外部网络与受保护的内部网络。

防火墙技术属于典型的静态安全技术，该类技术用于逻辑隔离内部网络与外部网络。

通过数据包过滤与应用层代理等方法实现内外网络之间信息的受控传递，从而达到保护内部网络的目的。

---

**（from Monica）**

防火墙是一种网络安全设备，用于控制网络流量，保护网络免受未经授权的访问和攻击。其基本概念和特点如下：

1. 基本概念：防火墙是一种网络安全设备，通常位于网络边缘，监控进出网络的流量。它可以根据预先设定的规则，对流量进行过滤和控制，防止未经授权的访问和攻击。

2. 特点：

- 访问控制：防火墙可以根据预设规则，控制进出网络的流量，只允许符合规则的流量通过。
- 安全性：防火墙可以对网络流量进行深度检测和过滤，有效防止网络攻击和恶意软件的传播。
- 灵活性：防火墙的规则可以根据实际情况进行定制和修改，以适应不同的网络环境和需求。
- 可扩展性：防火墙可以与其他安全设备配合使用，提高网络安全性能。
- 可管理性：防火墙可以通过中心化管理系统进行集中管理和监控，方便管理人员进行维护和操作。

---

**（from ChatGPT）**

防火墙是一种网络安全设备或软件，用于监控和控制网络流量，实施安全策略，以保护网络免受未经授权的访问、恶意活动和网络攻击的影响。以下是防火墙的基本概念和特点：

基本概念：

1. 网络边界保护：防火墙位于网络的边界，通常在内部网络与外部网络（如互联网）之间。它监控进出网络的流量，并根据预定义的规则和策略来允许或阻止特定的数据包。

2. 包过滤和状态检测：防火墙使用包过滤技术来检查传入和传出的数据包，并根据预定的规则和策略决定是否允许通过。状态检测则是基于网络连接的状态进行检查，以确定是否允许特定的数据流通过。

3. 网络地址转换（NAT）：防火墙可以使用网络地址转换技术将内部网络的私有IP地址转换为公共IP地址，以提供一定程度的隐私和安全性。

4. 安全策略和规则：防火墙根据预先定义的安全策略和规则来控制网络流量。这些策略和规则可以指定特定的源和目标地址、端口号、协议类型等，以确定是否允许或阻止数据流量。

特点：

1. 访问控制：防火墙通过访问控制策略来限制网络流量，仅允许授权的流量通过。它可以根据源和目标地址、端口号、协议类型等对流量进行过滤和限制。

2. 网络隔离：防火墙帮助隔离内部网络和外部网络，确保外部网络中的恶意流量无法直接进入内部网络。它提供了一道屏障，防止潜在的攻击者直接访问内部系统。

3. 审计和日志记录：防火墙通常具有审计和日志记录功能，可以记录网络流量和安全事件。这有助于检测潜在的威胁和入侵，并为安全团队提供有关网络活动的详细信息。

4. 虚拟专用网络（VPN）支持：一些防火墙提供对VPN的支持，允许安全地建立远程连接和加密通信，以提供远程访问和分支机构之间的安全连接。

总结：防火墙是网络安全的重要组成部分，它通过访问控制、网络隔离、审计和日志记录等特点来保护网络免受未经授权的访问和网络攻击的威胁。它在网络边界处充当保护屏障，并根据预先定义的安全策略来控制流量。防火墙的配置和管理应根据特定组织的安全需求进行定制，并定期进行更新和审查，以保持网络的安全性。

### 2、经典安全模型中的**参考监视器**的基本功能是？

> 书P231

* 参考功能
* 控制对授权数据库改变的授权功能

### 3、==（lm课后题1）==**防火墙规则**的处理过程中，“REJECT”和“DROP“的区别是什么？

> 书P231底部

- Reject：拒绝数据包或信息通过，并且通知信息源该信息被禁止
- Drop：直接将数据包或信息丢弃，并且不通知信息源

### 4、防火墙产品的**两条基本原则**是？

> 书P232

- 默认允许和默认拒绝

### 5、代理的执行流程

1.代理服务器监听内联网络中主机的请求，当请求到达代理服务器后，代理服务器根据安全策略对数据包的首部和数据部分信息进行检查，检查之后将内联网络中的主机源地址改为自己的地址之后将这个数据包发给外部的目的主机，这样外部的主机接到的信息是来自于代理服务器而不是源主机。目的主机应答的数据包也将发送到代理服务器，经过代理服务器检查允许通过后，代理服务器将数据包的目的地址改为内联主机的地址，之后发往目的主机。类似于在内联网络和外联网络之间设置一个中转，外联网络并不清楚内联网络的拓补结构。

2.内部的主机只接受代理服务器的信息而不接收任何外部地址主机发来的信息，外部主机只能讲信息发往代理服务器，之后由代理服务器将信息转发给内联网路中的主机。代理服务器负责监控整个通信过程来保证通信过程的安全性。



### 6、"IP源地址 = 192.168.1.1 and IP目的地址 = 192.168.2.1 and 协议 = TCP and 源端口 > 1024 and 目的端口 = 80 and" 表示什么样的数据包？

- 访问WWW服务的数据包

### 7、**数据包过滤规则**向内向外之分？

> 书P256

![image-20230611235859753](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230611235859753.png)

### 8、==（lm课后题2）==使用应用层代理访问外部Web站点时，会出现访问某些经典
网站的响应速度较快，而其他站点响应速度较慢，原因何在？

> 书P236最下面

- cache机制

---

因为代理有缓存功能。会把常用的网站页面缓存下来,所以速度快。不常用的网页要远程读取,所以慢些。

### 9、==（lm课后题3==、20-21论述1）如果防火墙**允许周边网络上的主机访问内部网络上的任何基于TCP协议的服务**，而**禁止外部网络访问周边网络上的任何基于TCP协议的服务**，给出实现的具体思路

> 参考书P242和P262

- 采用被屏蔽子网体系结构
- 路由器配置如下

| 序号 | 路由器 | 接口 | 方向 | 源地址          | 目的地址        | 协议 | 源端口 | 目的端口 | 动作   |
| ---- | ------ | ---- | ---- | --------------- | --------------- | ---- | ------ | -------- | ------ |
| 1    | 外部   | 外网 | 向内 | 0.0.0.0/0.0.0.0 | 周边网段        | TCP  | ANY    | ANY      | REJECT |
| 2    | 外部   | 内网 | 向内 | 周边网段        | 0.0.0.0/0.0.0.0 | TCP  | ANY    | ANY      | REJECT |
| 3    | 内部   | 外网 | 向内 | 周边网段        | 内部网段        | TCP  | ANY    | ANY      | ACCEPT |
| 4    | 内部   | 外网 | 向内 | 内部网段        | 周边网段        | TCP  | ANY    | ANY      | ACCEPT |



### 10、**防火墙的体系结构**

> 书P239-250、lm PPT p48

（经典）双重宿主主机体系结构、被屏蔽主机体系结构、被屏蔽子网体系结构

（扩展）合并内部和外部路由器、合并堡垒主机和外部路由器、多台内/外部路由器、多个周边网络

### 11、**构建防火墙步骤**



> 书P250-262、lm PPT p59

1. 选择防火墙体系结构
2. 安装外部路由器
3. 安装内部路由器
4. 安装堡垒主机
5. 设置数据包过滤规则
6. 设置代理系统
7. 检查防火墙运行效果

### 12、**防火墙性能衡量**

1. 吞吐量。作为衡量防火墙性能的重要指标之一，吞吐量小会造成网络的瓶颈，从而影响整个网络的性能。性能测试仪测定的是被测设备在不丢包的情况下，正常转发的最大吞吐量。一般选端口的理论最大值(如100%),通过二分算法得出最终不丢包的情况下的最大吞吐
2. 延迟。延迟能力将体现防火墙的数据处理速度。一般延迟是通过按一个固定的持续时间发送帧，每一秒会有一个打了时间戳T1的帧被传输出去，当测试仪收到这个帧时，将完成传输时的时间与帧携带的时间戳T2的比较，从而计算出延时值为T2-T1。考虑时钟同步问题，
3. 丢包率。丢包率对防火墙的稳定性、可靠性有很大影响。一般测试时按初始速率开始发送帧，记录收到的帧数量，如果被测设备不能完全转发，会降低一点速率再次发送，测试会一直持续到防火墙可完全转发为止，最后的结果会显示出各种帧长度的帧丢失情况。丢包率测试是通过发送端向防火墙发送一定数量的测试帧，帧数计为A;接收端在收到数据包后对其进行统计，得出成功转发的数据帧个数为B;则可得丢包率为B/A×100%。
4. 背靠背。该指标能体现出被测防火墙的缓冲能力。通过向被测设备连续发送具有最小帧间隔的N个帧，并统计被测设备转发帧的个数。如果发送帧的个数和转发帧的个数相等，则增加N值，再重复上述测试过程。
5. 最大并发连接数。主要用来测试被测防火墙建立和维持TCP连接的性能。利用性能测试仪测试最大并发连接数时，在服务器上设定一定大小的时延，使服务器和客户端一直保持联接状态，然后使客户端和服务器快速建立大量联接，直到设备达到最大承受的连接数。
6. 最大新建连接速率。主要用来衡量单位时间内防火墙建立和维持TCP连接的能力。利用性能测试仪测试每秒新建联接时，客户端向服务器发起建立联接并请求一个设定好的网页，收到请求的网页立即关闭联接，不断提高建立联接的速率，直到设备中有联接没有成功建立为止。



# 第十一章 入侵检测技术

### 1、（21-22简答3）简述**入侵检测**的基本概念和特点。

入侵检测是一种动态的网络安全技术。

- 利用各种不同类型的引擎，实时地或定期地对网络中相关的数据源进行分析，依照引擎对特殊的数据或事件的认识，将其中具有威胁性的部分提取出来，并触发响应机制。
- 入侵检测的动态性反映在入侵检测的实时性、对网络环境的变化具有一定程度上的自适应性，这是以往静态安全技术无法具有的。

---

**(from Monica)**

入侵检测是一种网络安全技术，用于监测网络中的异常行为，并及时发现和响应潜在的安全威胁。其基本概念和特点如下：

1. 基本概念：入侵检测是一种网络安全技术，通过监测网络中的流量和系统日志，分析网络活动，识别出异常行为，从而发现和响应潜在的安全威胁。

2. 特点：

- 实时监测：入侵检测系统可以实时监测网络中的流量和系统日志，及时发现异常行为。
- 自动化响应：入侵检测系统可以自动化响应安全威胁，例如禁止攻击源IP地址的访问、阻止攻击流量等。
- 多种检测方式：入侵检测系统可以采用多种检测方式，例如基于规则、基于统计、基于机器学习等，提高检测的准确性和效率。
- 适应性学习：入侵检测系统可以通过适应性学习，不断优化检测规则和算法，提高检测的准确性和效率。

---

**（from ChatGPT）**

入侵检测系统（Intrusion Detection System，简称IDS）是一种用于监测和识别网络或系统中潜在入侵行为的安全工具。以下是入侵检测的基本概念和特点：

基本概念：

1. 实时监测：入侵检测系统通过监测网络流量、系统日志和其他相关数据来实时检测潜在的入侵行为。它可以主动扫描、分析和解释网络活动，以寻找异常行为和已知的攻击模式。

2. 异常检测和签名检测：入侵检测系统使用两种主要方法进行检测。异常检测基于正常网络和系统行为的模式，通过检测与该模式不符的活动来识别潜在的入侵。签名检测则基于已知的攻击模式和特征进行匹配，以识别已知的入侵行为。

3. 警报和响应：当入侵检测系统检测到异常或已知的入侵行为时，它会生成警报通知管理员或相关安全团队。这些警报包含有关入侵事件的详细信息，以便采取适当的响应措施，如阻止攻击流量、隔离受影响的系统或启动进一步的调查和修复。

特点：

1. 监测多种攻击类型：入侵检测系统可以监测多种攻击类型，包括网络扫描、恶意软件、拒绝服务攻击、缓冲区溢出等。它具备对不同攻击模式和方法的识别能力，从而提供更全面的安全保护。

2. 实时性和持续性：入侵检测系统提供实时监测和持续性的安全检测，能够及时发现和响应入侵行为。它可以快速检测到攻击，并生成警报以促使及时的反应和干预。

3. 自学习和更新：入侵检测系统可以进行自学习，通过观察和分析网络和系统的正常行为，建立基准模型，从而更准确地检测异常行为。此外，它需要定期更新攻击特征库和规则，以识别新出现的攻击模式和变种。

4. 网络和主机级别的检测：入侵检测系统可以部署在网络级别或主机级别。网络级别的IDS监测整个网络流量，而主机级别的IDS则在每个主机上进行监测，提供更细粒度的入侵检测和保护。

5. 审计和日志记录：入侵检测系统记录和存储有关入侵事件、警报和相关活动的详细信息，以供后续审计和分析使用。这些日志记录对于追踪入侵行为、了解攻击方式和支持法律调查非常重要。

综上所述，入侵检测系统可以帮助组织及时发现和应对潜在的入侵行为，提高网络和系统的安全性，并提供审计和日志记录功能以支持进一步的分析和调查。

### 2、入侵检测系统的**入侵内容**主要是什么？

> 书P288上面、lm PPT p13

- 外部攻击检测
- 内部特权滥用检测

### 3、入侵检测系统**按引擎类别分**，可以划分为几种类型？这些引擎的实现方式是什么？

> 书P290

- 异常检测：以历史数据或期望值为基础，为各个主体、对象的行为定义变量与该变量的基值，利用加权函数组合变量，得出综合变量值，并在此基础上，将入侵定义为出现了任何与期望值相比较有不可接受的偏差。
- 模式匹配(误用检测)：利用已知的攻击方法，根据已定义好的入侵模式，通过判断这些入侵模式是否出现来进行检测

### 4、**商业IDS系统主要采用的技术**有哪些？这些技术的特点是什么？

> 书P292、lm PPT p77

1. 基于统计分析的入侵检测技术
2. 基于神经网络的入侵检测技术
3. 基于专家系统的入侵检测技术
4. 基于模型推理的入侵检测技术

### 5、**入侵检测系统和防火墙**的区别与联系

**区别**

1. 防火墙：防火墙是设置在被保护网络(本地网络)和外部网络(主要是Internet)之间的一道防御系统，以防止发生不可预测的、潜在的破坏性的侵入。它可以通过检测、限制、更改跨越防火墙的数据流，尽可能的对外部屏蔽内部的信息、结构和运行状态，以此来保护内部网络中的信息、资源等不受外部网络中非法用户的侵犯。
2. 入侵检测系统：IDS是对入侵行为的发觉，通过从计算机网络或计算机的关键点收集信息并进行分析，从中发现网络
   或系统中是否有违反安全策略的行为和被攻击的迹象。

防火墙只是被动防御为主，通过防火墙的数据便不再进行任何操作，IDS则进行主动实时的检测，发现入侵行为即可做出反应，是对防火墙弱点的修补，但可能误报等；防火墙可以允许内部的一些主机被外部访问，IDS则没有这些功能，只是监视和分析用户和系统活动。

**联系：**

1. IDS是继防火墙之后的又一道防线，防火墙是防御，IDS是主动检测，两者相结合有力的保证了内部系统的安全；
2. IDS实时检测可以及时发现一些防火墙没有发现的入侵行为，发行入侵行为的规律，这样防火墙就可以将这些规律加入规则之中，提高防火墙的防护力度。

### 6、**IDS评估标准**

![image-20230612104441839](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230612104441839.png)

1. 敏感性(Sensitivity):它反映了正确报告(TP)的比率，也就是IDS正确检测到的入侵次数在实际发生的总入侵次数中所占的比率。敏感性用数学公式表示成Sensitivity =TP/(TP+FN)。显然，漏报(FN)率=1-敏感性。

2. 特异性(Specificity):它反映了系统准确报告的程度。用数学公式表示成Specificity = TN/(TN+FP)。正确漏报(TN)表示IDS正确报告了没有入侵；误报(FP)则表示IDS错误地发出一次入侵警报(实际上并没有发生入侵),误报(FP)率=1-特异性。

3. 系统功能维：反映IDS的攻击检测、报告、审计、报警 等能力。
   系统性能维：主要是检验IDS 在不同环境下的承受强度，包括检测引擎的吞吐量、过滤的效率等指标
   系统可管理维：主要评估系统用户界面的可用性、完整性、扩充性以及平台的兼容性。

---

1. 准确性，指系统正确识别入侵行为的能力；
2. 可靠性，指系统的容错能力和可持续运行能力；
3. 可用性，指系统开销大小，对网络性能影响的大小；
4. 可测试，指系统能够通过模拟攻击进行检测测试；
5. 适应性，指系统易于开发和扩展；
6. 实时性，指系统能够及早发现入侵企图；
7. 安全性，指系统可确保自身的安全。

---

根据Porras等的研究，给出了评价IDS性能的三个因素：
1. 准确性：指IDS从各种行为中正确地识别入侵的能力，当一个IDS的检测不准确时，就有可能把系统中的合法活动当作入侵行为并标识为异常（虚警现象）。
2.处理性能：指一个IDS处理数据源数据的速度。显然，当IDS的处理性能较差时，它就不可能实现实时的IDS，并有可能成为整个系统的瓶颈，进而严重影响整个系统的性能。
3.完备性：指IDS能够检测出所有攻击行为的能力。如果存在一个攻击行为，无法被IDS检测出来，那么该JDS就不具有检测完备性。也就是说，它把对系统的入侵活动当作正常行为（漏报现象）。由于在一般情况下，攻击类型、攻击手段的变化很快，我们很难得到关于攻击行为的所有知识，所以关于IDS的检测完备性的评估相对比较困难。
在此基础上，Debar等又增加了两个性能评价测度：
4.容错性：由于IDS是检测入侵的重要手段／所以它也就成为很多入侵者攻击的首选目标。IDS自身必须能够抵御对它自身的攻击，特别是拒绝服务（Denial-of-Service）攻击。由于大多数的IDS是运行在极易遭受攻击的操作系统和硬件平台上，这就使得系统的容错性变得特别重要，在测试评估IDS时必须考虑这一点。
5.及时性：及时性要求IDS必须尽快地分析数据并把分析结果传播出去，以使系统安全管理者能够在入侵攻击尚未造成更大危害以前做出反应，阻止入侵者进一步的破坏活动，和上面的处理性能因素相比，及时性的要求更高。它不仅要求IDS的处理速度要尽可能地快，而且要求传播、反应检测结果信息的时间尽可能少。

### 7、入侵检测为什么具有**实时性和自适应性**

lm PPT p12

入侵检测是一种动态的网络安全技术

- 利用各种不同类型的引擎，实时地或定期地对网络中相关的数据源进行分析，依照引擎对特殊的数据或事件的认识，将其中具有威胁性的部分提取出来，并触发响应机制。
- 入侵检测的动态性反映在入侵检测的实时性、对网络环境的变化具有一定程度上的自适应性，这是以往静态安全技术无法具有的

---

**（from ChatGPT）**

入侵检测系统具有实时性和自适应性的原因如下：

1. 实时性：入侵检测系统需要在网络中实时监测和分析流量，以及识别潜在的入侵行为。实时性是因为入侵行为可以随时发生，网络威胁可能在短时间内对系统产生严重影响。通过实时监测和分析，入侵检测系统能够尽早发现入侵行为，并及时采取相应的防御措施，以减少潜在损害。

2. 自适应性：入侵检测系统需要具备自适应性，因为网络威胁的形式和方式不断演变和改变。黑客和攻击者不断改进攻击技术和手段，以绕过传统的安全防御机制。为了有效应对新型和未知的入侵行为，入侵检测系统需要具备自适应性能力，即能够根据最新的攻击特征和模式进行更新和调整，以保持高效的检测和防御能力。

通过实时监测和分析，入侵检测系统能够快速检测到网络中的入侵行为，而自适应性则使其能够不断适应新的威胁和攻击方式，从而提高检测的准确性和及时性。这样，组织可以迅速采取必要的防御措施，以保护网络和系统免受潜在的安全威胁。同时，实时性和自适应性也使得入侵检测系统能够快速响应和适应不断变化的威胁环境，提高整体的网络安全性。

### 8、**脱机分析和联机分析**

按照数据分析发生的时间不同，IDS可以分为脱机分析和联机分析。

脱机分析：就是在行为发生后，对产生的数据进行分析，而不是在行为发生的同时进行分析。如对日志的审核、对系统文件的完整性检查都属于这种。一般而言，脱机分析也会间隔很长时间，脱机只是相对于联机而言的。

联机分析：就是在数据产生或者发生改变的同时对其进行检查，以发现攻击行为。这种方式一般用于对网络数据的实时分析，对系统资源要求比较高。

### 9、**HIDS和NIDS的区别**

**（lmPPT加对比分析）**

HIDS和NIDS的区别如下：

1. HIDS（Host-based Intrusion Detection System，基于主机的入侵检测系统）
① HIDS将代理安装在受保护的系统中，它要求与操作系统内核和服务紧密捆绑在一起，监控各种系统事件，如对内核或API的调用，以此来进行防御。
② HIDS还可以监测特定的系统文件和可执行文件调用，以及Windows NT下的安全记录和Unix环境下的系统记录。
③ HIDS能对检测的入侵行为、事件给予积极的反应，比如断开连接、封掉用户账号、杀死进程、提交警报等。
④ HIDS技能要求非常高，要求开发HIDS的企业对有关的操作系统非常了解，而且安装在主机上的代理必须非常可靠，系统占用小，自身安全性要好，否则将会对系统产生负面影响。
⑤ HIDS关注的是到达主机的各种安全威胁，并不关注网络的安全。
⑥ HIDS由于采取的是对事件和系统调用的监控，衡量它的技术指标非常少。
2. NIDS（Network Intrusion Detection System，网络入侵检测系统）
① NIDS最大的特点在于不需要改变服务器等主机的配置，它不需在业务系统的主机中安装额外的软件。
② NIDS不是系统中的关键路径，即使发生故障也不会影响正常业务的运行。
③ NIDS是以网络包作为分析数据源。它通常运用一个工作在混杂模式下的网卡来实时监视并分析通过网络的数据流。
④ NIDS的分析模块通常运用模式匹配、统计分析等技能来识别攻击行为，一旦检测到了攻击行为，NIDS的响应模块就作出适当的响应，比如报警、切断有关用户的网络连接等。
⑤ NIDS收集的是网络中的动态流量信息，因此，攻击特征库数目多少以及数据处理能力，就决定了NIDS识别入侵行为的能力。
⑥ 部署一个NIDS，比HIDS的风险与成本相对较低。
⑦ NIDS采取的基本上都是模式匹配的形式，所以衡量NIDS的技术指标可以数量化。
⑧ 在NIDS的应用过程中，最大的敌人就是误警和漏警。漏警不影响应用环境的可用性，只是用户的投资失误；而误警则有可能导致警报异常、网络紊乱，甚至应用的瘫痪。

---

**（from ChatGPT）**

HIDS（Host Intrusion Detection System）和NIDS（Network Intrusion Detection System）是两种用于检测和防止未经授权访问的常见方法。它们在以下几个方面存在区别：

1. 功能范围：HIDS主要安装在单个主机上，监控主机的系统日志、文件完整性和其他活动。它们检测可疑活动，如未经授权的登录尝试、关键系统文件的更改或异常网络活动。当HIDS检测到潜在入侵时，可以向用户发出警报或自动采取阻止活动的措施。相比之下，NIDS监控网络流量中的可疑活动。它们分析网络中传输的数据包，寻找入侵的迹象，如端口扫描、漏洞利用尝试或异常流量模式。当NIDS检测到潜在威胁时，可以向网络管理员发出警报或自动采取阻止流量的措施。

2. 部署方式：HIDS是基于软件的系统，安装在单个主机上。NIDS是基于硬件的系统，通过监控整个网络上的流量来工作。HIDS需要在每个主机上安装，而NIDS则需要在网络中的适当位置部署，以监控整个网络的流量。

3. 侦测范围：HIDS主要用于检测针对特定主机的攻击，因为它们可以直接监视单个主机的活动。NIDS则可以检测HIDS可能会错过的攻击，例如针对多台主机的分布式拒绝服务（DDoS）攻击。NIDS能够跨多台主机收集的攻击信息，以侦测新的或未知的攻击。

4. 适用范围：选择使用HIDS还是NIDS取决于网络的规模、所使用的系统类型以及所需的安全级别。对于规模较大且拥有许多主机和用户的网络，NIDS可能是更好的选择，因为它可以监控整个网络流量。对于规模较小且主机较少的网络，管理单个主机较为容易，因此HIDS可能更合适。

总结起来，HIDS和NIDS都是入侵检测系统，用于保护系统免受恶意软件、病毒和其他恶意文件类型的侵害。HIDS主要关注单个主机的活动监控，而NIDS则关注整个网络的流量分析。选择使用哪种系统取决于特定业务需求，需要评估安全风险、网络架构、预算和人员资源等因素。



# 第十二章 VPN技术

### 1、==（lm课后题1）==VPN的**定义**

> 书P305最下面、lm PPT p5

VPN即虚拟专用网，它是依靠ISP(Internet服务提供商)和其他NSP(网络服务提供商)，在公用网络中建立专用的数据通信网络的技术。

### 2、VPN的**组成**

> 书P306下面。客户机、传输介质和服务器

### 3、VPN的**类型**

> 书P307、lm PPT p9

1. 远程访问虚拟网（Access VPN）
2. 企业内部虚拟网（Intranet VPN）
3. 企业扩展虚拟网（Extranet VPN）

### 4、（21-22简答1）VPN的**原理**

VPN（Virtual Private Network，虚拟私人网络）通过使用身份验证、隧道协议和数据加密这三个方面的技术，确保通信的安全性。

1. 身份验证：VPN在建立连接之前进行身份验证，以确保只有经过授权的用户可以访问VPN。这可以通过用户名和密码、数字证书、双因素认证等方式进行验证。身份验证防止未经授权的用户访问VPN，确保只有合法用户可以建立安全连接。

2. 隧道协议：VPN使用隧道协议来创建安全的通信隧道。隧道协议在公共网络上创建一个虚拟的专用通道，使得通过该通道传输的数据能够受到保护。常用的隧道协议包括IPsec（Internet Protocol Security）、OpenVPN、L2TP（Layer 2 Tunneling Protocol）等。隧道协议定义了数据传输的方式、加密算法、密钥交换等细节，确保数据在传输过程中不会被窃取或篡改。

3. 数据加密：VPN使用加密算法对数据进行加密，以确保数据在传输过程中的安全性。加密将原始数据转换为密文，只有拥有正确密钥的接收方才能解密并还原数据。常见的加密算法包括AES（Advanced Encryption Standard）、DES（Data Encryption Standard）、RSA（Rivest-Shamir-Adleman）等。通过数据加密，VPN可以防止未经授权的人员访问、截取或篡改数据。

综上所述，VPN通过身份验证确保只有合法用户可以访问，使用隧道协议在公共网络上创建安全通信隧道，并使用数据加密保护数据的安全传输。这些技术的组合使得VPN成为一种安全可靠的通信方式，让用户能够在不安全的网络上享受私密、安全的连接。

### 5、**VPN使用了哪些安全协议**，处于OSI的哪些层？

> 书P310表格

- SOCKSv5/SSL——会话/传输层
- IPsec——网络层
- PPTP/L2F/LT2P——数据链路层

### 6、什么是**隧道**？

> 书P310、lm PPT p16

被封装的数据包在公共互联网络上传递时所经过的逻辑路径称为隧道

### 7、**隧道协议**有哪些？隧道协议的比较（书p319）

> 书P311-318、lm PPT p18

- 点对点隧道协议：PPTP，Point-to Point Tunneling Protocol
- 第2层隧道协议：L2TP, Layer 2 Tunneling Protocol
- IP安全协议：IPSec

### 8、**隧道协议的功能**

- 隧道的功能(同定义，书P310、lm PPT p16)：被封装的数据包在公共互联网络上传递时所经过的逻辑路径称为隧道
- 协议的功能(结合书P318表格回答)：使用隧道传递的数据（或负载）可以是不同协议的数据帧或包，隧道协议将这些其它协议的数据帧或包重新封装在新的包头中发送

### 9、==（lm课后题2）==**比较PPTP和L2TP**

> 书P315 + P318

lm PPT p30：

![image-20230612100559911](https://wendy-1222.oss-cn-hangzhou.aliyuncs.com/img/image-20230612100559911.png)

---

**L2TP/IPSec 和 PPTP 在以下方面类似：**

它们提供了一种逻辑传输机制来发送 PPP 有效载荷。

它们提供隧道或封装，以便基于任何协议的 PPP 有效载荷可以通过 IP 网络发送。

它们依靠 PPP 连接过程来执行用户认证和协议配置。

**L2TP/IPSec 和 PPTP 在以下方面有所不同：**

使用 PPTP，数据加密在 PPP 连接过程（因此，PPP 身份验证）完成后开始。使用 L2TP/IPSec，数据加密在 PPP 连接过程之前开始。

PPTP 连接使用 MPPE，这是一种基于 Rivest-Shamir-Aldeman RC-4 加密算法并提供 40、56 或 128 位加密密钥的流密码。流密码将数据加密为比特流。L2TP/IPSec 连接使用数据加密标准 (DES)，它是一种分组密码，它使用 56 位的 DES 密钥或三个 3-DES 的 56 位密钥。块密码以离散块（64 位块，在 DES 的情况下）中加密数据。

PPTP 连接仅需要通过基于 PPP 的身份验证协议进行用户级身份验证。L2TP/IPSec 连接需要相同的用户级身份验证，此外还需要通过计算机证书进行计算机级身份验证。

（主要是PPTP和L2TP的工作原理LMPPT + 课本P315）

### 10、==（lm课后题3）==简述**IPSec中AH协议功能**

> 书P317、lm PPT p39

- 保证信息源的可靠性和数据的完整性

### 11、==（lm课后题4）==简述**IPSec中ESP协议的功能**

> 书P318、lm PPT p40

- 保证数据的完整性和可靠性

> 1. 保密性confidentiality:使信息不泄露给未授权的个人、实体、进程，或不被其利用的特性。
> 2. 完整性integrity:保卫资产准确性和完整的特性。
> 3. 可用性availability:已授权实体一旦需要就可访问和使用的数据和资源的特性。
> 4. 真实性authenticity:确保主体或资源的身份正是所声称的特性。真实性适用于用户、进程、系统和信息之类的实体。
> 5. 可核查性accountability:确保可将一个实体的行动唯一地追踪到此实体的特性。
> 6. 不可否认性non- repudiation(抗抵赖性):证明某一动作或事件已经发生的能力，以使事后不能否认这一动作或事件。
> 7. 可靠性reliability:预期行为和结果保持一致的特性。

### 12、VPN为什么需要**两个服务器**

VPN（Virtual Private Network，虚拟专用网络）通常需要两个服务器来实现其功能。这是因为VPN的工作原理涉及两个关键组件：VPN客户端和VPN服务器。

1. VPN客户端：VPN客户端是用户使用的设备（例如电脑、手机），它需要连接到VPN服务器以建立安全的加密通信。VPN客户端负责将用户的数据包进行加密，并将其发送到VPN服务器。

2. VPN服务器：VPN服务器是中心设备，负责处理客户端的连接请求，并在客户端和目标服务器之间建立安全的通信通道。VPN服务器有两个关键功能：
   - 封装和解封装：VPN服务器接收到来自VPN客户端的数据包后，将其封装在新的VPN数据包中，并在目标服务器上解封装还原成原始数据包。这个过程确保数据在互联网上的传输是安全和加密的。
   - 数据路由：VPN服务器负责将加密后的数据包从客户端传输到目标服务器，并将目标服务器的响应数据传输回客户端。

因此，为了实现VPN的功能，至少需要两个服务器：VPN客户端所在的设备和VPN服务器。VPN客户端将用户的数据包发送到VPN服务器，服务器负责加密和传输数据，并与目标服务器建立安全的通信通道。

参考文献：
1. [VPN工作原理 - 知乎](https://zhuanlan.zhihu.com/p/60965862)

### 13、（18-19简答4）简述在配置成对的 VPN 网关时，**交换证书**的目的。

在配置成对的 VPN 网关时，交换证书的目的是实现身份验证和安全通信。

通过交换证书，VPN 网关能够验证连接另一端的身份。这种身份验证是通过数字证书实现的，其中一个网关充当证书颁发机构（Certificate Authority，CA），为另一个网关颁发数字证书。这样，每个网关都具有自己的证书，并且可以验证对方的证书。

交换证书的目的有以下几个方面：

1. 身份验证：证书交换使得每个网关能够验证对方的身份。当建立 VPN 连接时，每个网关会验证对方的证书，确保通信的双方都是合法的网关。这样可以防止未经授权的访问和中间人攻击。

2. 安全通信：交换证书后，网关之间的通信将使用证书中包含的加密算法和密钥来进行加密和解密。这确保了数据在传输过程中的机密性，使得任何拦截的数据都无法被解读。

3. 密钥协商：在证书交换过程中，网关还会协商用于加密和解密通信的密钥。这确保了通信双方使用相同的密钥来保证数据的完整性和保密性。

总之，通过交换证书，配置成对的 VPN 网关可以实现相互身份验证、安全的加密通信以及密钥协商，确保了 VPN 连接的安全性和可靠性。

---

在配置成对的 VPN 网关时，交换证书的目的是进行证书身份验证。证书身份验证是一种安全机制，用于验证连接双方的身份，并确保通信的机密性和完整性。

在 Azure VPN 网关中，通过配置点到站点 (P2S) VPN 客户端和证书身份验证，可以实现对 Azure 虚拟网络 (VNet) 的连接。当使用 P2S IKEv2/SSTP 隧道和证书身份验证连接到 Azure VNet 时，可以使用在要连接的 Windows 操作系统上安装的 VPN 客户端。通过生成 VPN 客户端配置文件和生成客户端证书，可以完成配置。生成的 VPN 客户端配置文件包含了 VPN 客户端的所有必需配置设置，而客户端证书则用于验证客户端的身份。证书必须包含在客户端计算机上，并且在某些配置中还需要安装根证书信息[[1](https://learn.microsoft.com/zh-cn/azure/vpn-gateway/point-to-site-vpn-client-cert-windows)]。

交换证书的目的是确保只有拥有有效证书的客户端才能与 VPN 网关进行连接。这增加了连接的安全性，防止未经授权的访问。通过证书身份验证，VPN 网关可以验证客户端的身份，而客户端也可以验证 VPN 网关的身份，从而建立一个双向的可信连接。

### 14、（20-21论述2）针对企业员工远程办公场景，构建基于**VPN**的方案设计，要求保障安全性并论述其可行性。提示：有线/无线方案均可。

**（from Monica）**

针对企业员工远程办公场景，我们可以构建基于VPN的方案设计来保障安全性。VPN是一种通过公共网络建立安全连接的技术，可以在互联网上提供安全、可靠的私人网络连接，为企业员工提供远程访问公司内部网络的安全通道。

对于有线方案，我们可以在企业内部建立VPN服务器，并在员工电脑上安装VPN客户端，通过企业内部网络连接VPN服务器，实现员工对公司内部网络的访问。这种方案的优点是稳定可靠，安全性高，但需要在企业内部建立VPN服务器，成本较高。

对于无线方案，我们可以使用云服务商提供的VPN服务，员工只需要在电脑或移动设备上安装相应的VPN客户端即可。这种方案的优点是简单易用，无需企业内部建立VPN服务器，成本较低。缺点是相对于有线方案来说，安全性稍低一些。

总体来说，基于VPN的方案设计可以有效地保障企业员工远程办公的安全性。具体方案可以根据企业实际情况进行选择和调整。

---

**（from ChatGPT）**

针对企业员工远程办公场景，可以构建基于VPN（虚拟专用网络）的方案设计来保障安全性。以下是一个基于VPN的方案设计示例，包括有线和无线方案：

有线方案：

1. 建立企业内部VPN服务器：在企业内部搭建VPN服务器，作为员工远程访问企业内部资源的入口。该服务器应具备强大的安全功能，如加密通信、身份验证和访问控制等。

2. 配置VPN客户端：为员工提供VPN客户端软件，员工在远程办公时通过该客户端连接到VPN服务器。客户端应支持安全的加密协议，如IPSec（Internet协议安全）或SSL（安全套接层）等，以确保通信的机密性和完整性。

3. 强制访问控制（MAC）：在VPN服务器上配置强制访问控制机制，根据员工的身份和权限，限制他们对企业资源的访问。这可以通过设置访问策略、角色和权限来实现，确保只有授权的员工可以访问特定的资源。

4. 防火墙和入侵检测系统（IDS）：在VPN服务器和企业内部网络之间设置防火墙，并部署入侵检测系统来监测和阻止潜在的攻击。这有助于保护企业网络免受未经授权的访问和恶意活动的影响。

无线方案：

1. 配置安全的Wi-Fi网络：在员工家庭或远程办公场所配置安全的Wi-Fi网络，使用WPA2或更高级别的加密来保护无线通信的安全性。确保Wi-Fi网络具有强密码，并禁用WPS（Wi-Fi Protected Setup）功能。

2. VPN客户端设置：在员工设备上安装并配置VPN客户端软件，通过连接到VPN服务器建立安全的加密通道。VPN客户端可以自动选择最佳的安全协议和配置，以确保通信的安全性。

3. 多因素身份验证：要求员工在连接VPN之前进行多因素身份验证，例如使用密码和令牌、生物识别等。这增加了安全性，确保只有授权的员工可以访问企业资源。

4. 安全意识培训：为员工提供定期的安全意识培训，教育他们有关安全最佳实践、识别威胁和安全风险的知识。这有助于减少员工受到社会工程学和网络钓鱼等攻击的风险。

可行性论述：
基于VPN的远程办公方案在保障安全性方面具有多个优势：

1. 数据加密：VPN使用加密协议对通信进行加密，确保数据在传输过程中的机密性和完整性，防止数据被窃取或篡改。

2. 身份验证：VPN要求用户进行身份验证，确保只有授权的用户可以访问企业资源。这种身份验证机制增加了访问的安全性，并降低了未经授权访问的风险。

3. 远程访问控制：VPN服务器可以配置访问控制策略，根据员工的身份和权限限制他们对资源的访问。这样可以确保只有合适的人员可以访问特定的资源，增强了企业内部网络的安全性。

4. 灵活性和便利性：基于VPN的远程访问方案使员工可以安全地远程办公，不受地理位置限制。员工可以在安全的通信通道下访问所需的资源，提高工作效率和灵活性。

综上所述，基于VPN的远程办公方案可以提供较高的安全性和可行性，为企业员工提供安全的远程访问企业资源的方式。然而，为了最大程度地确保安全性，企业还应采取其他安全措施，如定期更新软件补丁、网络监控和安全事件响应等。



# 第十六章 取证技术

### 1、简述**蜜罐**的目的和蜜罐系统的工作原理

书p414

### 2、**Honeynet与蜜罐**有哪些相似和不同之处？

具体可见书p426

- Honeynet是专门为研究设计的高交互型蜜罐
- 与其他大部分蜜罐不同的是：它不进行模拟，而是对真实的系统不进行修改或改动很小
- 不是一个单独的系统而是由多个系统和多个攻击检测应用组成的网络



### 3、（21-22论述3）简述**蜜罐技术**的定义与作用?(15分)

**（from Monica）**

蜜罐技术是一种安全机制，用于诱骗攻击者进入虚假系统或网络，从而追踪和收集攻击者的行为和信息。蜜罐系统通常被设计成看似易受攻击的系统，但实际上是安全的，旨在吸引攻击者攻击并暴露他们的行为。

蜜罐技术的作用主要有两个方面。首先，它可以帮助安全人员收集攻击者的信息，包括攻击方式、攻击工具和攻击目标等，从而帮助安全人员更好地了解威胁情报和攻击趋势。其次，它可以减少真实系统或网络受到攻击的风险，因为攻击者可能会被诱骗进入虚假系统或网络，从而分散了他们的攻击力量，减轻了真实系统或网络的压力。

---

**详细版：**

蜜罐技术是一种网络安全防御技术，它是在网络中故意部署一些看似有价值但实际上是虚拟的系统或应用程序，用于吸引攻击者进入并模拟攻击，从而收集攻击者的信息和行为，以便研究攻击技术和提高系统的安全性。

蜜罐技术的作用包括：

- 欺骗攻击者：通过模拟真实系统或应用程序，让攻击者认为它们是真实的，从而吸引攻击者进入并暴露其攻击行为。
- 收集情报信息：蜜罐可以记录攻击者的行为和技术，包括攻击方式、攻击工具、攻击源地址等，提供给安全人员进行分析和研究。
- 减少被攻击的风险：通过蜜罐技术，安全人员可以了解攻击者的行为和技术，从而及时采取防御措施，减少被攻击的风险。
- 提高安全性：蜜罐技术可以帮助安全人员了解系统的漏洞和弱点，从而提高系统的安全性。
